import streamlit as st
import requests
import xml.etree.ElementTree as ET
import pandas as pd
from io import BytesIO
from pptx import Presentation
from pptx.util import Cm, Pt
from pptx.dml.color import RGBColor
from pptx.enum.text import PP_ALIGN, MSO_ANCHOR
from pptx.enum.shapes import MSO_SHAPE, MSO_SHAPE_TYPE
import xlsxwriter
from urllib.parse import quote_plus
import time
import urllib3
import datetime
import random
import folium
from streamlit_folium import st_folium
import re

# SSL ê²½ê³  ë¹„í™œì„±í™”
urllib3.disable_warnings(urllib3.exceptions.InsecureRequestWarning)

# =========================================================
# [ì„¤ì •] UI ë° ìŠ¤íƒ€ì¼
# =========================================================
st.set_page_config(page_title="ë¶€ë™ì‚° ì›í´ë¦­ ë¶„ì„ Pro", page_icon="ğŸ¢", layout="centered")

st.markdown("""
    <style>
        @import url("https://cdn.jsdelivr.net/gh/orioncactus/pretendard/dist/web/static/pretendard.css");
        html, body, [class*="css"] { font-family: 'Pretendard', sans-serif; }
        .block-container { max-width: 1000px; padding: 3rem 2rem; }
        button[data-testid="stNumberInputStepDown"], button[data-testid="stNumberInputStepUp"] { display: none !important; }
        .stNumberInput label { display: none; }
          
        input[type="text"] { text-align: right !important; font-size: 19px !important; font-weight: 700 !important; color: #111 !important; background-color: #fdfdfd !important; border: 2px solid #e0e0e0 !important; }
        div[data-testid="stTextInput"] input[aria-label="ì£¼ì†Œ ì…ë ¥"] { text-align: left !important; }
        div[data-testid="stTextInput"] input[aria-label="ê³µì‹œì§€ê°€"], div[data-testid="stTextInput"] input[aria-label="ìš©ë„ì§€ì—­"] { text-align: center !important; color: #1a237e !important; }
        input[aria-label="ë§¤ë§¤ê¸ˆì•¡"] { color: #D32F2F !important; font-size: 34px !important; font-weight: 900 !important; }
          
        .stButton > button { width: 100%; background-color: #1a237e; color: white; font-size: 18px; font-weight: 800; padding: 14px; border-radius: 8px; border: none; box-shadow: 0 4px 6px rgba(0,0,0,0.2); transition: all 0.3s; }
        .stButton > button:hover { background-color: #0d47a1; transform: translateY(-2px); }
          
        div[data-testid="column"] .stButton > button { background-color: transparent !important; border: none !important; color: black !important; font-weight: 900 !important; font-size: 18px !important; box-shadow: none !important; padding: 5px !important; text-align: center !important; }
        div[data-testid="column"] .stButton > button:hover { color: #333 !important; background-color: transparent !important; transform: scale(1.05); }

        .unit-price-box { background-color: #f0f2f5; border: 2px solid #d1d5db; padding: 12px; border-radius: 10px; margin-top: 10px; text-align: center; }
        .unit-price-value { font-size: 24px; font-weight: 900; color: #000; }
          
        .ai-summary-box { background-color: #fff; border: 2px solid #c5cae9; border-top: 5px solid #1a237e; padding: 30px; border-radius: 8px; margin-top: 20px; text-align: left; box-shadow: 0 10px 25px rgba(0,0,0,0.08); }
        .ai-title { font-size: 26px; font-weight: 900; color: #1a237e; margin-bottom: 25px; border-bottom: 3px solid #eee; padding-bottom: 15px; letter-spacing: -0.5px; }
          
        .link-btn { display: inline-block; width: 100%; padding: 12px; margin: 5px 0; text-align: center; border-radius: 6px; text-decoration: none; font-weight: 800; font-size: 16px; color: white !important; transition: 0.3s; box-shadow: 0 2px 4px rgba(0,0,0,0.1); }
        .naver-btn { background-color: #03C75A; } .eum-btn { background-color: #1a237e; }
        .naver-btn:hover, .eum-btn:hover { opacity: 0.8; transform: translateY(-1px); }
          
        .selected-tags { background-color: #e3f2fd; color: #0d47a1; padding: 8px 14px; border-radius: 20px; font-size: 15px; font-weight: 800; margin-right: 6px; display: inline-block; margin-bottom: 8px; border: 2px solid #90caf9; }
          
        div[data-testid="stTextInput"] input[aria-label="ëŒ€ì§€ë©´ì "], div[data-testid="stTextInput"] input[aria-label="ì—°ë©´ì "], div[data-testid="stTextInput"] input[aria-label="ê±´ì¶•ë©´ì "], div[data-testid="stTextInput"] input[aria-label="ì§€ìƒë©´ì "] { font-size: 26px !important; font-weight: 900 !important; color: #000 !important; }

        [data-testid="stDataFrame"] { font-size: 17px !important; font-weight: 700 !important; }
        [data-testid="stElementToolbar"] { opacity: 1 !important; visibility: visible !important; font-weight: bold; }
        [data-testid="stElementToolbarButton"] { transform: scale(1.1); }
        div[data-testid="stDataFrame"] th { font-size: 16px !important; font-weight: 900 !important; color: #1a237e !important; background-color: #f8f9fa !important; }
    </style>
    """, unsafe_allow_html=True)

# =========================================================
# [ì„¤ì •] ì „ì—­ ë³€ìˆ˜
# =========================================================
# [ì£¼ì˜] ì´ í‚¤ëŠ” ì˜ˆì‹œì…ë‹ˆë‹¤. ë³¸ì¸ì˜ V-World í‚¤ë¥¼ ë°œê¸‰ë°›ì•„ êµì²´í•˜ì„¸ìš”.
VWORLD_KEY = "47B30ADD-AECB-38F3-B5B4-DD92CCA756C5" 
USER_KEY = "Xl5W1ALUkfEhomDR8CBUoqBMRXphLTIB7CuTto0mjsg0CQQspd7oUEmAwmw724YtkjnV05tdEx6y4yQJCe3W0g=="

if 'zoning' not in st.session_state: st.session_state['zoning'] = ""
if 'generated_candidates' not in st.session_state: st.session_state['generated_candidates'] = [] 
if 'final_selected_insights' not in st.session_state: st.session_state['final_selected_insights'] = [] 
if 'price' not in st.session_state: st.session_state['price'] = 0
if 'addr' not in st.session_state: st.session_state['addr'] = "" 
if 'last_click_lat' not in st.session_state: st.session_state['last_click_lat'] = 0.0
if 'fetched_lp' not in st.session_state: st.session_state['fetched_lp'] = 0
if 'fetched_zoning' not in st.session_state: st.session_state['fetched_zoning'] = ""
if 'rent_roll_data' not in st.session_state: st.session_state['rent_roll_data'] = []
if 'rent_roll_init' not in st.session_state: st.session_state['rent_roll_init'] = False

def reset_analysis():
    st.session_state['generated_candidates'] = []
    st.session_state['final_selected_insights'] = []
    st.session_state['fetched_lp'] = 0
    st.session_state['fetched_zoning'] = ""
    st.session_state['rent_roll_data'] = [] 
    st.session_state['rent_roll_init'] = False

# --- [í—¬í¼ í•¨ìˆ˜] ---
def get_address_from_coords(lat, lng):
    url = "https://api.vworld.kr/req/address" 
    params = {"service": "address", "request": "getaddress", "version": "2.0", "crs": "EPSG:4326", "point": f"{lng},{lat}", "type": "PARCEL", "format": "json", "key": VWORLD_KEY}
    try:
        res = requests.get(url, params=params, timeout=5, verify=False)
        if res.json().get('response', {}).get('status') == 'OK': return res.json()['response']['result'][0]['text']
    except: return None

def render_styled_block(label, value):
    st.markdown(f"<div style='margin-bottom:10px;'><div style='font-size:16px;color:#555;font-weight:700;'>{label}</div><div style='font-size:26px;font-weight:900;color:#111;'>{value}</div></div>", unsafe_allow_html=True)

def editable_area_input(label, key, default_val):
    val_str = st.text_input(label, value=str(default_val), key=key)
    try:
        val = float(str(val_str).replace(',', ''))
        st.markdown(f"<div style='color:#D32F2F;font-size:24px;font-weight:900;text-align:right;margin-top:-5px;'>{val*0.3025:,.1f} í‰</div>", unsafe_allow_html=True)
        return val
    except: 
        st.markdown(f"<div style='color:#D32F2F;font-size:24px;font-weight:900;text-align:right;margin-top:-5px;'>- í‰</div>", unsafe_allow_html=True)
        return 0.0

def editable_text_input(label, key, default_val):
    return st.text_input(label, value=str(default_val), key=key)

def comma_input(label, unit, key, default_val, help_text=""):
    st.markdown(f"<div style='font-size:17px;font-weight:800;color:#222;margin-bottom:4px;'>{label} <span style='font-size:13px;color:#666;'>{help_text}</span></div>", unsafe_allow_html=True)
    c1, c2 = st.columns([3, 1]) 
    with c1:
        if key not in st.session_state: st.session_state[key] = default_val
        val_in = st.text_input(label, value=f"{st.session_state[key]:,}" if st.session_state[key] else "", key=f"{key}_w", label_visibility="hidden")
        try: st.session_state[key] = int(str(val_in).replace(',', '').strip()) if val_in else 0
        except: st.session_state[key] = 0
    with c2: st.markdown(f"<div style='margin-top:15px;font-size:19px;font-weight:700;color:#444;'>{unit}</div>", unsafe_allow_html=True)
    return st.session_state[key]

def format_date_dot(date_str):
    if not date_str or len(date_str) != 8: return date_str
    return f"{date_str[:4]}.{date_str[4:6]}.{date_str[6:]}"

# ---------------------------------------------------------
# [ìˆ˜ì •ëœ í•¨ìˆ˜] í‚¤ì›Œë“œ ê°œìˆ˜ì— ë§ì¶° 10ê°œ ëœë¤ ë°°ë¶„ ë¡œì§
# ---------------------------------------------------------
def generate_insight_candidates(info, finance, zoning, env_features, user_comment, comp_df=None, target_dong=""):
    points = []
    
    # ë©˜íŠ¸ ë°ì´í„°ë² ì´ìŠ¤ (ì „ì²´ í¬í•¨)
    marketing_db = {
        "ì—­ì„¸ê¶Œ": ["â˜‘ [ì´ˆì—­ì„¸ê¶Œ] ì§€í•˜ì² ì—­ ë„ë³´ 3ë¶„ ì´ë‚´, ìœ ë™ì¸êµ¬ ëŠì´ì§€ ì•ŠëŠ” íŠ¹ê¸‰ ì…ì§€", "â˜‘ [êµí†µí—ˆë¸Œ] ëŒ€ì¤‘êµí†µ ì ‘ê·¼ì„± ìµœìƒ, ì„ì°¨ì¸ ì„ í˜¸ë„ 1ìˆœìœ„ ì§€ì—­", "â˜‘ [í™˜ê¸ˆì„±] ì—­ì„¸ê¶Œ í”„ë¦¬ë¯¸ì—„ìœ¼ë¡œ ê²½ê¸° ë¶ˆí™©ì—ë„ ì‹œì„¸ ë°©ì–´ íƒì›”", "â˜‘ [ì¶œí‡´ê·¼ìš©ì´] ì§ì¥ì¸ ìˆ˜ìš” í’ë¶€í•˜ì—¬ ê³µì‹¤ ìœ„í—˜ ê·¹íˆ ë‚®ì€ ì•ˆì „ ìì‚°", "â˜‘ [ì…ì§€ë¶ˆíŒ¨] ì—­ì„¸ê¶Œ ë¶ˆíŒ¨ ì‹ í™”, ì‹œê°„ì´ ì§€ë‚ ìˆ˜ë¡ ê°€ì¹˜ê°€ ì¦ëª…ë˜ëŠ” ê³³", "â˜‘ [ì ‘ê·¼ì„±] ì–´ë””ì„œë“  ì°¾ì•„ì˜¤ê¸° ì‰¬ìš´ ìœ„ì¹˜, ë³‘ì˜ì› ë° ì‚¬ì˜¥ ìµœì ì§€", "â˜‘ [ìœ ë™ì¸êµ¬] ì—­ì„ ì¤‘ì‹¬ìœ¼ë¡œ íë¥´ëŠ” í’ë¶€í•œ ìœ ë™ì¸êµ¬ ìì—° í¡ìˆ˜", "â˜‘ [ëŒ€ì¶œìœ ë¦¬] ê¸ˆìœµê¶Œì—ì„œ ì„ í˜¸í•˜ëŠ” ë‹´ë³´ ë¬¼ê±´ìœ¼ë¡œ ê°ì •í‰ê°€ ìœ ë¦¬", "â˜‘ [ìƒê¶Œí™•ì¥] ì—­ ì£¼ë³€ ê°œë°œ í˜¸ì¬ì— ë”°ë¥¸ ìƒê¶Œ í™•ì¥ ê°€ëŠ¥ì„± ë³´ìœ ", "â˜‘ [ì„ëŒ€ì•ˆì •] ê³µì‹¤ ë¦¬ìŠ¤í¬ê°€ ê°€ì¥ ì ì€ ìŠ¤í…Œë””ì…€ëŸ¬ íˆ¬ìì²˜"],
        "ê´‘ëŒ€ë¡œë³€": ["â˜‘ [ê´‘ëŒ€ë¡œ] ì™•ë³µ 8ì°¨ì„  ì´ìƒ ê´‘ëŒ€ë¡œ ì ‘í•¨, ì••ë„ì ì¸ ì›…ì¥í•¨ ìë‘", "â˜‘ [ëœë“œë§ˆí¬] ì§€ì—­ì„ ëŒ€í‘œí•˜ëŠ” ëŒ€ë¡œë³€ ê±´ë¬¼ë¡œ ê¸°ì—… ì¸ì§€ë„ ìƒìŠ¹ íš¨ê³¼", "â˜‘ [ì ‘ê·¼ì„±] ì°¨ëŸ‰ ì§„ì¶œì… ë° ëŒ€ì¤‘êµí†µ ì—°ê³„ì„± ìµœê³ ì˜ Aê¸‰ ì…ì§€", "â˜‘ [ìƒì§•ì„±] ëŒ€ê¸°ì—… í”Œë˜ê·¸ì‹­ ìŠ¤í† ì–´ ë° ì „ì‹œì¥ ìš©ë„ë¡œ ê°•ë ¥ ì¶”ì²œ", "â˜‘ [ê°€ì¹˜ìƒìŠ¹] í¬ì†Œì„± ë†’ì€ ëŒ€ë¡œë³€ í† ì§€, ë§¤ë…„ ê³µì‹œì§€ê°€ ê¸‰ìƒìŠ¹ ì§€ì—­", "â˜‘ [ê°€ì‹œì„±] ì°¨ëŸ‰ ì´ë™ ì‹œ ëˆ„êµ¬ì—ê²Œë‚˜ ë…¸ì¶œë˜ëŠ” ìµœê³ ì˜ ê´‘ê³ íŒ íš¨ê³¼", "â˜‘ [ìŠ¤ì¹´ì´ë¼ì¸] ë„ì‹¬ì˜ ì£¼ìš” ìŠ¤ì¹´ì´ë¼ì¸ì„ í˜•ì„±í•˜ëŠ” ìë¶€ì‹¬ ìˆëŠ” ê±´ë¬¼", "â˜‘ [ìš©ì ë¥ ] ë…¸ì„ ìƒì—…ì§€ ë“± ë†’ì€ ìš©ì ë¥  ì ìš© ê°€ëŠ¥ì„±ì´ í° ì•Œì§œ ë¶€ì§€", "â˜‘ [ìš°ëŸ‰ì„ì°¨] ìŠ¤íƒ€ë²…ìŠ¤, ì€í–‰, ëŒ€í˜• ë³‘ì› ë“± ìš°ëŸ‰ ì„ì°¨ì¸ ì…ì  ì„ í˜¸", "â˜‘ [ìì‚°ê°€ì¹˜] ë³´ìœ í•˜ëŠ” ê²ƒë§Œìœ¼ë¡œë„ ìì‚°ê°€ì˜ í’ˆê²©ì„ ë†’ì—¬ì£¼ëŠ” íŠ¸ë¡œí”¼ ì—ì…‹"],
        "ë¨¹ììƒê¶Œ": ["â˜‘ [ë¨¹ììƒê¶Œ] 24ì‹œê°„ ë¶ˆ êº¼ì§€ì§€ ì•ŠëŠ” ìƒê¶Œ, ê¶Œë¦¬ê¸ˆ í˜•ì„±ëœ ê²€ì¦ëœ ìë¦¬", "â˜‘ [ìœ ë™ì¸êµ¬] ì ì‹¬ë¶€í„° íšŒì‹ê¹Œì§€ ì§ì¥ì¸/ê±°ì£¼ë¯¼ ë°œê¸¸ ëŠì´ì§€ ì•ŠëŠ” ê³³", "â˜‘ [ì„ëŒ€ìˆ˜ìš”] ì‹ë‹¹, ì£¼ì , ì¹´í˜ ë“± ì„ì°¨ ëŒ€ê¸° ìˆ˜ìš” í’ë¶€í•œ í•«í”Œë ˆì´ìŠ¤", "â˜‘ [í˜„ê¸ˆíë¦„] ë†’ì€ ë°”ë‹¥ ê¶Œë¦¬ê¸ˆìœ¼ë¡œ ê³µì‹¤ ë¦¬ìŠ¤í¬ ì œë¡œì— ê°€ê¹Œìš´ ì…ì§€", "â˜‘ [ì†Œë¹„ë ¥] êµ¬ë§¤ë ¥ ë†’ì€ ì§ì¥ì¸ ì†Œë¹„ê°€ ì§‘ì¤‘ë˜ëŠ” ë©”ì¸ ë¨¹ì ê³¨ëª©", "â˜‘ [í™œì„±í™”] í‰ì¼ ì£¼ë§ í•  ê²ƒ ì—†ì´ ë¶ì ì´ëŠ” ì•ˆì •ì ì¸ ìƒê¶Œ", "â˜‘ [í™˜ê¸ˆì„±] ìƒê¶Œì´ í™œë°œí•˜ì—¬ ë§¤ê° ì‹œ ë§¤ìˆ˜ ëŒ€ê¸°ìê°€ ë§ì€ ì§€ì—­", "â˜‘ [ì„ëŒ€ë£Œ] ë§¤ì¶œ ê¸°ë°˜ì˜ ë†’ì€ ì„ëŒ€ë£Œ ì±…ì •ì´ ê°€ëŠ¥í•œ ê³ ìˆ˜ìµ ìƒê¶Œ", "â˜‘ [ì—…ì¢…ë‹¤ì–‘] 1ì¸µë¶€í„° ìƒì¸µë¶€ê¹Œì§€ F&B ë° ìœ í¥ ì—…ì¢…ìœ¼ë¡œ ê½‰ ì°¨ëŠ” ê±´ë¬¼", "â˜‘ [ìƒˆë²½ì˜ì—…] ì‹¬ì•¼ ì‹œê°„ëŒ€ê¹Œì§€ ì˜ì—… ê°€ëŠ¥í•˜ì—¬ 24ì‹œê°„ ìˆ˜ìµ ì°½ì¶œ ê°€ëŠ¥"],
        "ëœë“œë§ˆí¬": ["â˜‘ [ëœë“œë§ˆí¬] ì§€ì—­ ë‚´ ëˆ„êµ¬ë‚˜ ì•„ëŠ” ìƒì§•ì ì¸ ê±´ë¬¼, íˆ¬ìê°€ì¹˜ í™•ì‹¤", "â˜‘ [ì‹œì„¸ë¦¬ë”©] ì£¼ë³€ ì‹œì„¸ë¥¼ ì´ë„ëŠ” ëŒ€ì¥ì£¼ ê±´ë¬¼, ìì‚° ê°€ì¹˜ ìƒìŠ¹ ë³´ì¥", "â˜‘ [í”„ë¦¬ë¯¸ì—„] ì••ë„ì ì¸ ê·œëª¨ì™€ ì™¸ê´€ìœ¼ë¡œ ì§€ì—­ ë‚´ ë…ë³´ì ì¸ ì¡´ì¬ê°", "â˜‘ [ëª…í’ˆì…ì§€] ì„±ê³µí•œ ê¸°ì—…ì˜ ì‚¬ì˜¥ì´ë‚˜ ë³‘ì›ìœ¼ë¡œ ìµœê³ ì˜ ì„ íƒ", "â˜‘ [í™ë³´íš¨ê³¼] ê±´ë¬¼ ìì²´ê°€ ë¸Œëœë“œê°€ ë˜ëŠ” ì—„ì²­ë‚œ ë§ˆì¼€íŒ… íš¨ê³¼", "â˜‘ [ì•½ì†ì¥ì†Œ] ì§€ì—­ ì£¼ë¯¼ë“¤ì˜ ë§Œë‚¨ì˜ ì¥ì†Œë¡œ í†µí•˜ëŠ” ì¸ì§€ë„ì˜ ì •ì ", "â˜‘ [ì•ˆì „ì„±] ëœë“œë§ˆí¬ë¼ëŠ” ì´ë¦„ê°’ í•˜ë‚˜ë¡œ ê°€ê²© ë°©ì–´ ê°€ëŠ¥í•œ ìì‚°", "â˜‘ [ì„ í˜¸ë„] ì„ì°¨ì¸ë“¤ì´ ê°€ì¥ ë¨¼ì € ì…ì í•˜ê³  ì‹¶ì–´ í•˜ëŠ” ì›Œë„ˆë¹„ ë¹Œë”©", "â˜‘ [í¬ì†Œì„±] ì§€ì—­ ë‚´ ì†ì— ê¼½íˆëŠ” ê±´ë¬¼ë¡œ ì†Œì¥ ê°€ì¹˜ 200%", "â˜‘ [ìë¶€ì‹¬] ê±´ë¬¼ì£¼ë¡œì„œì˜ ìë¶€ì‹¬ì„ ê·¹ëŒ€í™”í•´ì£¼ëŠ” ìµœê³ ì˜ ëª…í’ˆ ë§¤ë¬¼"],
        "ê¸‰ë§¤ë¬¼": ["â˜‘ [ì´ˆê¸‰ë§¤] ì‹œì„¸ ëŒ€ë¹„ 20% ì´ìƒ ì €ë ´, ë‹¤ì‹œ ì—†ì„ ê¸°íšŒì˜ ê¸‰ë§¤ë¬¼", "â˜‘ [ì•ˆì „ë§ˆì§„] ë§¤ì… ì¦‰ì‹œ ì‹œì„¸ ì°¨ìµ í™•ì •ëœ ì €í‰ê°€ ì•Œì§œ ìì‚°", "â˜‘ [ì ê·¹ì¶”ì²œ] ê±´ë¬¼ì£¼ ì‚¬ì •ìƒ ê¸´ê¸‰ ë§¤ê°, ë¹ ë¥¸ ê±°ë˜ ì‹œ ë„¤ê³  ê°€ëŠ¥ì„±", "â˜‘ [íˆ¬ìì°¬ìŠ¤] ëŒ€ì§€ í‰ë‹¹ê°€ë§Œ ë´ë„ ì´ë“ì¸ ê°€ê²©, ë§ì„¤ì´ë©´ ë†“ì¹˜ëŠ” ë§¤ë¬¼", "â˜‘ [ê°€ê²©ë©”ë¦¬íŠ¸] ì£¼ë³€ ê±°ë˜ ì‚¬ë¡€ ëŒ€ë¹„ í˜„ì €íˆ ë‚®ì€ ë§¤ê°€, ë†“ì¹˜ë©´ í›„íšŒ", "â˜‘ [ì €ì ë§¤ìˆ˜] ë°”ë‹¥ ê°€ê²©ì— ë§¤ì…í•˜ì—¬ ìµœê³ ì˜ ìˆ˜ìµë¥ ì„ ì˜¬ë¦´ ê¸°íšŒ", "â˜‘ [ìƒì†ê¸‰ë§¤] ìƒì†ì„¸ ë‚©ë¶€ë¥¼ ìœ„í•´ ê¸‰í•˜ê²Œ ë‚˜ì˜¨ ì§„í™ ì†ì˜ ì§„ì£¼", "â˜‘ [ì‚¬ì •ë³€ê²½] ë§¤ë„ì¸ì˜ ê°œì¸ ì‚¬ì •ìœ¼ë¡œ ì¸í•´ ëˆˆë¬¼ì˜ ê¸‰ë§¤ ì²˜ë¦¬", "â˜‘ [ì¦‰ì‹œìˆ˜ìµ] ì‹¸ê²Œ ìƒ€ê¸° ë•Œë¬¸ì— ì •ìƒ ì„ëŒ€ë£Œë§Œ ë°›ì•„ë„ ê³ ìˆ˜ìµ ë‹¬ì„±", "â˜‘ [ë¹„ë°€ì§„í–‰] ì‹œì¥ì— ì†Œë¬¸ë‚´ì§€ ì•Šê³  ì¡°ìš©íˆ ì§„í–‰í•˜ëŠ” ì‹œí¬ë¦¿ ê¸‰ë§¤"],
        "ì£¼ì°¨í¸ë¦¬": ["â˜‘ [ì£¼ì°¨í¸ë¦¬] ê°•ë‚¨ê¶Œì—ì„œ ë³´ê¸° ë“œë¬¸ ìì£¼ì‹ ì£¼ì°¨ì¥ í™•ë³´, ì„ì°¨ ê²½ìŸë ¥ ç”²", "â˜‘ [ëŒ€í˜•ì°¨ëŸ‰] SUV, ê³ ê¸‰ ì„¸ë‹¨ë„ ì§„ì… ê°€ëŠ¥í•œ ë„“ì€ ì£¼ì°¨ ì§„ì…ë¡œ ë³´ìœ ", "â˜‘ [ë°œë ›íŒŒí‚¹] ì£¼ì°¨ ë¶€ìŠ¤ ë° ë°œë › ê³µê°„ í™•ë³´ë¡œ ë°©ë¬¸ê° í¸ì˜ì„± ê·¹ëŒ€í™”", "â˜‘ [ì£¼ì°¨ìˆ˜ìµ] ë„‰ë„‰í•œ ì£¼ì°¨ ê³µê°„ í™œìš©í•´ ì›” ì£¼ì°¨ ì¶”ê°€ ìˆ˜ìµ ì°½ì¶œ ê°€ëŠ¥", "â˜‘ [ì„ì°¨ì„ í˜¸] ì£¼ì°¨ ì „ìŸ ì—†ëŠ” ì¾Œì í•œ ê±´ë¬¼, ì„ì°¨ì¸ ë§Œì¡±ë„ ìµœìƒ", "â˜‘ [ì§„ì¶œì…] ì´ˆë³´ ìš´ì „ìë„ ì‰½ê²Œ ì£¼ì°¨ ê°€ëŠ¥í•œ ë„“ì€ ì£¼ì°¨ì¥ ì™„ë¹„", "â˜‘ [ë°©ë¬¸ê°] ê³ ê° ë°©ë¬¸ì´ ë§ì€ ë³‘ì›, í•™ì›, ê³ ê¸‰ ì‹ë‹¹ ìµœì í™” ê±´ë¬¼", "â˜‘ [ê¸°ê³„ì‹] ìµœì‹ í˜• ê¸°ê³„ì‹ ì£¼ì°¨ ì„¤ë¹„ë¡œ ì…ì¶œì°¨ ì‹œê°„ ë‹¨ì¶• ë° ê´€ë¦¬ ìš©ì´", "â˜‘ [ì „ìš©ì£¼ì°¨] ì‚¬ì˜¥ ì‚¬ìš© ì‹œ ì„ì§ì› ì „ìš© ì£¼ì°¨ ê³µê°„ ì¶©ë¶„íˆ í™•ë³´", "â˜‘ [ê²½ìŸìš°ìœ„] ì£¼ë³€ ê±´ë¬¼ ëŒ€ë¹„ ì••ë„ì ì¸ ì£¼ì°¨ ëŒ€ìˆ˜ë¡œ ê³µì‹¤ ê±±ì • ì—†ìŒ"],
        "ê°ì •ê°€ì´í•˜": ["â˜‘ [ê°ì •ê°€ì´í•˜] íƒìƒê°ì •ê°€ë³´ë‹¤ ë‚®ì€ ë§¤ë§¤ê°€, ëŒ€ì¶œ í•œë„ ê·¹ëŒ€í™” ê°€ëŠ¥", "â˜‘ [ì•ˆì „ë§ˆì§„] ê°ì •í‰ê°€ ê¸ˆì•¡ë³´ë‹¤ ì‹¸ê²Œ ì‚¬ëŠ” í™•ì‹¤í•œ ì•ˆì „ ë§ˆì§„ í™•ë³´", "â˜‘ [LTVìœ ë¦¬] ë§¤ê°€ ëŒ€ë¹„ ë†’ì€ ëŒ€ì¶œ ë¹„ìœ¨ë¡œ ì‹¤íˆ¬ìê¸ˆ ìµœì†Œí™” ì „ëµ", "â˜‘ [íˆ¬ì1ìˆœìœ„] ê²½ë§¤ë³´ë‹¤ ì‹¸ê²Œ ì‚´ ìˆ˜ ìˆëŠ” ì¼ë°˜ ë§¤ë§¤ ì´ˆê¸‰ë§¤ë¬¼", "â˜‘ [í™•ì‹¤í•œìˆ˜ìµ] ì‚¬ëŠ” ìˆœê°„ ì´ë¯¸ ëˆ ë²Œê³  ì‹œì‘í•˜ëŠ” ì‹¤íŒ¨ ì—†ëŠ” íˆ¬ì", "â˜‘ [ìì‚°ì¦ì‹] ì ì€ ë‚´ ëˆìœ¼ë¡œ í° ìì‚°ì„ êµ´ë¦´ ìˆ˜ ìˆëŠ” ë ˆë²„ë¦¬ì§€ íš¨ê³¼", "â˜‘ [ê°€ê²©ë°©ì–´] ê°ì •ê°€ ë°‘ìœ¼ë¡œëŠ” ê°€ê²©ì´ ë–¨ì–´ì§€ê¸° í˜ë“  ê°•ë ¥í•œ í•˜ë°© ê²½ì§ì„±", "â˜‘ [ë²•ì¸ì¶”ì²œ] ë²•ì¸ ëŒ€ì¶œ í™œìš© ì‹œ ìê¸°ìë³¸ ìˆ˜ìµë¥ (ROE) ê·¹ëŒ€í™” ê°€ëŠ¥", "â˜‘ [í¬ì†Œë§¤ë¬¼] ì‹œì¥ì— 1ë…„ì— í•œë‘ ë²ˆ ë‚˜ì˜¬ê¹Œ ë§ê¹Œ í•œ ê·€í•œ ì¡°ê±´", "â˜‘ [ì„¸ê¸ˆìœ ë¦¬] ë‚®ì€ ë§¤ì…ê°€ë¡œ ì·¨ë“ì„¸ ë“± ë¶€ëŒ€ ë¹„ìš© ì ˆê° íš¨ê³¼"],
        "ì´ˆì—­ì„¸ê¶Œ": ["â˜‘ [ì´ˆì—­ì„¸ê¶Œ] ì§€í•˜ì²  ì¶œêµ¬ ë‚˜ì˜¤ìë§ˆì ë³´ì´ëŠ” ê±´ë¬¼, ì ‘ê·¼ì„± ëíŒì™•", "â˜‘ [ìœ ë™ì¸êµ¬] ì¶œí‡´ê·¼ê¸¸ í•„ìˆ˜ ë™ì„ , ìì—°ìŠ¤ëŸ¬ìš´ ì›Œí¬ì¸ ê³ ê° ìœ ì…", "â˜‘ [í¬ì†Œì„±] ì—­ ë°”ë¡œ ì• í† ì§€ëŠ” ë¶€ë¥´ëŠ” ê²Œ ê°’, ì†Œì¥ ê°€ì¹˜ 100%", "â˜‘ [ê´‘ê³ íš¨ê³¼] ì§€í•˜ì²  ì´ìš©ê°ì—ê²Œ 24ì‹œê°„ ë…¸ì¶œë˜ëŠ” ì˜¥ì™¸ ê´‘ê³  ëª…ë‹¹", "â˜‘ [ê³µì‹¤ì œë¡œ] ì„ì°¨ì¸ì´ ì¤„ì„ ì„œëŠ” ì´ˆì—­ì„¸ê¶Œ, ì„ëŒ€ ê±±ì • ì—†ëŠ” íš¨ì", "â˜‘ [ì§€ê°€ìƒìŠ¹] ì—­ì„¸ê¶Œ ê°œë°œ í˜¸ì¬ë¥¼ ê°€ì¥ ë¨¼ì €, ê°€ì¥ í¬ê²Œ ëˆ„ë¦¬ëŠ” ìœ„ì¹˜", "â˜‘ [ë¶ˆí™©ë¬´í’] ê²½ê¸°ê°€ ì–´ë ¤ì›Œë„ ì´ˆì—­ì„¸ê¶Œ ìƒê¶Œì€ ë¬´ë„ˆì§€ì§€ ì•ŠìŒ", "â˜‘ [ì—…ì¢…ììœ ] íŒë§¤ì , ë³‘ì›, í”„ëœì°¨ì´ì¦ˆ ë¬´ì—‡ì´ë“  ë˜ëŠ” ë§ŒëŠ¥ ì…ì§€", "â˜‘ [ë¹„ê°€ì˜¤ë‚˜] ë‚ ì”¨ ì˜í–¥ ì—†ì´ ê³ ê°ì´ ì°¾ì•„ì˜¤ëŠ” ì „ì²œí›„ ìƒê¶Œ", "â˜‘ [íˆ¬ìì •ì„] ë¶€ë™ì‚° íˆ¬ìì˜ ê¸°ë³¸ì´ì ì •ë‹µì¸ ì´ˆì—­ì„¸ê¶Œ ë¶ˆíŒ¨ ì…ì§€"],
        "ëŒ€ë¡œë³€": ["â˜‘ [ëŒ€ë¡œë³€] ê°€ì‹œì„± ìµœìƒê¸‰, ê¸°ì—… í™ë³´ íš¨ê³¼ íƒì›”í•œ ëœë“œë§ˆí¬ ì…ì§€", "â˜‘ [Trophy Asset] ì†Œì¥ ê°€ì¹˜ í™•ì‹¤í•œ ëŒ€ë¡œë³€ ë¹Œë”©, ìì‚° ê°€ì¹˜ ìƒìŠ¹ ê¸°ëŒ€", "â˜‘ [ìƒì§•ì„±] ì›…ì¥í•œ ì „ë©´ í™•ë³´ë¡œ ëŒ€í˜• í”„ëœì°¨ì´ì¦ˆ ë° ë³‘ì› ì„ì°¨ ìœ ë¦¬", "â˜‘ [ì•ˆì „ì„±] í™˜ê¸ˆì„± ë›°ì–´ë‚œ ëŒ€ë¡œë³€ ì…ì§€, ì–¸ì œë“  í˜„ê¸ˆí™” ê°€ëŠ¥", "â˜‘ [ìŠ¤ì¹´ì´ë¼ì¸] ë„ì‹¬ì˜ ìŠ¤ì¹´ì´ë¼ì¸ì„ í˜•ì„±í•˜ëŠ” ì£¼ìš” ê±´ë¬¼", "â˜‘ [ì ‘ê·¼ì„±] ë²„ìŠ¤ ì •ë¥˜ì¥ ë° íš¡ë‹¨ë³´ë„ ì¸ì ‘í•˜ì—¬ ë³´í–‰ì ìœ ì… ìš°ìˆ˜", "â˜‘ [ì¬ê±´ì¶•] ì¶”í›„ ì‹ ì¶• ì‹œ ìš©ì ë¥  ì¸ì„¼í‹°ë¸Œ ë“± ê°œë°œ ì ì¬ë ¥ í’ë¶€", "â˜‘ [ì„ëŒ€ë£Œ] ì´ë©´ë„ë¡œ ëŒ€ë¹„ ì›”ë“±íˆ ë†’ì€ ì„ëŒ€ë£Œ ì±…ì • ê°€ëŠ¥", "â˜‘ [ë³´ì•ˆì¹˜ì•ˆ] ë°ê³  ë„“ì€ ë„ë¡œë³€ìœ¼ë¡œ ë°¤ëŠ¦ê²Œë„ ì•ˆì „í•˜ì—¬ ì„ì°¨ ì„ í˜¸", "â˜‘ [ê¸°ì—…ì„ í˜¸] ì‚¬ì˜¥ìœ¼ë¡œ ì‚¬ìš© ì‹œ íšŒì‚¬ì˜ ì‹ ë¢°ë„ë¥¼ ë†’ì—¬ì£¼ëŠ” ìœ„ì¹˜"],
        "ì˜¤í”¼ìŠ¤ìƒê¶Œ": ["â˜‘ [ì˜¤í”¼ìŠ¤ìƒê¶Œ] êµ¬ë§¤ë ¥ ë†’ì€ ì§ì¥ì¸ ìƒì£¼, í‰ì¼ ì ì‹¬ ë§¤ì¶œ í­ë°œì ", "â˜‘ [B2Bìˆ˜ìš”] ì£¼ë³€ ëŒ€ê¸°ì—… í˜‘ë ¥ì‚¬ ë° ê´€ë ¨ ì—…ì²´ ì‚¬ë¬´ì‹¤ ìˆ˜ìš” í’ë¶€", "â˜‘ [ì¸í”„ë¼] ì€í–‰, ê´€ê³µì„œ ë“± ì—…ë¬´ ì§€ì› ì‹œì„¤ ì¸ì ‘í•´ ì‚¬ì˜¥ìœ¼ë¡œ ì•ˆì„±ë§ì¶¤", "â˜‘ [ì£¼5ì¼ìƒê¶Œ] ì£¼ë§ ê´€ë¦¬ ìš©ì´í•˜ê³  í‰ì¼ ì§‘ì¤‘ì ì¸ ë§¤ì¶œ ë°œìƒí•˜ëŠ” íš¨ìœ¨ì  ìƒê¶Œ", "â˜‘ [ì ì‹¬ì „ìŸ] ì ì‹¬ì‹œê°„ë§ˆë‹¤ ì¤„ ì„œëŠ” ì‹ë‹¹ê°€, ìš”ì‹ì—… ì°½ì—… 1ìˆœìœ„ ì§€ì—­", "â˜‘ [íšŒì‹ìˆ˜ìš”] ì €ë… íšŒì‹ ë° ì ‘ëŒ€ ì¥ì†Œë¡œ ì´ì–´ì§€ëŠ” íƒ„íƒ„í•œ ì €ë… ìƒê¶Œ", "â˜‘ [ì„ëŒ€ì•ˆì •] ë²•ì¸ ì„ì°¨ì¸ì´ ë§ì•„ ì›”ì„¸ ì—°ì²´ ê±±ì • ì—†ëŠ” ê¹”ë”í•œ ê´€ë¦¬", "â˜‘ [ì¹´í˜ì„±ì§€] ì§ì¥ì¸ë“¤ì˜ ì»¤í”¼ ìˆ˜ìš”ë¡œ 1ì¸µ ì¹´í˜ ë§¤ì¶œ ì „êµ­ ìµœìƒìœ„ê¶Œ", "â˜‘ [êµí†µí¸ë¦¬] ì§ì›ë“¤ì˜ ì¶œí‡´ê·¼ì´ í¸ë¦¬í•œ êµí†µ ìš”ì¶©ì§€ì— ìœ„ì¹˜", "â˜‘ [ê¾¸ì¤€í•¨] ê²½ê¸°ë¥¼ ëœ íƒ€ê³  ê¾¸ì¤€í•œ ìˆ˜ìš”ê°€ ë°›ì³ì£¼ëŠ” ìŠ¤í…Œë””ì…€ëŸ¬ ìƒê¶Œ"],
        "ë²•ì¡°íƒ€ìš´": ["â˜‘ [ë²•ì¡°íƒ€ìš´] ë²•ì›/ê²€ì°°ì²­ ì¸ì ‘, ë³€í˜¸ì‚¬ ë° ë²•ë¬´ì‚¬ ì‚¬ë¬´ì‹¤ ì„ì°¨ ìˆ˜ìš” í’ë¶€", "â˜‘ [ì „ë¬¸ì§] ì›”ì„¸ ë°€ë¦´ ê±±ì • ì—†ëŠ” ê³ ì†Œë“ ì „ë¬¸ì§ ì„ì°¨ì¸ ì„ í˜¸ ì§€ì—­", "â˜‘ [ì•ˆì •ì„±] ê²½ê¸° íƒ€ì§€ ì•ŠëŠ” ë²•ë¥  ê´€ë ¨ ì—…ì¢… ë°€ì§‘, ê¾¸ì¤€í•œ ì„ëŒ€ ìˆ˜ìµ", "â˜‘ [í¬ì†Œì…ì§€] ë²•ì¡°íƒ€ìš´ ë‚´ ê±´ë¬¼ì€ ë§¤ë¬¼ì´ ê·€í•´ ë‚˜ì˜¤ë©´ ë°”ë¡œ ê±°ë˜ë¨", "â˜‘ [ê´€ê³µì„œ] ë“±ê¸°ì†Œ, ë²•ì› ë“± ê´€ê³µì„œ ì—…ë¬´ ì²˜ë¦¬ê°€ ë§¤ìš° í¸ë¦¬í•œ ìœ„ì¹˜", "â˜‘ [ìƒì£¼ì¸êµ¬] ê³ ì†Œë“ ì „ë¬¸ì§ ì¢…ì‚¬ìë“¤ì˜ ë†’ì€ ì†Œë¹„ë ¥ì„ ê°–ì¶˜ ìƒê¶Œ", "â˜‘ [ì¥ê¸°ì„ëŒ€] í•œ ë²ˆ ì‚¬ë¬´ì‹¤ì„ ê¾¸ë¯¸ë©´ ì˜ ì˜®ê¸°ì§€ ì•ŠëŠ” ì¥ê¸° ì„ì°¨ íŠ¹ì„±", "â˜‘ [ê³ ê¸‰í™”] ê¹”ë”í•˜ê³  ì¡°ìš©í•œ ë¶„ìœ„ê¸°ë¥¼ ì„ í˜¸í•˜ì—¬ ê±´ë¬¼ ê´€ë¦¬ê°€ ìˆ˜ì›”í•¨", "â˜‘ [ë¶€ëŒ€ìˆ˜ìµ] ë³µì‚¬, ì œë³¸, ë¬¸êµ¬ ë“± ê´€ë ¨ ì—…ì¢… ë‚™ìˆ˜ íš¨ê³¼ ë°œìƒ", "â˜‘ [ê°€ì¹˜ë³´ì¡´] íŠ¹ìˆ˜ ìƒê¶Œì˜ ì„±ê²©ì„ ë ì–´ ìì‚° ê°€ì¹˜ê°€ ì•ˆì •ì ìœ¼ë¡œ ìœ ì§€ë¨"],
        "ì‚¬ì˜¥ì¶”ì²œ": ["â˜‘ [ì‚¬ì˜¥ì¶”ì²œ] ì¾Œì í•œ ì—…ë¬´ ê³µê°„ê³¼ ë„‰ë„‰í•œ ì£¼ì°¨, ì„ì§ì› ë§Œì¡±ë„ ìµœìƒ", "â˜‘ [ë¸Œëœë”©] ì„¸ë ¨ëœ ì™¸ê´€ìœ¼ë¡œ ê¸°ì—… ì´ë¯¸ì§€ ìƒìŠ¹ ë° í™ë³´ íš¨ê³¼ ê¸°ëŒ€", "â˜‘ [íš¨ìœ¨ì„±] ì „ìš©ë¥  ë†’ê³  ë ˆì´ì•„ì›ƒ ë°°ì¹˜ ìœ ë¦¬í•´ ê³µê°„ í™œìš©ë„ 200%", "â˜‘ [ìì‚°ê°€ì¹˜] ì‚¬ì˜¥ìœ¼ë¡œ ì‚¬ìš©í•˜ë©° ì§€ê°€ ìƒìŠ¹ ëˆ„ë¦¬ëŠ” 'ì¼ì„ì´ì¡°' íˆ¬ì", "â˜‘ [í”„ë¼ì´ë¹—] ë‹¨ë… ì‚¬ì˜¥ìœ¼ë¡œ í™œìš© ì‹œ ì™¸ë¶€ ê°„ì„­ ì—†ëŠ” ë…ë¦½ì  ê³µê°„ í™•ë³´", "â˜‘ [ë³µì§€ê³µê°„] ì˜¥ìƒ ì •ì› ë° íœ´ê²Œ ê³µê°„ ì¡°ì„± ìš©ì´í•œ êµ¬ì¡°", "â˜‘ [ë¹„ìš©ì ˆê°] ì„ëŒ€ë£Œ ë‚´ëŠ” ëŒ€ì‹  ì´ì ë‚´ë©° ë‚´ ê±´ë¬¼ ê°–ëŠ” í˜„ëª…í•œ ì„ íƒ", "â˜‘ [ì»¤ìŠ¤í„°ë§ˆì´ì§•] ìš°ë¦¬ íšŒì‚¬ì˜ ì•„ì´ë´í‹°í‹°ì— ë§ì¶° ë‚´ë¶€ ì¸í…Œë¦¬ì–´ ê°€ëŠ¥", "â˜‘ [ì—­ì„¸ê¶Œ] ì§ì› ì±„ìš©ì— ìœ ë¦¬í•œ ì—­ì„¸ê¶Œ ìœ„ì¹˜ë¡œ ì¸ì¬ í™•ë³´ ìš©ì´", "â˜‘ [í™•ì¥ì„±] í–¥í›„ íšŒì‚¬ ì„±ì¥ ì‹œ ì¦ì¶•ì´ë‚˜ ë¦¬ëª¨ë¸ë§ ê°€ëŠ¥í•œ ìœ ì—°í•œ ê±´ë¬¼"],
        "ìˆ˜ë ¤í•œì™¸ê´€": ["â˜‘ [ë””ìì¸] ê±´ì¶•ìƒ ìˆ˜ìƒê¸‰ì˜ ìˆ˜ë ¤í•œ ì™¸ê´€, ì§€ì—­ ë‚´ ì‹œì„  ì§‘ì¤‘", "â˜‘ [ì»¨ë””ì…˜] ë‚´ì™¸ê´€ ê´€ë¦¬ ìƒíƒœ ìµœìƒ, ì†ë³¼ ê³³ ì—†ì´ ì¦‰ì‹œ ìˆ˜ìµ ë°œìƒ", "â˜‘ [ê°€ì‹œì„±] ë…íŠ¹í•˜ê³  ì•„ë¦„ë‹¤ìš´ ì™¸ê´€ìœ¼ë¡œ ìì—°ìŠ¤ëŸ¬ìš´ í™ë³´ íš¨ê³¼", "â˜‘ [ì„ì°¨ìœ ë¦¬] ë””ìì¸ ì—ì´ì „ì‹œ, IT ê¸°ì—… ë“± ê°ê°ì ì¸ ì„ì°¨ì¸ ì„ í˜¸", "â˜‘ [SNSëª…ì†Œ] ê±´ë¬¼ ìì²´ê°€ í¬í† ì¡´ì´ ë˜ì–´ SNSë¥¼ í†µí•œ ìë°œì  ë°”ì´ëŸ´", "â˜‘ [ê²½ìŸë ¥] ì£¼ë³€ ë…¸í›„ ê±´ë¬¼ë“¤ ì‚¬ì´ì—ì„œ ë…ë³´ì ìœ¼ë¡œ ë¹›ë‚˜ëŠ” ì¡´ì¬ê°", "â˜‘ [ì„ëŒ€ë£Œ] ì™¸ê´€ í”„ë¦¬ë¯¸ì—„ìœ¼ë¡œ ì£¼ë³€ ì‹œì„¸ë³´ë‹¤ ë†’ì€ ì„ëŒ€ë£Œ ì±…ì • ê°€ëŠ¥", "â˜‘ [ê´€ë¦¬ìë¶€ì‹¬] ì†Œìœ ì£¼ë¡œì„œì˜ ë§Œì¡±ê°ì´ ë§¤ìš° ë†’ì€ ì˜ˆìˆ ì  ê°€ì¹˜ ë³´ìœ ", "â˜‘ [ì•¼ê²½ì—°ì¶œ] ì¡°ëª… ì„¤ì¹˜ ì‹œ ë°¤ì—ë„ ì•„ë¦„ë‹¤ìš´ ì§€ì—­ì˜ ëœë“œë§ˆí¬", "â˜‘ [ìì‚°ê°€ì¹˜] ì˜ ì§€ì€ ê±´ë¬¼ í•˜ë‚˜ê°€ ì—´ ë§ˆì¼€íŒ… ì•ˆ ë¶€ëŸ¬ìš´ ê°€ì¹˜ ì°½ì¶œ"],
        "ìš©ì ë¥ ì´ë“": ["â˜‘ [ìš©ì ë¥ ì´ë“] í˜„ì¬ ë²•ì • ìš©ì ë¥ ë³´ë‹¤ ë” ë†’ê²Œ ì§€ì–´ì§„ 'ì´ë“ ë³¸' ê±´ë¬¼", "â˜‘ [ê°€ì„±ë¹„] ê°™ì€ ë•… í¬ê¸°ë¼ë„ ì—°ë©´ì ì´ ë„“ì–´ ì„ëŒ€ ìˆ˜ìµ ê·¹ëŒ€í™” ê°€ëŠ¥", "â˜‘ [í¬ì†Œì„±] ì§€ê¸ˆ ì‹ ì¶•í•˜ë©´ ì´ë§Œí¼ ëª» ì§“ëŠ” ê·€í•œ 'ì˜¤ë²„ ìš©ì ë¥ ' ë§¤ë¬¼", "â˜‘ [ì² ê±°ë°˜ëŒ€] ì‹ ì¶•ë³´ë‹¤ëŠ” ë¦¬ëª¨ë¸ë§ì„ í†µí•´ ê¸°ì¡´ ë©´ì  ì‚´ë¦¬ëŠ” ì „ëµ ì¶”ì²œ", "â˜‘ [ìˆ˜ìµë¥ ] ë„“ì€ ì„ëŒ€ ë©´ì ìœ¼ë¡œ ì¸í•´ ë§¤ê°€ ëŒ€ë¹„ ë†’ì€ ìˆ˜ìµë¥  ë‹¬ì„±", "â˜‘ [ìˆ¨ì€ê°€ì¹˜] ê³µë¶€ìƒ ë©´ì ë³´ë‹¤ ì‹¤ì‚¬ìš© ë©´ì ì´ ë” ë„“ì€ ì•Œì§œë°°ê¸°", "â˜‘ [ê·œì œë°˜ì‚¬ì´ìµ] ê³¼ê±° ê±´ì¶•ë²• í˜œíƒì„ ê·¸ëŒ€ë¡œ ëˆ„ë¦¬ëŠ” í•©ë²•ì  íŠ¹í˜œ", "â˜‘ [ê³µê°„í™œìš©] ì„œë¹„ìŠ¤ ë©´ì ì´ ë§ì•„ ì„ì°¨ì¸ë“¤ì—ê²Œ ì¸ê¸° ë§Œì ", "â˜‘ [ë§¤ê°ìœ ë¦¬] ë¦¬ëª¨ë¸ë§ ì „ë¬¸ íˆ¬ììë‚˜ ë””ë²¨ë¡œí¼ë“¤ì´ ê°€ì¥ ì°¾ëŠ” ì¡°ê±´", "â˜‘ [ë³´ë„ˆìŠ¤] ë•…ì„ ìƒ€ëŠ”ë° ê±´ë¬¼ì„ ë¤ìœ¼ë¡œ ë” ë°›ì€ ë“¯í•œ í˜œì ë§¤ë¬¼"],
        "ë”ë¸”ì—­ì„¸ê¶Œ": ["â˜‘ [ë”ë¸”ì—­ì„¸ê¶Œ] 2ê°œ ë…¸ì„ ì´ êµì°¨í•˜ëŠ” êµí†µ ìš”ì¶©ì§€, ê´‘ì—­ ìˆ˜ìš” í¡ìˆ˜", "â˜‘ [í™©ê¸ˆë…¸ì„ ] ê°•ë‚¨ ë° ì£¼ìš” ì—…ë¬´ì§€êµ¬ ì ‘ê·¼ì„± ìš°ìˆ˜, ì§€ê°€ ìƒìŠ¹ ê²¬ì¸", "â˜‘ [í¬ì†Œì„±] ë”ë¸” ì—­ì„¸ê¶Œì˜ í¬ì†Œê°€ì¹˜ë¡œ í–¥í›„ ë§¤ê° ì°¨ìµ ê·¹ëŒ€í™” ê¸°ëŒ€", "â˜‘ [Sê¸‰ì…ì§€] ìœ ë™ì¸êµ¬ì™€ ë°°í›„ìˆ˜ìš” ëª¨ë‘ ê°–ì¶˜ ì‹¤íŒ¨ ì—†ëŠ” íˆ¬ìì²˜", "â˜‘ [í™˜ìŠ¹ê±°ì ] í™˜ìŠ¹ê° ìœ ì…ìœ¼ë¡œ ìƒê¶Œ í™œì„±í™”ê°€ ë³´ì¥ëœ ìœ„ì¹˜", "â˜‘ [ê°œë°œí˜¸ì¬] êµí†µ ê²°ì ˆì  ì¤‘ì‹¬ìœ¼ë¡œ ì´ë£¨ì–´ì§€ëŠ” ê°ì¢… ê°œë°œì˜ ìµœëŒ€ ìˆ˜í˜œ", "â˜‘ [ì„ëŒ€íŒŒì›Œ] ì„œìš¸ ì „ì—­ì—ì„œ ì¶œí‡´ê·¼ ê°€ëŠ¥í•˜ì—¬ ê¸°ì—…ì²´ ì„ì°¨ ì„ í˜¸ë„ 1ìœ„", "â˜‘ [ì‹œì„¸ê²¬ì¸] ë¶ˆí™©ê¸°ì—ëŠ” ê°€ê²© ë°©ì–´, í˜¸í™©ê¸°ì—ëŠ” ì‹œì„¸ ìƒìŠ¹ ì£¼ë„", "â˜‘ [ë³µí•©ìƒê¶Œ] ì£¼ê±°ì™€ ì—…ë¬´ ê¸°ëŠ¥ì´ í˜¼ì¬ëœ ë³µí•© ìƒê¶Œ í˜•ì„± ìœ ë¦¬", "â˜‘ [ë¯¸ë˜ê°€ì¹˜] ë…¸ì„ ì´ í•˜ë‚˜ ë” ìˆëŠ” ê²ƒë§Œìœ¼ë¡œë„ ê°€ì¹˜ëŠ” 2ë°° ì´ìƒ ì°¨ì´"],
        "ëŒ€ë¡œì½”ë„ˆ": ["â˜‘ [ëŒ€ë¡œì½”ë„ˆ] ëŒ€ë¡œë³€ê³¼ ì´ë©´ë„ë¡œë¥¼ ëª¨ë‘ ì ‘í•œ ìµœê³ ì˜ ëª…ë‹¹ ìë¦¬", "â˜‘ [ê°€ì‹œì„±] 3ë©´ ê°œë°©í˜•ìœ¼ë¡œ ì–´ë””ì„œë“  ì˜ ë³´ì´ëŠ” ì••ë„ì  ë…¸ì¶œ íš¨ê³¼", "â˜‘ [ì§„ì…ì„±] ì°¨ëŸ‰ ë° ë³´í–‰ì ì ‘ê·¼ì´ ëª¨ë‘ ìš©ì´í•œ ìµœì ì˜ ì…ì§€", "â˜‘ [í”„ë¦¬ë¯¸ì—„] ì½”ë„ˆ ìë¦¬ëŠ” ë¶€ë¥´ëŠ” ê²Œ ê°’, í–¥í›„ ì§€ê°€ ìƒìŠ¹ 1ìˆœìœ„", "â˜‘ [ê±´ì¶•ìœ ë¦¬] ì‹ ì¶• ì‹œ ì¼ì¡°ê¶Œ ì‚¬ì„  ì œí•œì„ ëœ ë°›ì•„ ë†’ê²Œ ê±´ì¶• ê°€ëŠ¥", "â˜‘ [ê°œë°©ê°] ë‹µë‹µí•¨ ì—†ëŠ” ì‹œì›í•œ ë·°ì™€ ê°œë°©ê°ìœ¼ë¡œ ê±´ë¬¼ ê°€ì¹˜ ìƒìŠ¹", "â˜‘ [ì„ëŒ€êµ¬ì„±] 1ì¸µì€ íŒë§¤ì , ìƒì¸µë¶€ëŠ” ë³‘ì›/ì‚¬ë¬´ì‹¤ ë“± ë‹¤ì–‘í•œ êµ¬ì„± ê°€ëŠ¥", "â˜‘ [ê´‘ê³ ìˆ˜ìµ] ì™¸ë²½ì„ í™œìš©í•œ ì˜¥ì™¸ ê´‘ê³  ìˆ˜ìµ ì°½ì¶œ ê°€ëŠ¥í•œ ìœ„ì¹˜", "â˜‘ [ëœë“œë§ˆí¬] ì½”ë„ˆ ê±´ë¬¼ì˜ íŠ¹ì„±ìƒ ì§€ì—­ì˜ ì´ì •í‘œ ì—­í• ì„ ìˆ˜í–‰", "â˜‘ [ë§¤ê°ìš©ì´] ëˆ„êµ¬ë‚˜ íƒë‚´ëŠ” ìœ„ì¹˜ë¡œ í™˜ê¸ˆì„±ì´ ë§¤ìš° ë›°ì–´ë‚¨"],
        "í•­ì•„ë¦¬ìƒê¶Œ": ["â˜‘ [ë…ì ìƒê¶Œ] 5,000ì„¸ëŒ€ ì´ìƒ ëŒ€ë‹¨ì§€ ë°°í›„ ìˆ˜ìš” ë…ì í•˜ëŠ” í•­ì•„ë¦¬ ì…ì§€", "â˜‘ [ìƒí™œë°€ì°©] ë³‘ì›, ì•½êµ­, í•™ì› ë“± í•„ìˆ˜ ê·¼ìƒ ì—…ì¢… ìµœì í™”ëœ ê±´ë¬¼", "â˜‘ [ì¶©ì„±ê³ ê°] ì™¸ë¶€ ìœ ì¶œ ì—†ì´ ë‹¨ì§€ ë‚´ ê³ ì • ê³ ê° í™•ë³´ëœ ì•ˆì •ì  ìƒê¶Œ", "â˜‘ [ê³µì‹¤ì œë¡œ] í•œ ë²ˆ ë“¤ì–´ì˜¤ë©´ ë‚˜ê°€ì§€ ì•ŠëŠ” ì„ì°¨ì¸, ê´€ë¦¬ í¸í•œ íš¨ì ë§¤ë¬¼", "â˜‘ [ì•ˆì •ìˆ˜ìµ] ê²½ê¸°ë¥¼ íƒ€ì§€ ì•ŠëŠ” ì£¼ê±° ë°€ì°©í˜• ìƒê¶Œ, ë”°ë°•ë”°ë°• ì›”ì„¸ ë³´ì¥", "â˜‘ [ê°€ì¡±ë‹¨ìœ„] ì£¼ë§ì—ë„ ì™¸ì‹ ë° ì—¬ê°€ ìˆ˜ìš”ë¡œ ë¶ë¹„ëŠ” ê°€ì¡± ì¤‘ì‹¬ ìƒê¶Œ", "â˜‘ [í•™ì›ë©”ì¹´] í•™êµì™€ ì•„íŒŒíŠ¸ ì‚¬ì´, í•™ì› ì„ì°¨ ëŒ€ê¸° ìˆ˜ìš” ë„˜ì¹˜ëŠ” ê³³", "â˜‘ [ê²½ìŸì•ˆì „] ì¸ê·¼ì— ê²½ìŸ ìƒê¶Œì´ ë“¤ì–´ì„¤ ìë¦¬ê°€ ì—†ëŠ” ë…ì ì  ì§€ìœ„", "â˜‘ [ì†Œë¹„íŒ¨í„´] ìŠ¬ë¦¬í¼ ì‹ ê³  ë‚˜ì˜¤ëŠ” í¸ì•ˆí•œ ì†Œë¹„ ì‹¬ë¦¬ ìê·¹", "â˜‘ [ìš´ì˜í¸ë¦¬] ì„ì°¨ì¸ ê´€ë¦¬ê°€ ìˆ˜ì›”í•˜ê³  ì†ë°”ë€œì´ ì ì–´ ìŠ¤íŠ¸ë ˆìŠ¤ ì—†ìŒ"],
        "í•«í”Œë ˆì´ìŠ¤": ["â˜‘ [í•«í”Œë ˆì´ìŠ¤] MZì„¸ëŒ€ê°€ ì°¾ì•„ì˜¤ëŠ” ì§€ì—­ ëª…ì†Œ, SNS ì—…ë¡œë“œ ì„±ì§€", "â˜‘ [íŠ¸ë Œë“œ] ê°€ì¥ í™í•œ F&B ë¸Œëœë“œë“¤ì´ ì…ì í•˜ê³  ì‹¶ì–´ í•˜ëŠ” ê±´ë¬¼", "â˜‘ [ë¯¸ë˜ê°€ì¹˜] ìƒê¶Œ í™•ì¥ì„¸ê°€ ëšœë ·í•˜ì—¬ ë§¤ê° ì‹œ ë†’ì€ ì‹œì„¸ ì°¨ìµ ê¸°ëŒ€", "â˜‘ [ê¶Œë¦¬ê¸ˆ] ë†’ì€ ê¶Œë¦¬ê¸ˆì´ í˜•ì„±ë˜ì–´ ìˆì–´ ì„ëŒ€ë£Œ ì—°ì²´ ê±±ì • ì—†ìŒ", "â˜‘ [ìœ ë™í­ë°œ] ì£¼ë§ ì›¨ì´íŒ… ì¤„ì´ ê±´ë¬¼ì„ ê°ì‹¸ëŠ” ì—„ì²­ë‚œ ì§‘ê°ë ¥", "â˜‘ [ì„ëŒ€ë£ŒìƒìŠ¹] ë§¤ì¶œì´ ë†’ìœ¼ë‹ˆ ì„ëŒ€ë£Œ ì¸ìƒ ì €í•­ì´ ì ì€ ê³ ì„±ì¥ ì§€ì—­", "â˜‘ [ì Šì€ìƒê¶Œ] ì†Œë¹„ ì„±í–¥ì´ ê°•í•œ 2030 ì„¸ëŒ€ê°€ ì£¼ë„í•˜ëŠ” í™œê¸°ì°¬ ë¶„ìœ„ê¸°", "â˜‘ [íŒì—…ìŠ¤í† ì–´] ë‹¨ê¸° íŒì—… ìŠ¤í† ì–´ ì„ëŒ€ ë¬¸ì˜ê°€ ì‡„ë„í•˜ëŠ” ë§ˆì¼€íŒ… ìš”ì§€", "â˜‘ [ê°€ì¹˜ì¬í‰ê°€] ë‚¡ì€ ì£¼íƒì´ ê·¼ìƒìœ¼ë¡œ ë°”ë€Œë©° ê°€ì¹˜ê°€ ê¸‰ë“±í•˜ëŠ” ì§€ì—­", "â˜‘ [ë¬¸í™”ì¤‘ì‹¬] ë‹¨ìˆœ ìƒê¶Œì„ ë„˜ì–´ ë¬¸í™”ë¥¼ ì†Œë¹„í•˜ëŠ” ì§€ì—­ì˜ ì•„ì´ì½˜"],
        "ìˆ˜ìµí˜•": ["â˜‘ [ìˆ˜ìµí˜•] íƒ„íƒ„í•œ ì„ì°¨ êµ¬ì„±ìœ¼ë¡œ ë§¤ì›” ë”°ë°•ë”°ë°• ì›”ì„¸ ë“¤ì–´ì˜¤ëŠ” íš¨ì", "â˜‘ [ê³ ìˆ˜ìµ] ë ˆë²„ë¦¬ì§€ í™œìš© ì‹œ ì—° 5% ì´ìƒ ìˆ˜ìµë¥  ë‹¬ì„± ê°€ëŠ¥í•œ ì•Œì§œ", "â˜‘ [ê³µì‹¤ì œë¡œ] ëŒ€ê¸° ìˆ˜ìš” í’ë¶€í•´ ê³µì‹¤ ê±±ì • ì—†ì´ ë§ˆìŒ í¸í•œ ì„ëŒ€ ì‚¬ì—…", "â˜‘ [ì€í‡´ì¤€ë¹„] ì•ˆì •ì ì¸ í˜„ê¸ˆ íë¦„ìœ¼ë¡œ ë…¸í›„ ëŒ€ë¹„ ë° ì¦ì—¬ìš©ìœ¼ë¡œ ê°•ë ¥ ì¶”ì²œ", "â˜‘ [ìš°ëŸ‰ì„ì°¨] ìŠ¤íƒ€ë²…ìŠ¤, ì˜¬ë¦¬ë¸Œì˜ ë“± ìš°ëŸ‰ ë¸Œëœë“œ ì…ì  ì‹œ ê°€ì¹˜ ìƒìŠ¹", "â˜‘ [ê´€ë¦¬í¸ë¦¬] ì‹œì„¤ ê´€ë¦¬ ì˜ë˜ì–´ ìˆê³  ì„ì°¨ì¸ ì„±í–¥ ì¢‹ì•„ ìš´ì˜ ìŠ¤íŠ¸ë ˆìŠ¤ ç„¡", "â˜‘ [ë‹¤ê°í™”] ì£¼ê±°+ìƒê°€ ë³µí•© êµ¬ì„±ìœ¼ë¡œ ë¦¬ìŠ¤í¬ ë¶„ì‚° ë° ì•ˆì •ì„± í™•ë³´", "â˜‘ [ìºì‹œì¹´ìš°] ë¬»ì–´ë‘ë©´ ì•Œì•„ì„œ ëˆ ë²Œì–´ì˜¤ëŠ” í™•ì‹¤í•œ í˜„ê¸ˆ ì°½ì¶œì›", "â˜‘ [ì¸í”Œë ˆì´ì…˜] ë¬¼ê°€ ìƒìŠ¹ë¶„ë§Œí¼ ì„ëŒ€ë£Œ ì¸ìƒ ê°€ëŠ¥í•œ ì‹¤ë¬¼ ìì‚°", "â˜‘ [ì´ììƒí™˜] ì›”ì„¸ë¡œ ëŒ€ì¶œ ì´ì ë‚´ê³ ë„ ìƒí™œë¹„ê°€ ë‚¨ëŠ” ë„‰ë„‰í•œ ìˆ˜ìµ"],
        "ì‹ ì¶•ë¹Œë”©": ["â˜‘ [ëœë“œë§ˆí¬] ì§€ì—­ ë‚´ ì••ë„ì ì¸ ì¡´ì¬ê° ìë‘í•˜ëŠ” ìµœì‹ ì¶• í•˜ì´ì—”ë“œ ë¹Œë”©", "â˜‘ [í¬ì†Œì„±] ë…¸í›„ ê±´ë¬¼ ì¦ë¹„í•œ ì§€ì—­ ë‚´ ë‹¨ë¹„ ê°™ì€ ì‹ ì¶•, ê²½ìŸ ìš°ìœ„ í™•ì‹¤", "â˜‘ [í”„ë¦¬ë¯¸ì—„] ì‹ ì¶• í”„ë¦¬ë¯¸ì—„ìœ¼ë¡œ í–¥í›„ ë§¤ê° ì‹œ ë†’ì€ ì‹œì„¸ ì°¨ìµ ê¸°ëŒ€", "â˜‘ [ì ˆì„¸íš¨ê³¼] ë²•ì¸ ì‚¬ì˜¥ ë§¤ì… ì‹œ ë¹„ìš© ì²˜ë¦¬ ë° ìì‚° ê°€ì¹˜ ìƒìŠ¹ ë™ì‹œ íš¨ê³¼", "â˜‘ [ì»¨ë””ì…˜] ìµœì‹  ì„¤ë¹„ì™€ ì¸í…Œë¦¬ì–´ë¡œ ì„ì°¨ì¸ ì„ í˜¸ë„ 1ìœ„", "â˜‘ [ìœ ì§€ë³´ìˆ˜] í–¥í›„ 10ë…„ê°„ í° ëˆ ë“¤ì–´ê°ˆ ì¼ ì—†ëŠ” ì™„ë²½í•œ ê´€ë¦¬ ìƒíƒœ", "â˜‘ [ì—˜ë¦¬ë² ì´í„°] ìµœì‹ í˜• ìŠ¹ê°•ê¸°ì™€ ê³ ê¸‰ ë¡œë¹„ë¡œ ê±´ë¬¼ì˜ ê²©ì¡°ë¥¼ ë†’ì„", "â˜‘ [ì„ëŒ€ë£Œ] ì£¼ë³€ ì‹œì„¸ ëŒ€ë¹„ 1.5ë°° ì´ìƒ ë†’ì€ ì„ëŒ€ë£Œ ìˆ˜ë ¹ ê°€ëŠ¥", "â˜‘ [ì£¼ì°¨ê³µê°„] ë²•ì • ì£¼ì°¨ ëŒ€ìˆ˜ ì´ìƒ í™•ë³´í•˜ì—¬ ì£¼ì°¨ í¸ì˜ì„± ê·¹ëŒ€í™”", "â˜‘ [ì¦‰ì‹œìˆ˜ìµ] ê³µì‚¬ ê¸°ê°„ ê¸°ë‹¤ë¦´ í•„ìš” ì—†ì´ ë§¤ì… ì¦‰ì‹œ ì„ëŒ€ ìˆ˜ìµ ë°œìƒ"],
        "ì‹ ì¶•ë¶€ì§€ìš©": ["â˜‘ [ì‹ ì¶•ë¶€ì§€] ë…¸í›„ ê±´ë¬¼ì„ ì² ê±°í•˜ê³  ì›í•˜ëŠ” ì»¨ì…‰ìœ¼ë¡œ ì‹ ì¶• ê°€ëŠ¥í•œ ë•…", "â˜‘ [ë””ë²¨ë¡œí•‘] ëª…ë„ ì™„ë£Œ í›„ ì‹ ì¶• ì‹œ ë“œë¼ë§ˆí‹±í•œ ê°€ì¹˜ ìƒìŠ¹ ê¸°ëŒ€", "â˜‘ [ë§ì¶¤ì„¤ê³„] ì‚¬ì˜¥ì´ë‚˜ ë©”ë””ì»¬ ë¹Œë”© ë“± ë‚´ ì…ë§›ëŒ€ë¡œ ê±´ì¶• ê°€ëŠ¥", "â˜‘ [í† ì§€ê°€ì¹˜] ê±´ë¬¼ê°’ì€ 0ì›, ì˜¤ì§ ë•…ì˜ ê°€ì¹˜ë§Œ ë³´ê³  íˆ¬ìí•˜ëŠ” ê³³", "â˜‘ [ìš©ë„ë³€ê²½] ì£¼íƒì„ ê·¼ìƒìœ¼ë¡œ ìš©ë„ ë³€ê²½í•˜ì—¬ ê°€ì¹˜ ë°¸ë¥˜ì—… ê°€ëŠ¥", "â˜‘ [ê±´ì¶•í—ˆê°€] ê±´ì¶• í—ˆê°€ ë“í•œ ìƒíƒœë¡œ ì¦‰ì‹œ ì°©ê³µ ê°€ëŠ¥í•œ ì‹œê°„ ì ˆì•½ ë§¤ë¬¼", "â˜‘ [ì„¸ì œí˜œíƒ] ë©¸ì‹¤ í›„ ë‚˜ëŒ€ì§€ ìƒíƒœ ê±°ë˜ í˜¹ì€ ì£¼íƒìˆ˜ ì œì™¸ ì „ëµ ê°€ëŠ¥", "â˜‘ [ì ì¬ë ¥] í˜„ì¬ ëª¨ìŠµë³´ë‹¤ ë¯¸ë˜ì˜ ì‹ ì¶• í›„ ëª¨ìŠµì´ ê¸°ëŒ€ë˜ëŠ” ì›ì„", "â˜‘ [í•˜ì´ì—”ë“œ] ì§€ì—­ ë‚´ ìµœê³ ê¸‰ ëœë“œë§ˆí¬ë¥¼ ì§ì ‘ ì§€ì„ ìˆ˜ ìˆëŠ” ê¸°íšŒ", "â˜‘ [ìˆ˜ìµê·¹ëŒ€í™”] ë‹¨ìˆœ ë³´ìœ ë³´ë‹¤ ê°œë°œ í–‰ìœ„ë¥¼ í†µí•´ ìì‚° ê°€ì¹˜ ë»¥íŠ€ê¸°"],
        "íŠ¸ë¦¬í”Œì—­ì„¸ê¶Œ": ["â˜‘ [íŠ¸ë¦¬í”Œì—­ì„¸ê¶Œ] 3ê°œ ë…¸ì„ ì´ ë§Œë‚˜ëŠ” êµí†µì˜ ì‹¬ì¥ë¶€, í­ë°œì  ìœ ë™ì¸êµ¬", "â˜‘ [ì´ˆíŠ¹ê¸‰ì…ì§€] ì„œìš¸ ì „ì—­ ì–´ë””ë“  ë¹ ë¥´ê²Œ ì´ë™ ê°€ëŠ¥í•œ êµí†µ í—ˆë¸Œ", "â˜‘ [íˆ¬ìê°€ì¹˜] ëŒ€í•œë¯¼êµ­ ìƒìœ„ 1% ì…ì§€, ë¬»ì–´ë‘ë©´ ë¬´ì¡°ê±´ ì˜¤ë¥´ëŠ” ê³³", "â˜‘ [ì„ëŒ€ë³´ì¥] ê³µì‹¤ì´ë€ ë‹¨ì–´ê°€ ì—†ëŠ” ê³³, ìµœê³ ì˜ ì„ëŒ€ ì•ˆì •ì„± ìë‘", "â˜‘ [ê´‘ì—­ìˆ˜ìš”] ì¸ê·¼ ì§€ì—­ë¿ë§Œ ì•„ë‹ˆë¼ ìˆ˜ë„ê¶Œ ì „ì—­ì—ì„œ ì°¾ì•„ì˜¤ëŠ” ìƒê¶Œ", "â˜‘ [ì§€ê°€í­ë°œ] ë…¸ì„  í•˜ë‚˜ ëš«ë¦´ ë•Œë§ˆë‹¤ ê³„ë‹¨ì‹ìœ¼ë¡œ ìƒìŠ¹í•˜ëŠ” ì§€ê°€", "â˜‘ [ë³µí•©ê°œë°œ] ì—­ì‚¬ ì£¼ë³€ ëŒ€í˜• ë³µí•© ê°œë°œ í˜¸ì¬ë¡œ ì¸í•œ ë‚™ìˆ˜ íš¨ê³¼", "â˜‘ [ê¸°ì—…ì„ í˜¸] ë³¸ì‚¬ ì‚¬ì˜¥ìœ¼ë¡œ ê°€ì¥ ì„ í˜¸í•˜ëŠ” êµí†µì˜ ì¤‘ì‹¬ì§€", "â˜‘ [í™˜ê¸ˆì„±] ë‚´ë†“ìœ¼ë©´ ë°”ë¡œ íŒ”ë¦¬ëŠ” í™˜ê¸ˆì„± ìµœê³ ì˜ ì•ˆì „ ìì‚°", "â˜‘ [ëŒ€ì¥ì£¼] ì§€ì—­ ë¶€ë™ì‚° ì‹œì„¸ë¥¼ ê²¬ì¸í•˜ëŠ” í™•ì‹¤í•œ ëŒ€ì¥ì£¼ ì…ì§€"],
        "ì´ë©´ì½”ë„ˆ": ["â˜‘ [ì´ë©´ì½”ë„ˆ] ë©”ì¸ ìƒê¶Œ ì´ë©´ì˜ ì•Œì§œ ì½”ë„ˆ, ê°€ì„±ë¹„ ìµœê³ ì˜ ì‹¤ì† ë§¤ë¬¼", "â˜‘ [ë¨¹ììƒê¶Œ] ì ì‹¬/ì €ë… ìœ ë™ì¸êµ¬ ë°”ê¸€ë°”ê¸€í•œ ì´ë©´ ë¨¹ì ê³¨ëª©ì˜ ìš”ì§€", "â˜‘ [ì•ˆì •ì„±] ìœ í–‰ íƒ€ì§€ ì•ŠëŠ” íƒ„íƒ„í•œ ë°°í›„ ìˆ˜ìš”ë¡œ ê³µì‹¤ ê±±ì • ì—†ëŠ” ê³³", "â˜‘ [ìˆ˜ìµë¥ ] ëŒ€ë¡œë³€ ëŒ€ë¹„ í•©ë¦¬ì  ë§¤ê°€ë¡œ ë†’ì€ ì„ëŒ€ ìˆ˜ìµ ì‹¤í˜„ ê°€ëŠ¥", "â˜‘ [ì‹¤ì†íˆ¬ì] ê±°í’ˆ ë¹ ì§„ ê°€ê²©ìœ¼ë¡œ ì•Œì§œ ìˆ˜ìµì„ ì˜¬ë¦´ ìˆ˜ ìˆëŠ” ê¸°íšŒ", "â˜‘ [ê°œë°©ê°] ì´ë©´ë„ë¡œì§€ë§Œ ì½”ë„ˆ ì…ì§€ë¡œ ë‹µë‹µí•˜ì§€ ì•Šì€ ì‹œì•¼ í™•ë³´", "â˜‘ [ê°€ì‹œì„±] ì–‘ë°©í–¥ í†µí–‰ ì°¨ëŸ‰ ë° ë³´í–‰ìì—ê²Œ ìì—°ìŠ¤ëŸ¬ìš´ ë…¸ì¶œ", "â˜‘ [ê±´ì¶•ì´ì ] ì¼ì¡°ê¶Œ ë“± ê±´ì¶• ì œí•œì—ì„œ ì¤‘ê°„ ë‚€ í•„ì§€ë³´ë‹¤ ìœ ë¦¬í•¨", "â˜‘ [ì ‘ê·¼ì„±] ëŒ€ë¡œë³€ì—ì„œ ë°”ë¡œ ì§„ì… ê°€ëŠ¥í•œ ì´ˆì… ì´ë©´ ì½”ë„ˆ ì„ í˜¸", "â˜‘ [ì•Œì§œë°°ê¸°] ì•„ëŠ” ì‚¬ëŒì€ ë‹¤ ì•„ëŠ” ìˆ˜ìµë¥  ê¹¡íŒ¨ ë§¤ë¬¼"],
        "í•™êµ°ì§€": ["â˜‘ [í•™êµ°ì§€] ëŒ€ì¹˜/ëª©ë™ê¸‰ ëª…ë¬¸ í•™ì›ê°€ ë°€ì§‘, í•™ì› ì„ì°¨ ìˆ˜ìš” í­ë°œ", "â˜‘ [í•­ì•„ë¦¬ìƒê¶Œ] í•™ìƒ ë° í•™ë¶€ëª¨ ê³ ì • ìˆ˜ìš”ë¡œ 365ì¼ ë¶ì ì´ëŠ” ìƒê¶Œ", "â˜‘ [ìš°ëŸ‰ì„ì°¨] í”„ëœì°¨ì´ì¦ˆ í•™ì›, ìŠ¤í„°ë””ì¹´í˜ ë“± ì¥ê¸° ìš°ëŸ‰ ì„ì°¨ì¸ ì„ í˜¸", "â˜‘ [ë¶ˆíŒ¨ì‹ í™”] êµìœ¡ì—´ ë†’ì€ ì§€ì—­ íŠ¹ì„±ìƒ ê²½ê¸° ì¹¨ì²´ì—ë„ ë„ë–¡ì—†ëŠ” ìƒê¶Œ", "â˜‘ [ìƒì¸µë¶€] ìƒì¸µë¶€ê¹Œì§€ í•™ì›ìœ¼ë¡œ ê³µì‹¤ ì—†ì´ ì±„ì›Œì§€ëŠ” ì•Œì§œ ê±´ë¬¼", "â˜‘ [ë°¤ìƒ˜ìƒê¶Œ] ëŠ¦ì€ ì‹œê°„ê¹Œì§€ í•™ì›ìƒê³¼ í”½ì—… ì°¨ëŸ‰ìœ¼ë¡œ í™œê¸°ì°¬ ë¶„ìœ„ê¸°", "â˜‘ [ì„ëŒ€ë£Œ] í•™ë¶€ëª¨ë“¤ì˜ ë†’ì€ ì§€ë¶ˆ ëŠ¥ë ¥ìœ¼ë¡œ ì•ˆì •ì ì¸ ì„ëŒ€ë£Œ ìˆ˜ì·¨", "â˜‘ [ìƒí˜¸ì‹œë„ˆì§€] í•™ì›, ë…ì„œì‹¤, ë¶„ì‹ì  ë“± ì—°ê´€ ì—…ì¢… ì‹œë„ˆì§€ íš¨ê³¼", "â˜‘ [ì§„ì…ì¥ë²½] ì‹ ê·œ ì§„ì…ì´ ì–´ë ¤ìš´ íƒ„íƒ„í•œ í•™êµ° ìˆ˜ìš” ë…ì ", "â˜‘ [ìì‚°ê°€ì¹˜] í•™êµ°ì´ ë¬´ë„ˆì§€ì§€ ì•ŠëŠ” í•œ ì˜ì›íˆ ìš°ìƒí–¥í•˜ëŠ” ê°€ì¹˜"],
        "ë©”ë””ì»¬ì…ì§€": ["â˜‘ [ë©”ë””ì»¬] ì—˜ë¦¬ë² ì´í„°, ì£¼ì°¨, ì „ë ¥ ë“± ë³‘ì˜ì› ê°œì› í•˜ë“œì›¨ì–´ ì™„ë²½", "â˜‘ [ë…ì ìˆ˜ìš”] ì•½êµ­ ì…ì  ê°€ëŠ¥í•´ ê³ ìˆ˜ìµ ì°½ì¶œ ë° ê±´ë¬¼ ê°€ì¹˜ ë ˆë²¨ì—…", "â˜‘ [ì‹œë„ˆì§€] ë‚´ê³¼, ì´ë¹„ì¸í›„ê³¼ ë“± ì—°ê³„ ì²˜ë°© ê°€ëŠ¥í•œ ë©”ë””ì»¬ ë¹Œë”© ìµœì ", "â˜‘ [ê³ ë ¹í™”] ì¸êµ¬ ê³ ë ¹í™”ë¡œ ì˜ë£Œ ìˆ˜ìš” ì¦ê°€, ê³µì‹¤ ê±±ì • ì—†ëŠ” ë©”ë””ì»¬ ì…ì§€", "â˜‘ [ë°°í›„ì„¸ëŒ€] ëŒ€ë‹¨ì§€ ì•„íŒŒíŠ¸ë¥¼ ë¼ê³  ìˆì–´ ë³‘ì› ê°œì› ì‹œ ëŒ€ë°• ë‚  ìë¦¬", "â˜‘ [ì¥ê¸°ì„ì°¨] ì¸í…Œë¦¬ì–´ ë¹„ìš©ì´ ë†’ì•„ í•œ ë²ˆ ë“¤ì–´ì˜¤ë©´ 10ë…„ ì´ìƒ ì¥ê¸° ì„ì°¨", "â˜‘ [ê³ ìˆ˜ìµ] ì¼ë°˜ ì‚¬ë¬´ì‹¤ ëŒ€ë¹„ ì›”ë“±íˆ ë†’ì€ ì„ëŒ€ë£Œ ê°ë‹¹ ëŠ¥ë ¥ ë³´ìœ ", "â˜‘ [ê´€ë¦¬ìˆ˜ì›”] ë³‘ì› íŠ¹ì„±ìƒ ê±´ë¬¼ì„ ê¹¨ë—í•˜ê²Œ ì‚¬ìš©í•˜ì—¬ ìœ ì§€ ê´€ë¦¬ ìš©ì´", "â˜‘ [ì²˜ë°©ì „] ì¼ì¼ ì²˜ë°©ì „ ê±´ìˆ˜ ë³´ì¥ë˜ëŠ” ì•½êµ­ ìë¦¬ì˜ ê°€ì¹˜ëŠ” ìƒìƒ ì´ˆì›”", "â˜‘ [ì‹ ë¢°ë„] ë³‘ì›ì´ ì…ì í•œ ê±´ë¬¼ì´ë¼ëŠ” ì´ë¯¸ì§€ë¡œ ê±´ë¬¼ ê°€ì¹˜ ë™ë°˜ ìƒìŠ¹"],
        "ì‹œì„¸ì°¨ìµ": ["â˜‘ [ì‹œì„¸ì°¨ìµ] ì§€ê¸ˆ ì‚¬ë‘ë©´ 3ë…„ ë’¤ ì›ƒê²Œ ë  í™•ì‹¤í•œ ì§€ê°€ ìƒìŠ¹ ì§€ì—­", "â˜‘ [ì €í‰ê°€] ì£¼ë³€ í˜¸ì¬ ëŒ€ë¹„ ì•„ì§ ì €í‰ê°€ëœ ê°€ê²©, ìƒìŠ¹ ì—¬ë ¥ ì¶©ë¶„", "â˜‘ [ê°œë°œí˜¸ì¬] GTX, ì¬ê°œë°œ ë“± ëŒ€í˜• í˜¸ì¬ê°€ ëŒ€ê¸° ì¤‘ì¸ íˆ¬ì ìœ ë§ì²˜", "â˜‘ [í† ì§€íˆ¬ì] ê±´ë¬¼ ìˆ˜ìµë³´ë‹¤ ë•…ê°’ ìƒìŠ¹ìœ¼ë¡œ ìì‚°ì„ ë¶ˆë¦´ ìµœê³ ì˜ ê¸°íšŒ", "â˜‘ [ì„ ì íš¨ê³¼] ë‚¨ë“¤ì´ ì£¼ëª©í•˜ê¸° ì „ ë¯¸ë¦¬ ì„ ì í•˜ì—¬ ìˆ˜ìµë¥  ê·¹ëŒ€í™”", "â˜‘ [ë¯¸ë˜ê°€ì¹˜] í˜„ì¬ëŠ” ë‚¡ì•˜ì§€ë§Œ ì…ì§€ì˜ í˜ìœ¼ë¡œ í€€í…€ ì í”„í•  ë§¤ë¬¼", "â˜‘ [ì¸í”Œë ˆì´ì…˜] í™”í ê°€ì¹˜ í•˜ë½ì„ ë°©ì–´í•˜ê³  ìì‚°ì„ ì¦ì‹ì‹œí‚¤ëŠ” ìˆ˜ë‹¨", "â˜‘ [ì†ë°”ë€œ] ê±°ë˜ê°€ ë¹ˆë²ˆí•˜ê²Œ ì¼ì–´ë‚˜ë©° ì‹œì„¸ê°€ ê³„ë‹¨ì‹ìœ¼ë¡œ ìƒìŠ¹ ì¤‘", "â˜‘ [ê°­ë©”ìš°ê¸°] ì¸ê·¼ ìƒê¸‰ì§€ ì‹œì„¸ë¥¼ ë”°ë¼ê°€ëŠ” í‚¤ ë§ì¶”ê¸° ì¥ì„¸ì˜ ìˆ˜í˜œ", "â˜‘ [ë¹…í”½ì²˜] 10ë…„ í›„ë¥¼ ë‚´ë‹¤ë³´ê³  ìë…€ì—ê²Œ ë¬¼ë ¤ì¤„ ë§Œí•œ ê°€ì¹˜ íˆ¬ì"],
        "ê´€ë¦¬ìƒíƒœìµœìƒ": ["â˜‘ [ê´€ë¦¬ìµœìƒ] ê±´ë¬¼ì£¼ê°€ ê±°ì£¼í•˜ë©° ì§ì ‘ ê´€ë¦¬í•´ ì‹ ì¶•ì²˜ëŸ¼ ê¹”ë”í•œ ì»¨ë””ì…˜", "â˜‘ [ë¹„ìš©ì ˆê°] ëˆ„ìˆ˜/ë°©ìˆ˜/ì™¸ë²½ ë“± ìµœê·¼ ë³´ìˆ˜ ì™„ë£Œ, ì†ë³¼ ê³³ í•˜ë‚˜ ì—†ìŒ", "â˜‘ [ì„ì°¨ì¸] ê±´ë¬¼ ê´€ë¦¬ ì˜ë˜ì–´ ì„ì°¨ì¸ ë§Œì¡±ë„ ë†’ê³  ì¬ê³„ì•½ë¥  ìš°ìˆ˜", "â˜‘ [ê°€ì„±ë¹„] ì—°ì‹ ëŒ€ë¹„ ë„ˆë¬´ë‚˜ ê¹¨ë—í•œ ë‚´ì™¸ê´€, ê°€ì„±ë¹„ ìµœê³ ì˜ ì„ íƒ", "â˜‘ [ì£¼ì¸ì •ì„±] êµ¬ì„êµ¬ì„ ì£¼ì¸ì˜ ì†ê¸¸ì´ ë‹¿ì•„ìˆëŠ” ì• ì • ì–´ë¦° ê±´ë¬¼", "â˜‘ [ì¦‰ì‹œìˆ˜ìµ] ë§¤ì… í›„ ì¶”ê°€ ìˆ˜ë¦¬ë¹„ ì§€ì¶œ ì—†ì´ ë°”ë¡œ ì„ëŒ€ ìˆ˜ìµ ì‹¤í˜„", "â˜‘ [ì„¤ë¹„êµì²´] ë°°ê´€, ì „ê¸° ë“± ë³´ì´ì§€ ì•ŠëŠ” ì„¤ë¹„ê¹Œì§€ êµì²´ ì™„ë£Œëœ ì•Œì§œ", "â˜‘ [ì²«ì¸ìƒ] ê¹”ë”í•œ ë¡œë¹„ì™€ ë³µë„ë¡œ ë°©ë¬¸ê°ì—ê²Œ ì¢‹ì€ ì¸ìƒ ì‹¬ì–´ì¤Œ", "â˜‘ [í•˜ìì œë¡œ] ì¤‘ê°œì‚¬ê°€ ìì‹  ìˆê²Œ ê¶Œí•˜ëŠ” í•˜ì ê±±ì • ì—†ëŠ” ì•ˆì‹¬ ë§¤ë¬¼", "â˜‘ [ì‹œê°„ì ˆì•½] ìœ ì§€ ë³´ìˆ˜ì— ì‹ ê²½ ì“¸ ì‹œê°„ê³¼ ì—ë„ˆì§€ë¥¼ ì•„ê»´ì£¼ëŠ” íš¨ì"],
        "ëª…ë„ì™„ë£Œ": ["â˜‘ [ëª…ë„ì™„ë£Œ] ê³¨ì¹˜ ì•„í”ˆ ëª…ë„ ë¬¸ì œ 100% í•´ê²°, ì¦‰ì‹œ ì‚¬ì—… ì§„í–‰ ê°€ëŠ¥", "â˜‘ [ì‹ ì¶•ì¶”ì²œ] ì”ê¸ˆê³¼ ë™ì‹œì— ì² ê±° ê°€ëŠ¥í•˜ì—¬ ê¸ˆìœµ ë¹„ìš© ì ˆê° íš¨ê³¼", "â˜‘ [ë¦¬ëª¨ë¸ë§] í…… ë¹ˆ ê±´ë¬¼ì—ì„œ ë‚´ê°€ ì›í•˜ëŠ” ëŒ€ë¡œ ëŒ€ìˆ˜ì„  ê³µì‚¬ ê°€ëŠ¥", "â˜‘ [ì‹œê°„ì ˆì•½] ëª…ë„ í˜‘ì˜ì— ê±¸ë¦¬ëŠ” ìˆ˜ê°œì›”ì˜ ì‹œê°„ì„ ë²ˆ ì…ˆì¸ ê·€í•œ ë§¤ë¬¼", "â˜‘ [ë¦¬ìŠ¤í¬ë¬´] ê¶Œë¦¬ê¸ˆì´ë‚˜ ì´ì‚¬ë¹„ ë¶„ìŸ ì—†ì´ ê¹”ë”í•˜ê²Œ ì†Œìœ ê¶Œ ì´ì „", "â˜‘ [ì‚¬ì˜¥ì…ì£¼] ë§¤ì… ì¦‰ì‹œ ìš°ë¦¬ íšŒì‚¬ê°€ ì „ ì¸µ ì‚¬ìš© ê°€ëŠ¥í•œ ë“œë¬¸ ê¸°íšŒ", "â˜‘ [í†µì„ëŒ€] ê¸°ì—…ì²´ í†µì„ëŒ€ ë§ì¶°ì„œ ìˆ˜ìµë¥  ê·¹ëŒ€í™”í•˜ê¸° ì¢‹ì€ ì¡°ê±´", "â˜‘ [ëŒ€ì¶œìœ ë¦¬] ê³µì‹¤ ìƒíƒœë¼ ë‹´ë³´ ëŒ€ì¶œ ì§„í–‰ ì‹œ ë°© ê³µì œ ë“±ì—ì„œ ìœ ë¦¬", "â˜‘ [ë¹ ë¥¸ì§„í–‰] ê³„ì•½ë¶€í„° ì”ê¸ˆê¹Œì§€ ì¼ì‚¬ì²œë¦¬ë¡œ ì§„í–‰ ê°€ëŠ¥í•œ ì¿¨ ë§¤ë¬¼", "â˜‘ [ë°±ì§€ìƒíƒœ] ë‚´ ì…ë§›ëŒ€ë¡œ ì„ì°¨ì¸ì„ ìƒˆë¡œ ì„¸íŒ…í•  ìˆ˜ ìˆëŠ” ê¸°íšŒ"],
        "ê´‘ì—­í™˜ìŠ¹": ["â˜‘ [ê´‘ì—­í™˜ìŠ¹] GTX/KTX/ê´‘ì—­ë²„ìŠ¤ í™˜ìŠ¹ ì„¼í„° ì¸ì ‘, êµí†µì˜ ì§‘ê²°ì§€", "â˜‘ [ë¯¸ë˜ê°€ì¹˜] ê´‘ì—­ êµí†µë§ í™•ì¶©ìœ¼ë¡œ í–¥í›„ ì²œì§€ê°œë²½í•  íˆ¬ìì˜ ì¤‘ì‹¬", "â˜‘ [ìœ ë™ì¸êµ¬] ê²½ê¸°ë„ ë° ì§€ë°© ì¸êµ¬ê¹Œì§€ í¡ìˆ˜í•˜ëŠ” ê±°ëŒ€ ìƒê¶Œ í˜•ì„±", "â˜‘ [ê°œë°œí˜¸ì¬] í™˜ìŠ¹ì„¼í„° ë³µí•© ê°œë°œ ë“± ëŒ€í˜• í˜¸ì¬ì˜ ì§ì ‘ ìˆ˜í˜œì§€", "â˜‘ [í—ˆë¸Œì…ì§€] êµí†µì´ ëª¨ì´ëŠ” ê³³ì— ëˆì´ ëª¨ì¸ë‹¤ëŠ” ë¶€ë™ì‚° ê²©ì–¸ ì¦ëª…", "â˜‘ [ìƒê¶Œí™•ì¥] ë‹¨ìˆœ í™˜ìŠ¹ì„ ë„˜ì–´ ì‡¼í•‘, ë¬¸í™”ê°€ ê²°í•©ëœ ê±°ëŒ€ ìƒê¶Œí™”", "â˜‘ [ì „êµ­êµ¬] ì„œìš¸ë¿ë§Œ ì•„ë‹ˆë¼ ì „êµ­ ì–´ë””ì„œë“  ì ‘ê·¼ ê°€ëŠ¥í•œ êµí†µ ìš”ì§€", "â˜‘ [ì§€ê°€ìƒìŠ¹] GTX ê°œí†µ ë“± í˜¸ì¬ ì‹¤í˜„ ì‹œ í­ë°œì ì¸ ì‹œì„¸ ì°¨ìµ ê¸°ëŒ€", "â˜‘ [ê¸°ì—…ìœ ì¹˜] ì ‘ê·¼ì„±ì´ ì¢‹ì•„ ë³¸ì‚¬ ì‚¬ì˜¥ ë° ì§€ì‚¬ ì„¤ë¦½ ìˆ˜ìš” ê¸‰ì¦", "â˜‘ [ëœë“œë§ˆí¬] ì§€ì—­ì„ ë„˜ì–´ ê´‘ì—­ ìƒí™œê¶Œì˜ ì¤‘ì‹¬ì§€ë¡œ ë„ì•½í•  ì…ì§€"],
        "ì´ë©´ì´ˆì…": ["â˜‘ [ì´ë©´ì´ˆì…] ëŒ€ë¡œë³€ ë°”ë¡œ í•œ ë¸”ë¡ ë’¤, ê°€ì‹œì„±ê³¼ ê°€ì„±ë¹„ ëª¨ë‘ ì¡ìŒ", "â˜‘ [ì§„ì…ë¡œ] ìƒê¶Œìœ¼ë¡œ ë“¤ì–´ê°€ëŠ” ê´€ë¬¸ ì…ì§€, ìœ ë™ì¸êµ¬ ìì—° ìœ ì…", "â˜‘ [ì‹¤ì†í˜•] ëŒ€ë¡œë³€ì˜ ê´‘ê³  íš¨ê³¼ëŠ” ëˆ„ë¦¬ë©´ì„œ ê°€ê²©ì€ í•©ë¦¬ì ì¸ ë§¤ë¬¼", "â˜‘ [ë¨¹ìì´ˆì…] ë¨¹ìê³¨ëª© ì‹œì‘ì ì— ìœ„ì¹˜í•˜ì—¬ ë§Œë‚¨ì˜ ì¥ì†Œë¡œ ìœ ëª…", "â˜‘ [íˆ¬ìíš¨ìœ¨] ëŒ€ë¡œë³€ ëŒ€ë¹„ ë‚®ì€ ë§¤ê°€ë¡œ ë†’ì€ ìˆ˜ìµë¥  ë‹¬ì„± ê°€ëŠ¥", "â˜‘ [ê´‘ê³ íš¨ê³¼] ì´ë©´ì´ì§€ë§Œ ëŒ€ë¡œë³€ì—ì„œë„ ê°„íŒì´ ë³´ì´ëŠ” í‹ˆìƒˆ ì…ì§€", "â˜‘ [ì„ëŒ€ì„ í˜¸] ì ‘ê·¼ì„± ì¢‹ê³  ì„ëŒ€ë£Œ í•©ë¦¬ì ì´ë¼ ê³µì‹¤ ìœ„í—˜ ë‚®ìŒ", "â˜‘ [í™•ì¥ì„±] ëŒ€ë¡œë³€ ìƒê¶Œì´ í™•ì¥ë  ë•Œ ê°€ì¥ ë¨¼ì € ìˆ˜í˜œë¥¼ ì…ëŠ” ì§€ì—­", "â˜‘ [ìœ ì—°ì„±] ì‚¬ì˜¥, ê·¼ìƒ, ì£¼íƒ ë“± ì–´ë–¤ ìš©ë„ë¡œë„ í™œìš© ê°€ëŠ¥í•œ ë©€í‹°í”Œë ˆì´ì–´", "â˜‘ [ì•Œì§œíˆ¬ì] ëŒ€ë¡œë³€ ì§„ì…ì´ ë¶€ë‹´ìŠ¤ëŸ¬ìš´ íˆ¬ììì—ê²Œ ìµœê³ ì˜ ëŒ€ì•ˆ"],
        "ìˆ²ì„¸ê¶Œ": ["â˜‘ [ìˆ²ì„¸ê¶Œ] ë„ì‹¬ ì† íë§, ê³µì› ë° ë…¹ì§€ ì¸ì ‘í•´ ì¾Œì í•œ ì—…ë¬´ í™˜ê²½", "â˜‘ [ì›Œë¼ë°¸] ì ì‹¬ì‹œê°„ ì‚°ì±… ê°€ëŠ¥í•œ ìˆ²ì„¸ê¶Œ ì…ì§€, ì Šì€ ì§ì¥ì¸ ì„ í˜¸ë„ ê¸‰ìƒìŠ¹", "â˜‘ [ë·°ë§›ì§‘] ì°½ë°–ìœ¼ë¡œ í¼ì³ì§€ëŠ” íŒŒí¬ë·°, ê°œë°©ê°ê³¼ ì¡°ë§ê¶Œ í™•ë³´ëœ ê±´ë¬¼", "â˜‘ [í¬ì†Œì„±] íŒíŒí•œ ë„ì‹¬ ë‚´ í¬ì†Œí•œ ìì—° ì¹œí™”ì  ì…ì§€, ë¯¸ë˜ ê°€ì¹˜ ìš°ìˆ˜", "â˜‘ [íœ´ì‹] ê±´ë¬¼ ì˜¥ìƒì´ë‚˜ í…Œë¼ìŠ¤ì—ì„œ ëˆ„ë¦¬ëŠ” ìˆ² ì¡°ë§ í”„ë¦¬ë¯¸ì—„", "â˜‘ [ì°½ì˜ì„±] ì¾Œì í•œ í™˜ê²½ì´ ì°½ì˜ì ì¸ ì—…ë¬´ ëŠ¥ë¥ ì„ ë†’ì—¬ì£¼ëŠ” ì‚¬ì˜¥ ì…ì§€", "â˜‘ [ê±´ê°•] ë¯¸ì„¸ë¨¼ì§€ ê±±ì • ëœê³  ë§‘ì€ ê³µê¸° ë§ˆì‹œëŠ” ì¹œí™˜ê²½ ì…ì§€", "â˜‘ [ì‚°ì±…ë¡œ] ê³µì› ì‚°ì±…ë¡œì™€ ì—°ê²°ë˜ì–´ ìœ ë™ì¸êµ¬ê°€ ìì—°ìŠ¤ëŸ½ê²Œ ìœ ì…", "â˜‘ [ë°˜ë ¤ë™ë¬¼] ì• ê²¬ ì¹´í˜, ë™ë¬¼ ë³‘ì› ë“± ë°˜ë ¤ë™ë¬¼ ê´€ë ¨ ì—…ì¢… ìµœì ì§€", "â˜‘ [í”„ë¦¬ë¯¸ì—„] ìˆ²ì„¸ê¶Œ ì•„íŒŒíŠ¸ì²˜ëŸ¼ ìˆ²ì„¸ê¶Œ ë¹Œë”©ë„ í¬ì†Œê°€ì¹˜ë¡œ ê°€ê²© ìƒìŠ¹"],
        "ê°€ì‹œì„±ìš°ìˆ˜": ["â˜‘ [ê°€ì‹œì„±] ë©€ë¦¬ì„œë„ í•œëˆˆì— ë“¤ì–´ì˜¤ëŠ” íƒì›”í•œ ê°€ì‹œì„±, ê´‘ê³ íŒ ê·¸ ìì²´", "â˜‘ [ë…¸ì¶œíš¨ê³¼] ì°¨ëŸ‰ ë° ë³´í–‰ìì—ê²Œ 24ì‹œê°„ ìì—°ìŠ¤ëŸ½ê²Œ ë…¸ì¶œë˜ëŠ” ìœ„ì¹˜", "â˜‘ [í™ë³´ëª…ë‹¹] ê°„íŒ ì„¤ì¹˜ ì‹œ ê´‘ê³  íš¨ê³¼ê°€ ë›°ì–´ë‚˜ ì„ì°¨ì¸ì´ ì„ í˜¸í•˜ëŠ” ê³³", "â˜‘ [ê°œë°©ê°] ë‹µë‹µí•¨ ì—†ì´ ë»¥ ëš«ë¦° ì‹œì•¼ í™•ë³´, ê±´ë¬¼ì´ ì»¤ ë³´ì´ëŠ” íš¨ê³¼", "â˜‘ [ê²½ìŸë ¥] ëˆˆì— ì˜ ë„ëŠ” ê±´ë¬¼ì´ ì†ë‹˜ë„ ë§ì´ ë„ëŠ” ë²•", "â˜‘ [ì „ë©´ê¸¸ì´] ë„ë¡œì— ì ‘í•œ ì „ë©´ì´ ë„“ì–´ ì›…ì¥í•´ ë³´ì´ëŠ” ì‹œê°ì  íš¨ê³¼", "â˜‘ [ì•¼ê°„ê²½ê´€] ë°¤ì´ ë˜ë©´ ì¡°ëª… íš¨ê³¼ë¡œ ë”ìš± ë‹ë³´ì´ëŠ” ì§€ì—­ì˜ ëœë“œë§ˆí¬", "â˜‘ [ì°¾ê¸°ì‰¬ì›€] ì£¼ì†Œë§Œ ì°ìœ¼ë©´ ëˆ„êµ¬ë‚˜ ì‰½ê²Œ ì°¾ì•„ì˜¤ëŠ” ë›°ì–´ë‚œ ì ‘ê·¼ì„±", "â˜‘ [ì„ëŒ€ìœ ë¦¬] í”„ëœì°¨ì´ì¦ˆ ë³¸ì‚¬ì—ì„œ ê°€ì¥ ë¨¼ì € ì»¨íƒí•˜ëŠ” Aê¸‰ ê°€ì‹œì„±", "â˜‘ [ìì‚°ê°€ì¹˜] ëˆˆì— ë„ëŠ” ê±´ë¬¼ì´ ë‚˜ì¤‘ì— íŒ” ë•Œë„ ì œê°’ ë°›ìŒ"],
        "ë²¨ë¥˜ì—…ìœ ë§": ["â˜‘ [ë°¸ë¥˜ì—…] ë¦¬ëª¨ë¸ë§ ì‹œ ì„ëŒ€ë£Œ 2ë°° ìƒìŠ¹ ê°€ëŠ¥í•œ ì›ì„ ê°™ì€ ë§¤ë¬¼", "â˜‘ [ìš©ì ë¥ ] ë²•ì  ìš©ì ë¥  ëŒ€ë¹„ ëœ ì°¾ì•„ë¨¹ì€ ìƒíƒœ, ì¦ì¶• í†µí•´ ê°€ì¹˜ ê·¹ëŒ€í™”", "â˜‘ [ë””ë²¨ë¡œí¼] ë‚¡ì€ ê±´ë¬¼ì„ ëª…ë„ í›„ ì‹ ì¶•í•˜ë©´ ìˆ˜ìµë¥  30% ì´ìƒ ê¸°ëŒ€", "â˜‘ [ê°€ì¹˜íˆ¬ì] í˜„ì¬ì˜ ë‚¡ì€ ëª¨ìŠµë³´ë‹¤ ë¯¸ë˜ì˜ ë°”ë€ ëª¨ìŠµì„ ë³´ê³  íˆ¬ìí•  ê³³", "â˜‘ [ì„±í˜•ì „] ì¡°ê¸ˆë§Œ ì†ë³´ë©´ ì§€ì—­ ëœë“œë§ˆí¬ë¡œ ë³€ì‹ í•  ì ì¬ë ¥ ë³´ìœ ", "â˜‘ [ì €í‰ê°€] ê±´ë¬¼ ìƒíƒœ ë•Œë¬¸ì— ì €í‰ê°€ëœ ê°€ê²©, ê³ ì¹˜ë©´ ë°”ë¡œ ì‹œì„¸ ì°¨ìµ", "â˜‘ [ìš©ë„ë³€ê²½] ì£¼íƒì„ ê·¼ìƒìœ¼ë¡œ ë³€ê²½í•˜ì—¬ ìˆ˜ìµí˜• ë¶€ë™ì‚°ìœ¼ë¡œ ì¬íƒ„ìƒ", "â˜‘ [MDê°œí¸] ì„ì°¨ êµ¬ì„± ì¬ë°°ì¹˜(MD)ë§Œìœ¼ë¡œë„ ê±´ë¬¼ ê°€ì¹˜ í€€í…€ ì í”„", "â˜‘ [ì™¸ê´€íŠ¹í™”] ë‚¡ì€ ì™¸ê´€ì„ ì„¸ë ¨ë˜ê²Œ ë°”ê¿” ë™ë„¤ ë¶„ìœ„ê¸°ë¥¼ ë°”ê¿€ ê¸°íšŒ", "â˜‘ [ê³ ìˆ˜ì˜ì—­] ë‚¨ë“¤ì´ ëª» ë³´ëŠ” ê°€ì¹˜ë¥¼ ë°œê²¬í•´ í° ìˆ˜ìµì„ ë‚´ëŠ” ê³ ìˆ˜ì˜ íˆ¬ì"],
        "ë¦¬ëª¨ë¸ë§": ["â˜‘ [ë¦¬ëª¨ë¸ë§] ë¼ˆëŒ€ë§Œ ë‚¨ê¸°ê³  ì‹¹ ê³ ì¹˜ë©´ ì‹ ì¶•ê¸‰ ì„±ëŠ¥ ë°œíœ˜ ê°€ëŠ¥", "â˜‘ [ë¹„ìš©ì ˆê°] ì‹ ì¶• ëŒ€ë¹„ ì €ë ´í•œ ê³µì‚¬ë¹„ë¡œ ë“œë¼ë§ˆí‹±í•œ ì„ëŒ€ë£Œ ìƒìŠ¹", "â˜‘ [íŠ¸ë Œë“œ] ë…¸í›„ ê±´ë¬¼ì„ í™í•œ ê³µê°„ìœ¼ë¡œ ë³€ì‹ ì‹œì¼œ ì Šì€ ì¸µ ìœ ì… ìœ ë„", "â˜‘ [ì—˜ë¦¬ë² ì´í„°] ìŠ¹ê°•ê¸° ì‹ ì„¤ ë° ì™¸ê´€ êµì²´ ì‹œ ê±´ë¬¼ ê°€ì¹˜ ìˆ˜ì§ ìƒìŠ¹", "â˜‘ [ê³µê¸°ë‹¨ì¶•] ì‹ ì¶•ë³´ë‹¤ ì§§ì€ ê³µì‚¬ ê¸°ê°„ìœ¼ë¡œ ê¸ˆìœµ ë¹„ìš© ì ˆì•½ ë° ë¹ ë¥¸ ìˆ˜ìµ", "â˜‘ [ë¯¼ì›ìµœì†Œ] ì‹ ì¶• ê³µì‚¬ì— ë¹„í•´ ì´ì›ƒ ë¯¼ì›ì´ ì ì–´ ì‚¬ì—… ì§„í–‰ ìˆ˜ì›”", "â˜‘ [ë²•ì í˜œíƒ] ì£¼ì°¨ ëŒ€ìˆ˜ë‚˜ ì¡°ê²½ ë“± ê¸°ì¡´ ë²•ê·œ ì ìš©ë°›ëŠ” ìœ ë¦¬í•œ ì ", "â˜‘ [ë§ì¶¤í˜•] ë‚´ ì˜ˆì‚°ê³¼ ëª©ì ì— ë§ì¶° ë¶€ë¶„ ë¦¬ëª¨ë¸ë§ë„ ê°€ëŠ¥í•œ ìœ ì—°ì„±", "â˜‘ [ì¬íƒ„ìƒ] ì£½ì–´ìˆë˜ ê³µê°„ì„ ì‚´ë ¤ë‚´ì–´ í•«í”Œë ˆì´ìŠ¤ë¡œ ë§Œë“œëŠ” ë§ˆë²•", "â˜‘ [ê°€ì„±ë¹„] ìµœì†Œí•œì˜ íˆ¬ìë¡œ ìµœëŒ€í•œì˜ íš¨ê³¼ë¥¼ ë‚´ëŠ” ìŠ¤ë§ˆíŠ¸í•œ íˆ¬ìë²•"],
        "ëª…ë„í˜‘ì˜ê°€ëŠ¥": ["â˜‘ [ëª…ë„í˜‘ì˜] ë§¤ìˆ˜ì¸ì˜ ê³„íšì— ë§ì¶° ëª…ë„ ì‹œê¸° ë° ì¡°ê±´ ìœ ì—°í•˜ê²Œ ì¡°ìœ¨", "â˜‘ [ì±…ì„ëª…ë„] ë§¤ë„ì¸ì´ ì±…ì„ì§€ê³  ëª…ë„í•´ì£¼ëŠ” ì¡°ê±´, ê³¨ì¹˜ ì•„í”Œ ì¼ ì—†ìŒ", "â˜‘ [ì‹¤ì‚¬ìš©] ì¼ë¶€ ì¸µ ëª…ë„í•˜ì—¬ ë§¤ìˆ˜ì¸ì´ ì¦‰ì‹œ ì…ì£¼ ê°€ëŠ¥í•œ ì‹¤ìš©ì  ë§¤ë¬¼", "â˜‘ [ìœˆìœˆ] ê¸°ì¡´ ì„ì°¨ì¸ ìŠ¹ê³„ì™€ ëª…ë„ ì¤‘ ìœ ë¦¬í•œ ìª½ìœ¼ë¡œ ì„ íƒ ê°€ëŠ¥", "â˜‘ [í˜‘ìƒë ¥] ëª…ë„ ì¡°ê±´ì„ ì¹´ë“œë¡œ í™œìš©í•´ ë§¤ë§¤ê°€ ë„¤ê³  ê°€ëŠ¥ì„± ì—´ë¦¼", "â˜‘ [ë¦¬ìŠ¤í¬ê´€ë¦¬] ê³„ì•½ ì‹œ ëª…ë„ ì™„ë£Œ ì¡°ê±´ì„ íŠ¹ì•½ìœ¼ë¡œ ë„£ì–´ ì•ˆì „í•˜ê²Œ ì§„í–‰", "â˜‘ [ì‹œê°„ì¡°ì ˆ] ì”ê¸ˆ ì¼ìë¥¼ ë„‰ë„‰íˆ ì¡ì•„ ëª…ë„ ë° ìê¸ˆ ê³„íš ìˆ˜ë¦½ ìš©ì´", "â˜‘ [ë¶€ë¶„ëª…ë„] í•„ìš”í•œ ì¸µë§Œ ë¹„ìš°ê³  ë‚˜ë¨¸ì§€ëŠ” ì„ëŒ€ ìˆ˜ìµ ìœ ì§€í•˜ëŠ” ì „ëµ", "â˜‘ [ìœ ì—°ì„±] íˆ¬ì ëª©ì ì— ë”°ë¼ ìœµí†µì„± ìˆê²Œ ëŒ€ì‘ ê°€ëŠ¥í•œ í˜‘ì¡°ì  ë§¤ë„ì¸", "â˜‘ [ê¸°íšŒ] ê¹Œë‹¤ë¡œìš´ ëª…ë„ ë¬¸ì œë¥¼ í˜‘ì˜ë¡œ í’€ì–´ë‚´ë©´ í° ìˆ˜ìµìœ¼ë¡œ ë³´ë‹µ"]
    }
      
    final_results = []
    
    # [1] ì‚¬ìš©ì ì½”ë©˜íŠ¸ê°€ ìˆìœ¼ë©´ ìµœìš°ì„  ì‚½ì… (ì´ 11ê°œê°€ ë  ìˆ˜ë„ ìˆìŒ)
    if user_comment:
        final_results.append(f"ğŸ“Œ {user_comment.strip()[:40]}") 

    # [2] ì„ íƒëœ í‚¤ì›Œë“œ ê°œìˆ˜ í™•ì¸
    num_selected = len(env_features)
    target_count = 10  # ëª©í‘œ ê°œìˆ˜
    
    if num_selected > 0:
        if num_selected <= target_count:
            # --- [Case A] í‚¤ì›Œë“œ ê°œìˆ˜ê°€ 10ê°œ ì´í•˜ì¸ ê²½ìš° (Në¹µ + ì•ìª½ ëª°ì•„ì£¼ê¸°) ---
            # ì˜ˆ: 3ê°œ ì„ íƒ -> 10 // 3 = 3 (ê¸°ë³¸), ë‚˜ë¨¸ì§€ 1 -> ì²«ë²ˆì§¸ í‚¤ì›Œë“œëŠ” 4ê°œ
            base_count = target_count // num_selected
            remainder = target_count % num_selected
            
            for i, keyword in enumerate(env_features):
                if keyword in marketing_db:
                    # ì´ë²ˆ í‚¤ì›Œë“œì—ì„œ ê°€ì ¸ì˜¬ ê°œìˆ˜ ê³„ì‚°
                    count_to_pick = base_count
                    if i < remainder:  # ë‚˜ë¨¸ì§€ë§Œí¼ ì•ìª½ í‚¤ì›Œë“œì— +1 ë°°ë¶„
                        count_to_pick += 1
                    
                    # í•´ë‹¹ í‚¤ì›Œë“œ ë°ì´í„°ì—ì„œ ëœë¤ ì¶”ì¶œ
                    pool = marketing_db[keyword]
                    # ë°ì´í„°ê°€ ë¶€ì¡±í•˜ë©´ ìˆëŠ” ë§Œí¼ë§Œ, ì¶©ë¶„í•˜ë©´ ê³„ì‚°ëœ ë§Œí¼ ì¶”ì¶œ
                    real_count = min(len(pool), count_to_pick)
                    picked = random.sample(pool, real_count)
                    final_results.extend(picked)
        else:
            # --- [Case B] í‚¤ì›Œë“œ ê°œìˆ˜ê°€ 10ê°œë³´ë‹¤ ë§ì€ ê²½ìš° (ëœë¤ 10ê°œ ì„ ì • í›„ ê° 1ê°œì”©) ---
            # 15ê°œ ì„ íƒí–ˆë‹¤ë©´ ê·¸ ì¤‘ ëœë¤ìœ¼ë¡œ 10ê°œ í‚¤ì›Œë“œë¥¼ ë½‘ìŒ
            chosen_keywords = random.sample(env_features, target_count)
            
            for keyword in chosen_keywords:
                if keyword in marketing_db:
                    # ê° í‚¤ì›Œë“œë‹¹ 1ê°œì”©ë§Œ ì¶”ì¶œ
                    pool = marketing_db[keyword]
                    picked = random.sample(pool, 1)
                    final_results.extend(picked)

    # í˜¹ì‹œ ëª¨ë¥¼ ì¤‘ë³µ ì œê±° (ìˆœì„œ ìœ ì§€)
    unique_final_points = list(dict.fromkeys(final_results))
    
    # 3. ê°€ê²© ë¹„êµ ë¡œì§
    if comp_df is not None and not comp_df.empty:
        try:
            sold_df = comp_df[comp_df['êµ¬ë¶„'].astype(str).str.contains('ë§¤ê°|ì™„ë£Œ|ë§¤ë§¤', na=False)]
            if not sold_df.empty:
                avg_price = sold_df['í‰ë‹¹ê°€'].mean()
                my_price = finance['land_pyeong_price_val']
                diff = my_price - avg_price
                diff_pct = abs(diff / avg_price) * 100
                loc_text = target_dong if target_dong else "ì¸ê·¼"
                if diff < 0:
                    msgs = [
                        f"â˜‘ [ê°€ê²©ìš°ìœ„] {loc_text} í‰ê· (í‰ {avg_price:,.0f}ë§Œ) ëŒ€ë¹„ {diff_pct:.1f}% ì €ë ´í•œ ì €í‰ê°€ ë§¤ë¬¼",
                        f"â˜‘ [ê°€ê²©ë©”ë¦¬íŠ¸] ì£¼ë³€ ì‹œì„¸ë³´ë‹¤ í‰ë‹¹ {abs(diff):,.0f}ë§Œì› ì‹¸ê²Œ ë‚˜ì˜¨ í™•ì‹¤í•œ ê¸‰ë§¤"
                    ]
                    points.append(random.choice(msgs))
                else:
                    msgs = [
                        f"â˜‘ [ëŒ€ì¥ì£¼] {loc_text} ì‹œì„¸ë¥¼ ë¦¬ë”©í•˜ëŠ” ì••ë„ì  ì»¨ë””ì…˜ì˜ ëŒ€ì¥ ê±´ë¬¼",
                        f"â˜‘ [í”„ë¦¬ë¯¸ì—„] í‰ê· ë³´ë‹¤ ë†’ì§€ë§Œ ê·¸ë§Œí•œ ê°€ì¹˜ê°€ ìˆëŠ” Aê¸‰ ì…ì§€"
                    ]
                    points.append(random.choice(msgs))
        except: pass

    # 4. ìˆ˜ìµë¥  ë¡œì§
    yield_val = finance['yield']
    if yield_val >= 4.5:
        msgs = [f"â˜‘ [ì´ˆê³ ìˆ˜ìµ] ì—° {yield_val:.1f}% ìˆ˜ìµë¥ ! ìš”ì¦˜ ê°™ì€ ê³ ê¸ˆë¦¬ì— ë³´ê¸° ë“œë¬¸ ë³´ë¬¼", f"â˜‘ [í˜„ê¸ˆíë¦„] ë¬»ì–´ë‘ë©´ ëˆì´ ë˜ëŠ” ì—° {yield_val:.1f}% ìˆ˜ìµí˜• ë¶€ë™ì‚° ëíŒì™•"]
        points.append(random.choice(msgs))
    elif yield_val >= 3.5:
        msgs = [f"â˜‘ [ê³ ìˆ˜ìµ] ì—° {yield_val:.1f}% ì•ˆì •ì  ìˆ˜ìµ, ì´ì ë‚´ê³ ë„ ë‚¨ëŠ” í›Œë¥­í•œ ìˆ˜ìµì„±", f"â˜‘ [ì•Œì§œë§¤ë¬¼] ìˆ˜ìµë¥ ê³¼ ì§€ê°€ ìƒìŠ¹ ë‘ ë§ˆë¦¬ í† ë¼ ì¡ëŠ” ì—° {yield_val:.1f}% ë§¤ë¬¼"]
        points.append(random.choice(msgs))
    elif yield_val >= 2.5:
        msgs = [f"â˜‘ [ì•ˆì •ì„±] ì—° {yield_val:.1f}%ì˜ ê¾¸ì¤€í•œ ì„ëŒ€ ìˆ˜ìµê³¼ í™•ì‹¤í•œ ì§€ê°€ ìƒìŠ¹ ë™ì‹œ ì¶”êµ¬", f"â˜‘ [ë¦¬ìŠ¤í¬í—·ì§€] ê³µì‹¤ ê±±ì • ì—†ëŠ” ì…ì§€ì—ì„œ ëˆ„ë¦¬ëŠ” ì—° {yield_val:.1f}%ì˜ í¸ì•ˆí•¨"]
        points.append(random.choice(msgs))
    else:
        msgs = [f"â˜‘ [ë¯¸ë˜ê°€ì¹˜] ë‹¹ì¥ ìˆ˜ìµë³´ë‹¤ í–¥í›„ í­ë°œì  ì§€ê°€ ìƒìŠ¹ê³¼ ê°œë°œ í˜¸ì¬ì— ì§‘ì¤‘", f"â˜‘ [ì‹œì„¸ì°¨ìµ] ë³´ìœ í• ìˆ˜ë¡ ë•…ê°’ì´ ì˜¤ë¥´ëŠ” í† ì§€ ê°€ì¹˜ ì¤‘ì‹¬ì˜ íˆ¬ìì²˜"]
        points.append(random.choice(msgs))

    # 5. ë¶€ì¡±í•˜ë©´ ì±„ì›Œë„£ì„ ê¸°ë³¸ ë©˜íŠ¸
    fallback_msgs = [
        "â˜‘ [í¬ì†Œê°€ì¹˜] ë§¤ë¬¼ ì ê¹€ ì‹¬í•œ ì´ ì§€ì—­ ë‚´ ì˜¤ëœë§Œì— ë“±ì¥í•œ ê·€í•œ ë¬¼ê±´", 
        "â˜‘ [ìœ¡ê°í˜•] ì…ì§€, ê°€ê²©, ìƒê¶Œ, ë¯¸ë˜ê°€ì¹˜ 4ë°•ì ëª¨ë‘ ê°–ì¶˜ ë³´ê¸° ë“œë¬¸ íˆ¬ìì²˜",
        "â˜‘ [ë¶ˆíŒ¨ì…ì§€] í•œë²ˆ ë“¤ì–´ì˜¤ë©´ ë‚˜ê°€ì§€ ì•ŠëŠ” ì„ì°¨ì¸ ì„ í˜¸ë„ 1ìœ„ ê²€ì¦ëœ ìë¦¬"
    ]
    random.shuffle(fallback_msgs)
    for msg in fallback_msgs:
        points.append(msg)
        
    # ì¤‘ë³µ ì œê±° í›„ ìƒìœ„ 10ê°œë§Œ ë°˜í™˜ (ìš”ì²­ì‚¬í•­ ì ìš©)
    unique_final_points = list(dict.fromkeys(unique_final_points + points))
    return unique_final_points[:10]

# --- [API ì¡°íšŒ ë° PPT ìƒì„± í•¨ìˆ˜ë“¤] ---
@st.cache_data(show_spinner=False)
def get_pnu_and_coords(address):
    # [ìˆ˜ì •] http -> https (API ì—”ë“œí¬ì¸íŠ¸ ìˆ˜ì •ë¨)
    url = "https://api.vworld.kr/req/search" 
    params = {
        "service": "search",
        "request": "search",
        "version": "2.0",
        "crs": "EPSG:4326",
        "size": "1",
        "page": "1",
        "query": address,
        "type": "address",
        "category": "road" if 'ë¡œ' in address or 'ê¸¸' in address else "parcel",
        "format": "json",
        "errorformat": "json",
        "key": VWORLD_KEY
    }
    try:
        res = requests.get(url, params=params, timeout=5, verify=False)
        if res.json().get('response', {}).get('status') == 'OK': 
            item = res.json()['response']['result']['items'][0]
            pnu = item.get('address', {}).get('pnu') or item.get('id')
            lng = float(item['point']['x'])
            lat = float(item['point']['y'])
            full_address = item.get('address', {}).get('parcel', '') 
            if not full_address: full_address = item.get('address', {}).get('road', '') 
            if not full_address: full_address = address
            return {"pnu": pnu, "lat": lat, "lng": lng, "full_addr": full_address}
        return None
    except: return None

@st.cache_data(show_spinner=False)
def get_zoning_smart(lat, lng):
    url = "http://api.vworld.kr/req/data"
    delta = 0.0005
    min_x, min_y = lng - delta, lat - delta
    max_x, max_y = lng + delta, lat + delta
    params = {"service": "data", "request": "GetFeature", "data": "LT_C_UQ111", "key": VWORLD_KEY, "format": "json", "size": "10", "geomFilter": f"BOX({min_x},{min_y},{max_x},{max_y})", "domain": "localhost"}
    try:
        res = requests.get(url, params=params, timeout=3, verify=False)
        if res.status_code == 200:
            data = res.json()
            features = data.get('response', {}).get('result', {}).get('featureCollection', {}).get('features', [])
            if features:
                zonings = [f['properties']['UNAME'] for f in features]
                return ", ".join(sorted(list(set(zonings))))
    except: pass
    return ""

@st.cache_data(show_spinner=False)
def get_land_price(pnu):
    url = "http://apis.data.go.kr/1611000/NsdiIndvdLandPriceService/getIndvdLandPriceAttr"
    current_year = datetime.datetime.now().year
    years_to_check = range(current_year, current_year - 7, -1) 
    for year in years_to_check:
        params = {"serviceKey": USER_KEY, "pnu": pnu, "format": "xml", "numOfRows": "1", "pageNo": "1", "stdrYear": str(year)}
        try:
            res = requests.get(url, params=params, timeout=4)
            if res.status_code == 200:
                root = ET.fromstring(res.content)
                if root.findtext('.//resultCode') == '00':
                    price_node = root.find('.//indvdLandPrice')
                    if price_node is not None and price_node.text: return int(price_node.text)
        except: continue
        time.sleep(0.05)
    return 0

@st.cache_data(show_spinner=False)
def get_building_info_smart(pnu):
    base_url = "https://apis.data.go.kr/1613000/BldRgstHubService/getBrTitleInfo"
    sigungu = pnu[0:5]; bjdong = pnu[5:10]; bun = pnu[11:15]; ji = pnu[15:19]
    plat_code = '1' if pnu[10] == '2' else '0'
    params = {"serviceKey": USER_KEY, "sigunguCd": sigungu, "bjdongCd": bjdong, "platGbCd": plat_code, "bun": bun, "ji": ji, "numOfRows": "1", "pageNo": "1"}
    try:
        res = requests.get(base_url, params=params, timeout=5, verify=False)
        if res.status_code == 200: return parse_xml_response(res.content)
        return {"error": f"ì„œë²„ ìƒíƒœ: {res.status_code}"}
    except Exception as e: return {"error": str(e)}

def parse_xml_response(content):
    try:
        root = ET.fromstring(content)
        item = root.find('.//item')
        if item is None: return None
          
        indr_mech = int(item.findtext('indrMechUtcnt', '0') or 0)
        indr_auto = int(item.findtext('indrAutoUtcnt', '0') or 0)
        total_indoor = indr_mech + indr_auto
        oudr_mech = int(item.findtext('oudrMechUtcnt', '0') or 0)
        oudr_auto = int(item.findtext('oudrAutoUtcnt', '0') or 0)
        total_outdoor = oudr_mech + oudr_auto
        total_parking = total_indoor + total_outdoor
        parking_str = f"{total_parking}ëŒ€(ì˜¥ë‚´{total_indoor}/ì˜¥ì™¸{total_outdoor})"
        ride_elvt = int(item.findtext('rideUseElvtCnt', '0') or 0)
        emgen_elvt = int(item.findtext('emgenUseElvtCnt', '0') or 0)
        total_elvt = ride_elvt + emgen_elvt
        elvt_str = f"{total_elvt}ëŒ€"
          
        return {
            "bldNm": item.findtext('bldNm', '-'),
            "mainPurpsCdNm": item.findtext('mainPurpsCdNm', 'ì •ë³´ì—†ìŒ'),
            "strctCdNm": item.findtext('strctCdNm', 'ì •ë³´ì—†ìŒ'),
            "platArea": float(item.findtext('platArea', '0') or 0),
            "totArea": float(item.findtext('totArea', '0') or 0),
            "archArea_val": float(item.findtext('archArea', '0') or 0),
            "groundArea": float(item.findtext('vlRatEstmTotArea', '0') or 0),
            "ugrndFlrCnt": int(item.findtext('ugrndFlrCnt', '0') or 0),
            "grndFlrCnt": int(item.findtext('grndFlrCnt', '0') or 0),
            "useAprDay": format_date_dot(item.findtext('useAprDay', '')),
            "bcRat": float(item.findtext('bcRat', '0') or 0),
            "vlRat": float(item.findtext('vlRat', '0') or 0),
            "rideUseElvtCnt": elvt_str,
            "parking": parking_str
        }
    except Exception as e: return {"error": str(e)}

@st.cache_data(show_spinner=False)
def get_floor_info_smart(pnu):
    base_url = "http://apis.data.go.kr/1613000/BldRgstHubService/getBrFlrOulnInfo"
    sigungu = pnu[0:5]; bjdong = pnu[5:10]; bun = pnu[11:15]; ji = pnu[15:19]
    plat_code = '1' if pnu[10] == '2' else '0'
    params = {"serviceKey": USER_KEY, "sigunguCd": sigungu, "bjdongCd": bjdong, "platGbCd": plat_code, "bun": bun, "ji": ji, "numOfRows": "50", "pageNo": "1"}
      
    floor_data = []
    try:
        res = requests.get(base_url, params=params, timeout=5)
        if res.status_code == 200:
            root = ET.fromstring(res.content)
            items = root.findall('.//item')
            floor_map = {} 
            for item in items:
                try:
                    flr_no = int(item.findtext('flrNo'))
                    flr_gb = item.findtext('flrGbCdNm')
                    area = float(item.findtext('area', '0') or 0)
                    if 'ì§€í•˜' in flr_gb: idx = -flr_no
                    else: idx = flr_no
                    if idx in floor_map: floor_map[idx] += area
                    else: floor_map[idx] = area
                except: continue
            sorted_floors = sorted(floor_map.keys()) 
            for idx in sorted_floors:
                area_m2 = floor_map[idx]
                area_py = area_m2 * 0.3025
                if idx < 0: flr_name = f"B{abs(idx)}"
                else: flr_name = f"{idx}ì¸µ"
                floor_data.append({
                    "ì¸µìˆ˜": flr_name, "ì…ì£¼ì—…ì²´": "", "ì¸µë³„ë©´ì ": f"{area_py:.2f}",
                    "ë³´ì¦ê¸ˆ": None, "ì„ëŒ€ë£Œ": None, "ê´€ë¦¬ë¹„": None, "ì„ëŒ€ì°¨ê¸°ê°„": "", "ë¹„ê³ ": ""
                })
            return floor_data
    except Exception as e: print(e)
    return []

@st.cache_data(show_spinner=False)
def get_cadastral_map_image(lat, lng):
    delta = 0.0015 
    minx, miny = lng - delta, lat - delta
    maxx, maxy = lng + delta, lat + delta
    bbox = f"{minx},{miny},{maxx},{maxy}"
    layer = "LP_PA_CBND_BUBUN"
    url = f"https://api.vworld.kr/req/wms?SERVICE=WMS&REQUEST=GetMap&VERSION=1.3.0&LAYERS={layer}&STYLES={layer}&CRS=EPSG:4326&BBOX={bbox}&WIDTH=400&HEIGHT=300&FORMAT=image/png&TRANSPARENT=FALSE&BGCOLOR=0xFFFFFF&EXCEPTIONS=text/xml&KEY={VWORLD_KEY}"
    headers = {"User-Agent": "Mozilla/5.0", "Referer": "http://localhost:8501"}
    try:
        res = requests.get(url, headers=headers, timeout=5, verify=False)
        if res.status_code == 200 and 'image' in res.headers.get('Content-Type', ''): return BytesIO(res.content)
    except: pass
    return None

@st.cache_data(show_spinner=False)
def get_static_map_image(lat, lng):
    url = f"http://api.vworld.kr/req/image?service=image&request=getmap&key={VWORLD_KEY}&center={lng},{lat}&crs=EPSG:4326&zoom=17&size=600,400&format=png&basemap=GRAPHIC"
    try:
        res = requests.get(url, timeout=3)
        if res.status_code == 200 and 'image' in res.headers.get('Content-Type', ''): return BytesIO(res.content)
    except: pass
    return None

# [PPT ìƒì„± í•¨ìˆ˜ ìˆ˜ì •ë²„ì „]
def create_pptx(info, full_addr, finance, zoning, lat, lng, land_price, selling_points, images_dict, rent_roll_df=None, template_binary=None, template_1page_binary=None):
    deep_blue = RGBColor(0, 51, 153) 
    deep_red = RGBColor(204, 0, 0)
    bright_red = RGBColor(255, 0, 0)
    black = RGBColor(0, 0, 0)
    gray_border = RGBColor(128, 128, 128)
    dark_gray_border = RGBColor(80, 80, 80)

    bld_name = info.get('bldNm')
    if not bld_name or bld_name == '-':
        dong = full_addr.split(' ')[2] if len(full_addr.split(' ')) > 2 else ""
        bld_name = f"{dong} ë¹Œë”©" if dong else "ì‚¬ì˜¥ìš© ë¹Œë”©"
          
    lp_py_val = (land_price / 10000) / 0.3025 if land_price > 0 else 0
    lp_str_final = f"{lp_py_val:,.0f}ë§Œì›/í‰"
      
    total_lp_val = land_price * info['platArea'] if land_price and info['platArea'] else 0
    total_lp_num = int(total_lp_val / 100000000) if total_lp_val > 0 else 0
    total_lp_str_final = f"í•© {total_lp_num:,}ì–µ" if total_lp_num > 0 else "-"

    ai_points_str = "\n".join(selling_points[:5]) if selling_points else "ë¶„ì„ëœ íŠ¹ì§•ì´ ì—†ìŠµë‹ˆë‹¤."

    # í‰ ë‹¨ìœ„ ë³€í™˜ ë¡œì§
    plat_m2 = f"{info['platArea']:,}" if info['platArea'] else "-"
    plat_py = f"{info['platArea'] * 0.3025:,.1f}" if info['platArea'] else "-"
    tot_m2 = f"{info['totArea']:,}" if info['totArea'] else "-"
    tot_py = f"{info['totArea'] * 0.3025:,.1f}" if info['totArea'] else "-"
    arch_val = info.get('archArea_val', 0)
    arch_m2 = f"{arch_val:,.1f}"
    arch_py = f"{arch_val * 0.3025:,.1f}"
    ground_val = info.get('groundArea', 0)
    ground_m2 = f"{ground_val:,}"
    ground_py = f"{ground_val * 0.3025:,.1f}"
    use_date = info.get('useAprDay', '-')
    market_price_py_val = finance.get('land_pyeong_price_val', 0)
    market_price_str = f"í‰ {market_price_py_val:,.0f}ë§Œì›"

    ctx_vals = {'plat_m2': plat_m2, 'plat_py': plat_py, 'tot_m2': tot_m2, 'tot_py': tot_py, 'arch_m2': arch_m2, 'arch_py': arch_py, 'ground_m2': ground_m2, 'ground_py': ground_py, 'use_date': use_date}

    data_map = {
        "{{ë¹Œë”©ì´ë¦„}}": bld_name, "{{ì†Œì¬ì§€}}": full_addr, "{{ìš©ë„ì§€ì—­}}": zoning,
        "{{AIë¬¼ê±´ë¶„ì„ë‚´ìš© 4ê°€ì§€ }}": ai_points_str, "{{ê³µì‹œì§€ê°€}}": lp_str_final, "{{ê³µì‹œì§€ê°€ ì´ì•¡}}": total_lp_str_final,
        "{{êµí†µí¸ì˜}}": info.get('traffic', '-'), "{{ë„ë¡œìƒí™©}}": info.get('road', '-'), "{{ì¤€ê³µë…„ë„}}": use_date,
        "{{ê±´ë¬¼ê·œëª¨}}": info.get('scale_str', '-'), "{{ê±´íìœ¨}}": info.get('bcRat_str', '-'), 
        "{{ìš©ì ë¥ }}": info.get('vlRat_str', '-'), "{{ìŠ¹ê°•ê¸°}}": info.get('rideUseElvtCnt', '-'), 
        "{{ì£¼ì°¨ëŒ€ìˆ˜}}": info.get('parking', '-'), "{{ê±´ë¬¼ì£¼êµ¬ì¡°}}": info.get('strctCdNm', '-'),
        "{{ê±´ë¬¼ìš©ë„}}": info.get('mainPurpsCdNm', '-'),
        "{{ë³´ì¦ê¸ˆ}}": f"{finance['deposit']:,} ë§Œì›" if finance['deposit'] else "-",
        "{{ì›”ì„ëŒ€ë£Œ}}": f"{finance['rent']:,} ë§Œì›" if finance['rent'] else "-",
        "{{ê´€ë¦¬ë¹„}}": f"{finance['maintenance']:,} ë§Œì›" if finance['maintenance'] else "-",
        "{{ìˆ˜ìµë¥ }}": f"ë…„ {finance['yield']:.1f}%" if finance['yield'] else "-",
        "{{ìœµìê¸ˆ}}": f"{finance['loan']:,} ì–µì›" if finance['loan'] else "-",
        "{{ë§¤ë§¤ê¸ˆì•¡}}": f"{finance['price']:,} ì–µì›" if finance['price'] else "-",
        "{{ëŒ€ì§€í‰ë‹¨ê°€}}": market_price_str,
        "{{ê±´ë¬¼ë¯¸ë˜ê°€ì¹˜ í™œìš©ë„}}": "ì‚¬ì˜¥ ë° ìˆ˜ìµìš© ë¦¬ëª¨ë¸ë§ ì¶”ì²œ",
        "{{ìœ„ì¹˜ë„}}": "", "{{ì§€ì ë„}}": "", "{{ê±´ì¶•ë¬¼ëŒ€ì¥}}": "", "{{ê±´ë¬¼ì‚¬ì§„}}": ""
    }

    # --- [ë‚´ë¶€ í•¨ìˆ˜: í…ìŠ¤íŠ¸ ì¹˜í™˜ ë¡œì§] (9ì¥/1ì¥ í…œí”Œë¦¿ ê³µí†µ ì‚¬ìš©) ---
    def replace_text_in_frame(text_frame, mapper, ctx):
        for p in text_frame.paragraphs:
            p_text = p.text
            # [ì¶”ê°€] 1ì¥ í…œí”Œë¦¿ìš© ê°•ë ¥ ì¹˜í™˜ ë¡œì§ (ìŠ¤íƒ€ì¼ ì ìš©)
            if "{{ë§¤ë§¤ê¸ˆì•¡}}" in p_text:
                val_str = str(mapper["{{ë§¤ë§¤ê¸ˆì•¡}}"])
                p.text = val_str
                for r in p.runs: r.font.size = Pt(16); r.font.bold = True; r.font.color.rgb = deep_red
                return
            if "{{ìˆ˜ìµë¥ }}" in p_text:
                val_str = str(mapper["{{ìˆ˜ìµë¥ }}"])
                p.text = val_str
                for r in p.runs: r.font.size = Pt(12); r.font.bold = True; r.font.color.rgb = deep_red
                return
            if "{{ê±´ë¬¼ê·œëª¨}}" in p_text:
                val_str = str(mapper["{{ê±´ë¬¼ê·œëª¨}}"])
                p.text = val_str
                for r in p.runs: r.font.size = Pt(10); r.font.bold = True; r.font.color.rgb = black
                return
            if "{{ì£¼ì°¨ëŒ€ìˆ˜}}" in p_text:
                val_str = str(mapper["{{ì£¼ì°¨ëŒ€ìˆ˜}}"])
                p.text = val_str
                for r in p.runs: r.font.size = Pt(10); r.font.bold = True; r.font.color.rgb = black
                return

            if "{{AIë¬¼ê±´ë¶„ì„ë‚´ìš© 4ê°€ì§€ }}" in p_text:
                p.text = str(mapper["{{AIë¬¼ê±´ë¶„ì„ë‚´ìš© 4ê°€ì§€ }}"])
                for r in p.runs: r.font.size = Pt(10); r.font.name = "ë§‘ì€ ê³ ë”•"
                return
            if "{{ê³µì‹œì§€ê°€}}" in p_text:
                p.text = str(mapper["{{ê³µì‹œì§€ê°€}}"])
                for r in p.runs: r.font.color.rgb = black; r.font.bold = True; r.font.size = Pt(10)
                return
            if "{{ê³µì‹œì§€ê°€ ì´ì•¡}}" in p_text:
                p.text = str(mapper["{{ê³µì‹œì§€ê°€ ì´ì•¡}}"])
                for r in p.runs: r.font.color.rgb = deep_red; r.font.bold = True; r.font.size = Pt(12)
                return
            financial_keys = ["{{ë³´ì¦ê¸ˆ}}", "{{ì›”ì„ëŒ€ë£Œ}}", "{{ê´€ë¦¬ë¹„}}", "{{ìœµìê¸ˆ}}"]
            found_fin_key = None
            for k in financial_keys:
                if k in p_text: found_fin_key = k; break
            if found_fin_key:
                val_str = str(mapper[found_fin_key])
                if " " in val_str:
                    num_part, unit_part = val_str.split(' ', 1)
                    p.text = ""; run_num = p.add_run(); run_num.text = num_part + " "; run_num.font.size = Pt(12); run_num.font.bold = True; run_num.font.color.rgb = black
                    run_unit = p.add_run(); run_unit.text = unit_part; run_unit.font.size = Pt(10); run_unit.font.bold = True; run_unit.font.color.rgb = black
                else:
                    p.text = val_str
                    for r in p.runs: r.font.size = Pt(12); r.font.bold = True; r.font.color.rgb = black
                return 
            
            if "{{ëŒ€ì§€ë©´ì }}" in p_text:
                if "í‰" in p_text: 
                    p.text = p_text.replace("{{ëŒ€ì§€ë©´ì }}", ctx['plat_py'])
                    color_to_use = RGBColor(6, 6, 236); size_to_use = Pt(13)
                else: 
                    p.text = p_text.replace("{{ëŒ€ì§€ë©´ì }}", ctx['plat_m2'])
                    color_to_use = black; size_to_use = Pt(10)
                
                for r in p.runs: 
                    r.font.size = size_to_use; r.font.bold = True; r.font.color.rgb = color_to_use

            elif "{{ì—°ë©´ì }}" in p_text:
                if "í‰" in p_text: 
                    p.text = p_text.replace("{{ì—°ë©´ì }}", ctx['tot_py'])
                    color_to_use = RGBColor(6, 6, 236); size_to_use = Pt(13)
                else: 
                    p.text = p_text.replace("{{ì—°ë©´ì }}", ctx['tot_m2'])
                    color_to_use = black; size_to_use = Pt(10)

                for r in p.runs: 
                    r.font.size = size_to_use; r.font.bold = True; r.font.color.rgb = color_to_use

            elif "{{ê±´ì¶•ë©´ì }}" in p_text:
                if "í‰" in p_text: p.text = p_text.replace("{{ê±´ì¶•ë©´ì }}", ctx['arch_py'])
                else: p.text = p_text.replace("{{ê±´ì¶•ë©´ì }}", ctx['arch_m2'])
                for r in p.runs: r.font.size = Pt(10)
            elif "{{ì§€ìƒë©´ì }}" in p_text:
                if "í‰" in p_text: p.text = p_text.replace("{{ì§€ìƒë©´ì }}", ctx['ground_py'])
                else: p.text = p_text.replace("{{ì§€ìƒë©´ì }}", ctx['ground_m2'])
                for r in p.runs: r.font.size = Pt(10)
            elif "{{ì¤€ê³µë…„ë„}}" in p_text:
                new_text = p_text.replace("{{ì¤€ê³µë…„ë„}}", ctx['use_date'])
                if ctx['use_date'] + "ã¡" in new_text: new_text = new_text.replace("ã¡", "")
                p.text = new_text
                for r in p.runs: r.font.size = Pt(10)
            else:
                found_key = None
                for k in mapper.keys():
                    if k in p_text: found_key = k; break
                if found_key:
                    val = str(mapper[found_key])
                    p.text = p_text.replace(found_key, val)
                    for r in p.runs:
                        r.font.size = Pt(10)
                        if found_key == "{{ë¹Œë”©ì´ë¦„}}": r.font.size = Pt(25); r.font.bold = True
                        elif found_key == "{{ëŒ€ì§€í‰ë‹¨ê°€}}": r.font.size = Pt(10); r.font.color.rgb = deep_blue; r.font.bold = True

    def replace_text_in_shape(shape, mapper, ctx):
        if shape.shape_type == MSO_SHAPE_TYPE.GROUP:
            for child in shape.shapes: replace_text_in_shape(child, mapper, ctx)
            return
        if shape.has_table:
            for row in shape.table.rows:
                for cell in row.cells:
                    if cell.text_frame: replace_text_in_frame(cell.text_frame, mapper, ctx)
            return
        if shape.has_text_frame: replace_text_in_frame(shape.text_frame, mapper, ctx)


    # ==========================================
    # [Case 1] 9ì¥ì§œë¦¬ í…œí”Œë¦¿ ì‚¬ìš© ì‹œ
    # ==========================================
    if template_binary:
        prs = Presentation(template_binary)
        
        for slide in prs.slides:
            for shape in slide.shapes: replace_text_in_shape(shape, data_map, ctx_vals)

        # 9ì¥ í…œí”Œë¦¿ ì „ìš© ì´ë¯¸ì§€ ì‚½ì… ë¡œì§
        img_insert_map = {
            1: ('u1', Cm(1.35), Cm(2.35), Cm(24.84), Cm(15.74)),  
            2: ('u2', Cm(1.35), Cm(2.35), Cm(13.61), Cm(10.98)),   
            4: ('u3', Cm(1.35), Cm(2.35), Cm(20.4), Cm(15.74)),   
            5: ('u4', Cm(1.35), Cm(2.35), Cm(23.21), Cm(15.74))   
        }
        for s_idx, (key, l, t, w, h) in img_insert_map.items():
            if s_idx < len(prs.slides) and key in images_dict and images_dict[key]:
                img_file = images_dict[key]; img_file.seek(0)
                pic = prs.slides[s_idx].shapes.add_picture(img_file, l, t, width=w, height=h)
                pic.line.visible = True; pic.line.width = Pt(1.5); pic.line.color.rgb = dark_gray_border if s_idx == 2 else gray_border

        # 9ì¥ í…œí”Œë¦¿ Slide 7 ì¶”ê°€ ì´ë¯¸ì§€
        if 6 < len(prs.slides):
            slide7 = prs.slides[6]
            u5_keys = ['u5_1', 'u5_2', 'u5_3', 'u5_4']
            positions = [
                (Cm(1.35), Cm(2.35)), (Cm(13.83), Cm(2.35)), 
                (Cm(1.35), Cm(10.55)), (Cm(13.83), Cm(10.55))
            ]
            w_s7, h_s7 = Cm(12.16), Cm(7.74) 
            for idx, u_key in enumerate(u5_keys):
                if u_key in images_dict and images_dict[u_key]:
                    f = images_dict[u_key]; f.seek(0)
                    pic = slide7.shapes.add_picture(f, positions[idx][0], positions[idx][1], width=w_s7, height=h_s7)
                    pic.line.visible = True; pic.line.width = Pt(1.0); pic.line.color.rgb = gray_border
        
        # ë ŒíŠ¸ë¡¤ ì‚½ì… (Slide 4)
        if rent_roll_df is not None and not rent_roll_df.empty:
            try:
                slide4 = prs.slides[3]
                target_table = None
                for shape in slide4.shapes:
                    if shape.has_table: target_table = shape.table; break
                
                if target_table:
                    row_idx = 1
                    total_dep = 0; total_rent = 0; total_maint = 0
                    
                    for _, row_data in rent_roll_df.iterrows():
                        if row_idx >= len(target_table.rows) - 1: break 
                        
                        def set_cell_text(r, c, text):
                            try:
                                cell = target_table.cell(r, c)
                                if text is None: text = ""
                                if isinstance(text, (int, float)): text = f"{int(text):,}"
                                cell.text = str(text)
                                for p in cell.text_frame.paragraphs:
                                    p.font.size = Pt(10); p.font.name = "ë§‘ì€ ê³ ë”•"; p.alignment = PP_ALIGN.CENTER; p.font.color.rgb = RGBColor(0,0,0)
                            except: pass

                        set_cell_text(row_idx, 1, row_data.get('ì¸µìˆ˜', ''))
                        set_cell_text(row_idx, 2, row_data.get('ì…ì£¼ì—…ì²´', ''))
                        set_cell_text(row_idx, 3, row_data.get('ì¸µë³„ë©´ì ', ''))
                        set_cell_text(row_idx, 4, row_data.get('ë³´ì¦ê¸ˆ', 0))
                        set_cell_text(row_idx, 5, row_data.get('ì„ëŒ€ë£Œ', 0))
                        set_cell_text(row_idx, 6, row_data.get('ê´€ë¦¬ë¹„', 0))
                        set_cell_text(row_idx, 7, row_data.get('ì„ëŒ€ì°¨ê¸°ê°„', ''))
                        if len(target_table.columns) > 8:
                            set_cell_text(row_idx, 8, row_data.get('ë¹„ê³ ', ''))

                        def parse_money(val):
                            try: return int(str(val).replace(',', ''))
                            except: return 0
                        total_dep += parse_money(row_data.get('ë³´ì¦ê¸ˆ', 0))
                        total_rent += parse_money(row_data.get('ì„ëŒ€ë£Œ', 0))
                        total_maint += parse_money(row_data.get('ê´€ë¦¬ë¹„', 0))
                        row_idx += 1
                    
                    last_row_idx = len(target_table.rows) - 1
                    if last_row_idx > 0:
                         def set_sum_cell(c, val):
                            try:
                                cell = target_table.cell(last_row_idx, c)
                                cell.text = f"{val:,}"
                                for p in cell.text_frame.paragraphs:
                                    p.font.bold = True; p.font.size = Pt(11); p.alignment = PP_ALIGN.CENTER
                            except: pass
                         set_sum_cell(4, total_dep)
                         set_sum_cell(5, total_rent)
                         set_sum_cell(6, total_maint)
            except Exception as e: print(f"PPT Slide 4 Error: {e}")

        output = BytesIO()
        prs.save(output)
        return output.getvalue()

    # ==========================================
    # [Case 2] 1ì¥ì§œë¦¬ ìƒ˜í”Œ í…œí”Œë¦¿ ì‚¬ìš© ì‹œ (NEW)
    # ==========================================
    elif template_1page_binary:
        prs = Presentation(template_1page_binary)
        
        # 1. ì´ë¯¸ì§€ ë°ì´í„° ì¤€ë¹„ (ì—…ë¡œë“œ ì—†ìœ¼ë©´ API í˜¸ì¶œ)
        img_map_data = {}
        
        # ê±´ë¬¼ì‚¬ì§„ (u2)
        if images_dict.get('u2'): 
            img_map_data["{{ê±´ë¬¼ì‚¬ì§„}}"] = images_dict['u2']
        
        # ìœ„ì¹˜ë„ (u1 -> ì—†ìœ¼ë©´ API)
        if images_dict.get('u1'): 
            img_map_data["{{ìœ„ì¹˜ë„}}"] = images_dict['u1']
        else:
            static_map = get_static_map_image(lat, lng)
            if static_map: img_map_data["{{ìœ„ì¹˜ë„}}"] = static_map

        # ì§€ì ë„ (u3 -> ì—†ìœ¼ë©´ API)
        if images_dict.get('u3'): 
            img_map_data["{{ì§€ì ë„}}"] = images_dict['u3']
        else:
            cad_map = get_cadastral_map_image(lat, lng)
            if cad_map: img_map_data["{{ì§€ì ë„}}"] = cad_map

        # [ìš”ì²­í•˜ì‹  ê³ ì • í¬ê¸° ì„¤ì •] (ë‹¨ìœ„: Cm)
        # ê±´ë¬¼ì‚¬ì§„: 11.11 x 8.78 (ê°€ë¡œxì„¸ë¡œì¸ì§€ ì„¸ë¡œxê°€ë¡œì¸ì§€ ëª…í™•í•˜ì§€ ì•Šì•„ ë³´í†µ ê°€ë¡œxì„¸ë¡œì´ë‚˜, ìš”ì²­ ìˆœì„œëŒ€ë¡œ Width, Heightë¡œ ì ìš©)
        # ìš”ì²­: "ë†’ì´11.11 ë„ˆë¹„ 8.78" -> h=11.11, w=8.78
        img_specs = {
            "{{ê±´ë¬¼ì‚¬ì§„}}": {'w': 8.78, 'h': 11.11},
            "{{ìœ„ì¹˜ë„}}":   {'w': 8.78, 'h': 9.17},
            "{{ì§€ì ë„}}":   {'w': 9.03, 'h': 5.9}
        }

        # 2. ìŠ¬ë¼ì´ë“œ ìˆœíšŒí•˜ë©° ì´ë¯¸ì§€ í”Œë ˆì´ìŠ¤í™€ë” ì°¾ê¸° (í…ìŠ¤íŠ¸ ì¹˜í™˜ë³´ë‹¤ ë¨¼ì € ì‹¤í–‰)
        for slide in prs.slides:
            # ë„í˜•ì„ ì‚­ì œí•´ì•¼ í•˜ë¯€ë¡œ ë¦¬ìŠ¤íŠ¸ë¡œ ë³µì‚¬í•´ì„œ ìˆœíšŒ
            for shape in list(slide.shapes):
                if shape.has_text_frame:
                    txt = shape.text_frame.text.strip()
                    if txt in img_map_data and img_map_data[txt]:
                        # ì¢Œí‘œ ì •ë³´ ê°€ì ¸ì˜¤ê¸° (ê¸°ì¡´ ë„í˜•ì˜ ìœ„ì¹˜ ì‚¬ìš©)
                        l, t = shape.left, shape.top
                        
                        # [ìˆ˜ì •] í¬ê¸°ëŠ” ìš”ì²­í•˜ì‹  ê³ ì • í¬ê¸° ì‚¬ìš©
                        if txt in img_specs:
                            w = Cm(img_specs[txt]['w'])
                            h = Cm(img_specs[txt]['h'])
                        else:
                            w, h = shape.width, shape.height # fallback

                        # ì´ë¯¸ì§€ ì‚½ì…
                        img_stream = img_map_data[txt]
                        img_stream.seek(0)
                        pic = slide.shapes.add_picture(img_stream, l, t, width=w, height=h)
                        
                        # ì›ë³¸ í”Œë ˆì´ìŠ¤í™€ë” ë„í˜• ì‚­ì œ
                        sp = shape._element
                        sp.getparent().remove(sp)

        # 3. ë‚˜ë¨¸ì§€ í…ìŠ¤íŠ¸ ì¹˜í™˜ ì‹¤í–‰
        for slide in prs.slides:
            for shape in slide.shapes:
                replace_text_in_shape(shape, data_map, ctx_vals)
        
        output = BytesIO()
        prs.save(output)
        return output.getvalue()
      
    # ==========================================
    # [Case 3] í…œí”Œë¦¿ ì—†ìŒ (ì½”ë“œ ìƒì„± 1ì¥ ë³´ê³ ì„œ)
    # ==========================================
    else:
        prs = Presentation(); prs.slide_width = Cm(21.0); prs.slide_height = Cm(29.7)
        slide = prs.slides.add_slide(prs.slide_layouts[6])
          
        title_box = slide.shapes.add_shape(MSO_SHAPE.RECTANGLE, Cm(1.0), Cm(1.0), Cm(19.0), Cm(2.0))
        title_box.fill.background(); title_box.line.color.rgb = RGBColor(200, 200, 200); title_box.line.width = Pt(1)
        tf = title_box.text_frame; tf.text = bld_name; p = tf.paragraphs[0]; p.font.size = Pt(28); p.font.bold = True; p.font.name = "ë§‘ì€ ê³ ë”•"; p.alignment = PP_ALIGN.CENTER; p.font.color.rgb = RGBColor(0, 0, 0) 

        left_x = Cm(1.0); right_x = Cm(10.8); col_w = Cm(9.2)

        lbl_img = slide.shapes.add_textbox(left_x, Cm(2.9), col_w, Cm(0.6)); lbl_img.text_frame.text = "ê±´ë¬¼ì‚¬ì§„"; lbl_img.text_frame.paragraphs[0].font.bold=True
        main_img = images_dict.get('u2')
        if main_img:
            main_img.seek(0)
            pic = slide.shapes.add_picture(main_img, left_x, Cm(3.5), width=col_w, height=Cm(12.0))
            pic.line.visible = True; pic.line.color.rgb = RGBColor(200, 200, 200); pic.line.width = Pt(1)
        else:
            rect = slide.shapes.add_shape(MSO_SHAPE.RECTANGLE, left_x, Cm(3.5), col_w, Cm(12.0)); rect.fill.background(); rect.line.color.rgb = RGBColor(200, 200, 200)

        lbl_map = slide.shapes.add_textbox(left_x, Cm(15.9), col_w, Cm(0.6)); lbl_map.text_frame.text = "ìœ„ì¹˜ë„"; lbl_map.text_frame.paragraphs[0].font.bold=True
        loc_img = images_dict.get('u1')
        if loc_img:
            loc_img.seek(0)
            pic_map = slide.shapes.add_picture(loc_img, left_x, Cm(16.5), width=col_w, height=Cm(12.0))
            pic_map.line.visible = True; pic_map.line.color.rgb = RGBColor(200, 200, 200); pic_map.line.width = Pt(1)
        else:
            map_img = get_static_map_image(lat, lng)
            if map_img: 
                pic_map = slide.shapes.add_picture(map_img, left_x, Cm(16.5), width=col_w, height=Cm(12.0))
                pic_map.line.visible = True; pic_map.line.color.rgb = RGBColor(200, 200, 200)

        lbl_tbl = slide.shapes.add_textbox(right_x, Cm(2.9), col_w, Cm(0.6)); lbl_tbl.text_frame.text = "ê±´ë¬¼ê°œìš”"; lbl_tbl.text_frame.paragraphs[0].font.bold=True
          
        # [ë³€í™˜ëœ í‰ìˆ˜ ì‚¬ìš©]
        plat_disp = f"{info['platArea']*0.3025:,.1f}í‰" if info['platArea'] else "-"
        tot_disp = f"{info['totArea']*0.3025:,.1f}í‰" if info['totArea'] else "-"
        ground_disp = f"{info.get('groundArea',0)*0.3025:,.1f}í‰" if info.get('groundArea') else "-"
        arch_disp = f"{info.get('archArea_val',0)*0.3025:,.1f}í‰" if info.get('archArea_val') else "-"

        data = [
             ["ì†Œì¬ì§€", full_addr, "", ""], 
             ["ë„ë¡œ", info.get('road', '-'), "êµí†µ", info.get('traffic', '-')],
             ["ëŒ€ì§€", plat_disp, "ìš©ë„", zoning], 
             ["ì—°ë©´ì ", tot_disp, "ê³µì‹œì§€ê°€", lp_str_final],
             ["ì§€ìƒ", ground_disp, "ì¤€ê³µ", use_date],
             ["ê±´ì¶•", arch_disp, "ê·œëª¨", info.get('scale_str', '-')],
             ["ê±´íìœ¨", info.get('bcRat_str', '-'), "ìŠ¹ê°•ê¸°", info.get('rideUseElvtCnt','-')],
             ["ì£¼ì°¨", info.get('parking', '-'), "ìš©ì ë¥ ", info.get('vlRat_str', '-')],
             ["ì£¼êµ¬ì¡°", info.get('strctCdNm','-'), "ì£¼ìš©ë„", info.get('mainPurpsCdNm','-')],
             ["ë³´ì¦ê¸ˆ", f"{finance['deposit']:,.0f}ë§Œ", "ìœµì", f"{finance['loan']:,}ì–µ"],
             ["ì„ëŒ€ë£Œ", f"{finance['rent']:,}ë§Œ", "ìˆ˜ìµë¥ ", f"{finance['yield']:.1f}%"],
             ["ê´€ë¦¬ë¹„", f"{finance['maintenance']:,}ë§Œ", "ë§¤ë§¤ê¸ˆì•¡", f"{finance['price']:,}ì–µ"]
        ]
          
        table = slide.shapes.add_table(12, 4, right_x, Cm(3.5), col_w, Cm(10.5)).table
        table.columns[0].width = Cm(2.3); table.columns[1].width = Cm(2.3); table.columns[2].width = Cm(2.3); table.columns[3].width = Cm(2.3)

        for r in range(12):
            for c in range(4):
                cell = table.cell(r, c); cell.text = str(data[r][c]); cell.vertical_anchor = MSO_ANCHOR.MIDDLE
                p = cell.text_frame.paragraphs[0]; p.alignment = PP_ALIGN.CENTER; p.font.size = Pt(8); p.font.name = "ë§‘ì€ ê³ ë”•"
                cell.fill.solid(); cell.fill.fore_color.rgb = RGBColor(240, 248, 255) if c % 2 == 0 else RGBColor(255, 255, 255)
                  
                # ê¸°ë³¸ì ìœ¼ë¡œ ê²€ì •ìƒ‰ ì ìš©
                p.font.color.rgb = black
                  
                if r == 0 or (r==11 and c>=2): p.font.bold = True
                  
                # [ìˆ˜ì •] 1ì¥ì§œë¦¬ PPT: ì†Œì¬ì§€, ëŒ€ì§€, ì—°ë©´ì ì€ 'ê²€ì •ìƒ‰'ìœ¼ë¡œ ë³€ê²½ (ê¸°ì¡´ ë¹¨ê°„ìƒ‰ ì œê±°)
                if r == 0: # ì†Œì¬ì§€
                    p.font.color.rgb = black
                    p.font.bold = True
                  
                if (r == 2 and c <= 1) or (r == 3 and c <= 1): # ëŒ€ì§€, ì—°ë©´ì 
                      p.font.color.rgb = black
                      p.font.bold = True
                  
                # [ìœ ì§€] ë§¤ë§¤ê¸ˆì•¡ì€ ë¹¨ê°„ìƒ‰ ìœ ì§€
                if r == 11 and c >= 2:
                      p.font.color.rgb = bright_red
                      p.font.bold = True
          
        table.cell(0, 1).merge(table.cell(0, 3))

        # ì§€ì ë„
        slide.shapes.add_textbox(right_x, Cm(14.4), col_w, Cm(0.6)).text_frame.text = "ì§€ì ë„"
        cad_img = images_dict.get('u3') or get_cadastral_map_image(lat, lng)
        if cad_img: slide.shapes.add_picture(cad_img, right_x, Cm(15.0), width=col_w, height=Cm(10.2))

        # íˆ¬ìí¬ì¸íŠ¸
        slide.shapes.add_textbox(right_x, Cm(25.6), col_w, Cm(0.6)).text_frame.text = "íˆ¬ìí¬ì¸íŠ¸ ë‚´ìš©"
        rect_ai = slide.shapes.add_shape(MSO_SHAPE.RECTANGLE, right_x, Cm(26.2), col_w, Cm(2.3))
        rect_ai.fill.background(); rect_ai.line.color.rgb = RGBColor(200, 200, 200)
          
        tx_ai = slide.shapes.add_textbox(right_x + Cm(0.1), Cm(26.3), col_w - Cm(0.2), Cm(2.1))
        tx_ai.text_frame.word_wrap = True
        summary_text = ""
        if selling_points:
            for pt in selling_points[:3]: summary_text += f"{pt.strip()}\n"
        else: summary_text = "â–  ì—­ì„¸ê¶Œ ì…ì§€ë¡œ íˆ¬ìê°€ì¹˜ ìš°ìˆ˜"
        tx_ai.text_frame.text = summary_text; tx_ai.text_frame.paragraphs[0].font.size = Pt(9)
          
        out = BytesIO(); prs.save(out); return out.getvalue()

def create_excel(info, full_addr, finance, zoning, lat, lng, land_price, selling_points, uploaded_img):
    output = BytesIO()
    workbook = xlsxwriter.Workbook(output, {'in_memory': True})
    worksheet = workbook.add_worksheet('ë¶€ë™ì‚°ë¶„ì„')
      
    fmt_title = workbook.add_format({'bold': True, 'font_size': 20, 'align': 'center', 'valign': 'vcenter', 'border': 1, 'bg_color': '#EAEAEA'})
    fmt_label = workbook.add_format({'bold': True, 'font_size': 11, 'align': 'center', 'valign': 'vcenter', 'border': 1, 'bg_color': '#F0F8FF'}) 
    fmt_val = workbook.add_format({'bold': True, 'font_size': 11, 'align': 'center', 'valign': 'vcenter', 'border': 1, 'text_wrap': True})
    fmt_val_red = workbook.add_format({'bold': True, 'font_size': 16, 'align': 'center', 'valign': 'vcenter', 'border': 1, 'font_color': 'red'})
    fmt_box = workbook.add_format({'border': 1, 'align': 'left', 'valign': 'top', 'text_wrap': True})
    fmt_header = workbook.add_format({'bold': True, 'font_size': 12, 'align': 'left'})

    worksheet.set_column('A:A', 2); worksheet.set_column('B:E', 12); worksheet.set_column('F:F', 2); worksheet.set_column('G:J', 12) 

    bld_name = info.get('bldNm')
    if not bld_name or bld_name == '-': bld_name = f"{full_addr.split(' ')[2] if len(full_addr.split(' ')) > 2 else ''} ë¹Œë”©"
    worksheet.merge_range('B2:J3', bld_name, fmt_title)

    worksheet.write('B5', 'ê±´ë¬¼ì‚¬ì§„', fmt_header); worksheet.merge_range('B6:E20', '', fmt_box) 
    if uploaded_img: uploaded_img.seek(0); worksheet.insert_image('B6', 'building.png', {'image_data': uploaded_img, 'x_scale': 0.5, 'y_scale': 0.5, 'object_position': 2})

    worksheet.write('B22', 'ìœ„ì¹˜ë„', fmt_header); worksheet.merge_range('B23:E35', '', fmt_box)
    map_img_xls = f"http://api.vworld.kr/req/image?service=image&request=getmap&key={VWORLD_KEY}&center={lng},{lat}&crs=EPSG:4326&zoom=17&size=600,400&format=png&basemap=GRAPHIC"
    try:
        res = requests.get(map_img_xls, timeout=3)
        if res.status_code == 200: worksheet.insert_image('B23', 'map.png', {'image_data': BytesIO(res.content), 'x_scale': 0.7, 'y_scale': 0.7})
    except: pass

    worksheet.write('G5', 'ê±´ë¬¼ê°œìš”', fmt_header)
    lp_py = (land_price / 10000) / 0.3025 if land_price > 0 else 0
    bc_text = info.get('bcRat_str', '-'); vl_text = info.get('vlRat_str', '-'); scale_text = info.get('scale_str', '-')
    plat_str = f"{info['platArea']:,.1f}ã¡"; tot_str = f"{info['totArea']:,.1f}ã¡"; arch_str = f"{info.get('archArea_val',0):,.1f}ã¡"
      
    table_data_xls = [
        ["ì†Œì¬ì§€", full_addr, "ìš©ë„", zoning], ["ê³µì‹œì§€ê°€", f"{lp_py:,.0f}ë§Œ/í‰", "ëŒ€ì§€", plat_str], 
        ["ë„ë¡œ", "6M", "ì—°ë©´ì ", tot_str], ["ì¤€ê³µ", info['useAprDay'], "ì§€ìƒ", tot_str],
        ["ê·œëª¨", scale_text, "ê±´ì¶•", arch_str], ["ìŠ¹ê°•ê¸°", info.get('rideUseElvtCnt','-'), "ê±´íìœ¨", bc_text],
        ["ì£¼ì°¨", info.get('parking','-'), "ìš©ì ë¥ ", vl_text], ["ì£¼ìš©ë„", info.get('mainPurpsCdNm','-'), "ì£¼êµ¬ì¡°", info.get('strctCdNm','-')],
        ["ë³´ì¦ê¸ˆ", f"{finance['deposit']:,.0f}ë§Œ", "ìœµì", f"{finance['loan']:,}ì–µ"], ["ì„ëŒ€ë£Œ", f"{finance['rent']:,}ë§Œ", "ìˆ˜ìµë¥ ", f"{finance['yield']:.1f}%"],
        ["ê´€ë¦¬ë¹„", f"{finance['maintenance']:,}ë§Œ", "ë§¤ë„ê°€", f"{finance['price']:,}ì–µ"], ["", "", "", ""]
    ]
    for i, row in enumerate(table_data_xls):
        worksheet.write(5 + i, 6, row[0], fmt_label) 
        if row[0] == "ë§¤ë„ê°€": worksheet.merge_range(5 + i, 7, 5 + i, 9, row[1], fmt_val_red)
        else: worksheet.write(5 + i, 7, row[1], fmt_val) 
        if row[0] != "ë§¤ë„ê°€": worksheet.write(5 + i, 8, row[2], fmt_label); worksheet.write(5 + i, 9, row[3], fmt_val) 

    worksheet.write('G17', 'ì§€ì ë„', fmt_header); worksheet.merge_range('G18:J26', '', fmt_box)
    cad_img = get_cadastral_map_image(lat, lng)
    if cad_img: worksheet.insert_image('G18', 'cad.png', {'image_data': cad_img, 'x_scale': 0.6, 'y_scale': 0.6})

    worksheet.write('G28', 'íˆ¬ìí¬ì¸íŠ¸ ë‚´ìš©', fmt_header); worksheet.merge_range('G29:J35', '', fmt_box)
    summary_text = ""
    if selling_points:
        for pt in selling_points[:5]: summary_text += f"{pt.strip()}\n"
    else: summary_text = "â–  ì—­ì„¸ê¶Œ ì…ì§€ë¡œ íˆ¬ìê°€ì¹˜ ìš°ìˆ˜\nâ–  ì•ˆì •ì ì¸ ì„ëŒ€ ìˆ˜ìµ ê¸°ëŒ€"
    worksheet.write('G29', summary_text, fmt_box)
    worksheet.merge_range('B37:J37', "JS ì œì´ì—ìŠ¤ë¶€ë™ì‚°(ì£¼) ê¹€ì°½ìµ ì´ì‚¬ 010-6595-5700", fmt_title)
    workbook.close()
    return output.getvalue()

# =========================================================
# [ë©”ì¸ ì‹¤í–‰]
# =========================================================
st.title("ğŸ¢ ë¶€ë™ì‚° ë§¤ì… ë¶„ì„ê¸° Pro")
st.markdown("---")

with st.expander("ğŸ—º ì§€ë„ì—ì„œ ì§ì ‘ í´ë¦­í•˜ì—¬ ì°¾ê¸° (Click)", expanded=False):
    m = folium.Map(location=[37.5172, 127.0473], zoom_start=14)
    output = st_folium(m, width=700, height=400)
    if output and output.get("last_clicked"):
        lat = output["last_clicked"]["lat"]; lng = output["last_clicked"]["lng"]
        if "last_click_lat" not in st.session_state or st.session_state["last_click_lat"] != lat:
            st.session_state["last_click_lat"] = lat
            found_addr = get_address_from_coords(lat, lng)
            if found_addr:
                st.success(f"ğŸ“ ì§€ë„ í´ë¦­ í™•ì¸! ë³€í™˜ëœ ì£¼ì†Œ: {found_addr}")
                st.session_state['addr'] = found_addr; reset_analysis(); st.rerun()
            else: st.warning("âš ï¸ ì£¼ì†Œë¥¼ ì°¾ì„ ìˆ˜ ì—†ëŠ” ìœ„ì¹˜ì…ë‹ˆë‹¤.")

link_container = st.container()
addr_input = st.text_input("ì£¼ì†Œ ì…ë ¥", placeholder="ì˜ˆ: ê°•ë‚¨êµ¬ ë…¼í˜„ë™ 254-4", key="addr", on_change=reset_analysis)

if addr_input:
    with st.spinner("ë°ì´í„° ë¶„ì„ ì¤‘..."):
        location = get_pnu_and_coords(addr_input)
        if not location: 
            st.warning("âš ï¸ í•´ë‹¹ì£¼ì†Œê°€ ì—†ìŠµë‹ˆë‹¤")
        else:
            with link_container:
                col_l1, col_l2 = st.columns(2)
                with col_l1: st.markdown(f"<a href='https://map.naver.com/v5/search/{quote_plus(location['full_addr'])}' target='_blank' class='link-btn naver-btn'>ğŸ“ ë„¤ì´ë²„ì§€ë„ ìœ„ì¹˜í™•ì¸</a>", unsafe_allow_html=True)
                with col_l2: 
                    if location.get('pnu'): st.markdown(f"<a href='https://www.eum.go.kr/web/ar/lu/luLandDet.jsp?pnu={location['pnu']}&mode=search&isNoScr=script' target='_blank' class='link-btn eum-btn'>ğŸ“‘ í† ì§€ì´ìŒ ê·œì œì •ë³´ í™•ì¸</a>", unsafe_allow_html=True)
            
            if not st.session_state['zoning']: st.session_state['zoning'] = get_zoning_smart(location['lat'], location['lng'])
            if not st.session_state['fetched_zoning']: st.session_state['fetched_zoning'] = st.session_state['zoning']

            info = get_building_info_smart(location['pnu'])
            land_price = get_land_price(location['pnu'])
            if land_price > 0 and st.session_state['fetched_lp'] == 0: st.session_state['fetched_lp'] = land_price
              
            if not info or "error" in info: st.error(f"ì¡°íšŒ ì‹¤íŒ¨: {info.get('error')}")
            else:
                st.success("âœ… ë¶„ì„ ì™„ë£Œ!")
                st.write("##### ğŸ“¸ PPT ì‚½ì…ìš© ì‚¬ì§„ ì—…ë¡œë“œ")
                st.write("â–¼ ê¸°ë³¸ ì‚¬ì§„ (ìœ„ì¹˜ë„/ë©”ì¸/ì§€ì ë„/ëŒ€ì¥)")
                col_u1, col_u2, col_u3, col_u4 = st.columns(4)
                with col_u1: u1 = st.file_uploader("Slide 2: ìœ„ì¹˜ë„", type=['png', 'jpg', 'jpeg'], key="u1")
                with col_u2: u2 = st.file_uploader("Slide 3: ê±´ë¬¼ë©”ì¸", type=['png', 'jpg', 'jpeg'], key="u2")
                with col_u3: u3 = st.file_uploader("Slide 5: ì§€ì ë„", type=['png', 'jpg', 'jpeg'], key="u3")
                with col_u4: u4 = st.file_uploader("Slide 6: ëŒ€ì¥", type=['png', 'jpg', 'jpeg'], key="u4")
                st.write("â–¼ ì¶”ê°€ ì‚¬ì§„ (Slide 7)")
                c_u5_1, c_u5_2, c_u5_3, c_u5_4 = st.columns(4)
                with c_u5_1: u5_1 = st.file_uploader("ì¶”ê°€1", type=['png','jpg'], key="u5_1")
                with c_u5_2: u5_2 = st.file_uploader("ì¶”ê°€2", type=['png','jpg'], key="u5_2")
                with c_u5_3: u5_3 = st.file_uploader("ì¶”ê°€3", type=['png','jpg'], key="u5_3")
                with c_u5_4: u5_4 = st.file_uploader("ì¶”ê°€4", type=['png','jpg'], key="u5_4")
                images_map = {'u1': u1, 'u2': u2, 'u3': u3, 'u4': u4, 'u5_1': u5_1, 'u5_2': u5_2, 'u5_3': u5_3, 'u5_4': u5_4}

                st.markdown("---")
                st.markdown("""<div style="background-color: #f8f9fa; padding: 50px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.05);">""", unsafe_allow_html=True)
                  
                c1, c2 = st.columns([2, 1])
                with c1: render_styled_block("ì†Œì¬ì§€", addr_input)
                with c2: info['bldNm'] = editable_text_input("ê±´ë¬¼ëª…", "bldNm", info.get('bldNm', '-'))
                st.write("") 
                  
                c_lp1, c_lp2, c_lp3 = st.columns(3)
                with c_lp1:
                    lp_val = st.text_input("ê³µì‹œì§€ê°€(ì›/ã¡)", value=f"{st.session_state['fetched_lp']:,}")
                    try: land_price = int(lp_val.replace(',', ''))
                    except: land_price = 0
                with c_lp3: 
                    c_tr, c_rd = st.columns(2)
                    info['traffic'] = c_tr.text_input("êµí†µí¸ì˜")
                    info['road'] = c_rd.text_input("ë„ë¡œìƒí™©")

                st.write("")
                st.markdown("<hr style='margin: 10px 0; border-top: 1px dashed #ddd;'>", unsafe_allow_html=True)
                c2_1, c2_2, c2_3 = st.columns(3)
                with c2_1:
                    zoning_val = st.text_input("ìš©ë„ì§€ì—­", value=st.session_state['fetched_zoning'])
                    st.session_state['zoning'] = zoning_val
                with c2_2: 
                    new_plat = editable_area_input("ëŒ€ì§€ë©´ì ", "plat", info['platArea'])
                    info['platArea'] = new_plat 
                with c2_3: 
                    new_tot = editable_area_input("ì—°ë©´ì ", "tot", info['totArea'])
                    info['totArea'] = new_tot
                with c_lp2:
                    if land_price > 0 and info['platArea'] > 0: render_styled_block("ê³µì‹œì§€ê°€ ì´ì•¡(ì¶”ì •)", f"{land_price * info['platArea'] / 100000000:,.2f}ì–µ")
                    else: render_styled_block("ê³µì‹œì§€ê°€ ì´ì•¡", "-")

                st.write("")
                c3_1, c3_2, c3_3 = st.columns(3)
                with c3_1: info['useAprDay'] = editable_text_input("ì¤€ê³µë…„ë„", "useDay", info['useAprDay'])
                with c3_2: new_arch = editable_area_input("ê±´ì¶•ë©´ì ", "arch", info.get('archArea_val', 0)); info['archArea_val'] = new_arch
                with c3_3: new_ground = editable_area_input("ì§€ìƒë©´ì ", "ground", info.get('groundArea', 0)); info['groundArea'] = new_ground
                  
                st.write("")
                c4_1, c4_2, c4_3 = st.columns(3)
                with c4_1: def_scale = f"B{info.get('ugrndFlrCnt')} / {info.get('grndFlrCnt')}F"; info['scale_str'] = editable_text_input("ê±´ë¬¼ê·œëª¨", "scale", def_scale)
                with c4_2: c_ev, c_pk = st.columns(2); info['rideUseElvtCnt'] = c_ev.text_input("ìŠ¹ê°•ê¸°", value=str(info.get('rideUseElvtCnt','-'))); info['parking'] = c_pk.text_input("ì£¼ì°¨ëŒ€ìˆ˜", value=str(info.get('parking','-')))
                with c4_3: c_bc, c_vl = st.columns(2); info['bcRat_str'] = c_bc.text_input("ê±´íìœ¨", value=f"{info.get('bcRat')}%"); info['vlRat_str'] = c_vl.text_input("ìš©ì ë¥ ", value=f"{info.get('vlRat')}%"); info['bc_vl_str'] = f"{info['bcRat_str']} / {info['vlRat_str']}"
                  
                st.write("")
                c5_1, c5_2, c5_3 = st.columns(3)
                with c5_1: info['mainPurpsCdNm'] = editable_text_input("ê±´ë¬¼ìš©ë„", "purps", info.get('mainPurpsCdNm'))
                with c5_2: info['strctCdNm'] = editable_text_input("ê±´ë¬¼ì£¼êµ¬ì¡°", "strct", info.get('strctCdNm'))
                with c5_3: st.empty()
                st.markdown("</div>", unsafe_allow_html=True)
                st.markdown("---")

                st.subheader("ğŸ“‹ ì¸µë³„ ì„ëŒ€ í˜„í™© (Rent Roll)")
                st.markdown("""<div style="background-color: #eef2f3; padding: 25px; border-radius: 15px; border:2px solid #ccc;">""", unsafe_allow_html=True)
                  
                if not st.session_state['rent_roll_init']:
                    fetched_floors = get_floor_info_smart(location['pnu'])
                    if fetched_floors: st.session_state['rent_roll_data'] = fetched_floors
                    else:
                        try: total_floors = info.get('ugrndFlrCnt', 0) + info.get('grndFlrCnt', 0); avg_area_val = info['totArea'] / total_floors if total_floors > 0 else 0; avg_area_str = f"{avg_area_val * 0.3025:.2f}"
                        except: avg_area_str = ""
                        ug_cnt = info.get('ugrndFlrCnt', 0); g_cnt = info.get('grndFlrCnt', 0); init_data = []
                        if ug_cnt > 0:
                            for i in range(ug_cnt, 0, -1): init_data.append({"ì¸µìˆ˜": f"B{i}", "ì…ì£¼ì—…ì²´": "", "ì¸µë³„ë©´ì ": avg_area_str, "ë³´ì¦ê¸ˆ": None, "ì„ëŒ€ë£Œ": None, "ê´€ë¦¬ë¹„": None, "ì„ëŒ€ì°¨ê¸°ê°„": "", "ë¹„ê³ ": ""})
                        if g_cnt > 0:
                            for i in range(1, g_cnt + 1): init_data.append({"ì¸µìˆ˜": f"{i}ì¸µ", "ì…ì£¼ì—…ì²´": "", "ì¸µë³„ë©´ì ": avg_area_str, "ë³´ì¦ê¸ˆ": None, "ì„ëŒ€ë£Œ": None, "ê´€ë¦¬ë¹„": None, "ì„ëŒ€ì°¨ê¸°ê°„": "", "ë¹„ê³ ": ""})
                        else: init_data.append({"ì¸µìˆ˜": "1ì¸µ", "ì…ì£¼ì—…ì²´": "", "ì¸µë³„ë©´ì ": avg_area_str, "ë³´ì¦ê¸ˆ": None, "ì„ëŒ€ë£Œ": None, "ê´€ë¦¬ë¹„": None, "ì„ëŒ€ì°¨ê¸°ê°„": "", "ë¹„ê³ ": ""})
                        st.session_state['rent_roll_data'] = init_data
                    st.session_state['rent_roll_init'] = True
                  
                edited_df = st.data_editor(
                    st.session_state['rent_roll_data'], num_rows="dynamic",
                    column_config={
                        "ì¸µìˆ˜": st.column_config.TextColumn(width=60), "ì…ì£¼ì—…ì²´": st.column_config.TextColumn(width="medium"),
                        "ì¸µë³„ë©´ì ": st.column_config.TextColumn(label="ì¸µë³„ë©´ì (í‰)", width="small"),
                        "ë³´ì¦ê¸ˆ": st.column_config.NumberColumn(label="ë³´ì¦ê¸ˆ(ë§Œì›)", width="small", format="%d"),
                        "ì„ëŒ€ë£Œ": st.column_config.NumberColumn(label="ì„ëŒ€ë£Œ(ë§Œì›)", width="small", format="%d"),
                        "ê´€ë¦¬ë¹„": st.column_config.NumberColumn(label="ê´€ë¦¬ë¹„(ë§Œì›)", width="small", format="%d"),
                        "ì„ëŒ€ì°¨ê¸°ê°„": st.column_config.TextColumn(width="medium"), "ë¹„ê³ ": st.column_config.TextColumn(width="small"),
                    }, use_container_width=True, key="rent_editor"
                )
                  
                sum_deposit = 0; sum_rent = 0; sum_maint = 0
                if edited_df is not None:
                    st.session_state['rent_roll_data'] = edited_df if isinstance(edited_df, list) else edited_df.to_dict('records')
                    df_calc = pd.DataFrame(st.session_state['rent_roll_data'])
                    if not df_calc.empty:
                        def clean_num(x):
                            if pd.isna(x) or x == "": return 0
                            try: return int(float(str(x).replace(',', '').strip()))
                            except: return 0
                        sum_deposit = df_calc['ë³´ì¦ê¸ˆ'].apply(clean_num).sum(); sum_rent = df_calc['ì„ëŒ€ë£Œ'].apply(clean_num).sum(); sum_maint = df_calc['ê´€ë¦¬ë¹„'].apply(clean_num).sum()

                st.markdown("</div>", unsafe_allow_html=True)
                st.markdown("---")

                st.subheader("ğŸ’° ê¸ˆì•¡ ì •ë³´")
                st.markdown("""<div style="background-color: #f8f9fa; padding: 20px; border-radius: 15px; box-shadow: 0 4px 6px rgba(0,0,0,0.05);">""", unsafe_allow_html=True)
                st.write("") 
                  
                row1_1, row1_2, row1_3 = st.columns(3)
                with row1_1: deposit_val = comma_input("ë³´ì¦ê¸ˆ", "ë§Œì›", "deposit", sum_deposit, help_text="*ì„ëŒ€í˜„í™© í•©ê³„ ìë™ì ìš©")
                with row1_2: rent_val = comma_input("ì›”ì„ëŒ€ë£Œ", "ë§Œì›", "rent", sum_rent, help_text="*ì„ëŒ€í˜„í™© í•©ê³„ ìë™ì ìš©")
                with row1_3: maint_val = comma_input("ê´€ë¦¬ë¹„", "ë§Œì›", "maint", sum_maint, help_text="*ì„ëŒ€í˜„í™© í•©ê³„ ìë™ì ìš©")
                  
                st.write("") 
                row2_1, row2_2, row2_3 = st.columns(3)
                with row2_1: loan_val = comma_input("ìœµìê¸ˆ", "ì–µì›", "loan", 0)
                with row2_2: 
                    st.markdown(f"""<div style='font-size: 17px; font-weight: 800; color: #D32F2F; margin-bottom: 4px;'>ë§¤ë§¤ê¸ˆì•¡</div>""", unsafe_allow_html=True)
                    c_in_p, c_unit_p = st.columns([3, 1]) 
                    with c_in_p:
                        if "price" not in st.session_state: st.session_state["price"] = 0
                        current_p = st.session_state["price"]; fmt_price = f"{current_p:,}" if current_p != 0 else ""
                        p_input = st.text_input("ë§¤ë§¤ê¸ˆì•¡", value=fmt_price, key="price_input", label_visibility="hidden")
                        try: st.session_state["price"] = 0 if p_input.strip() == "" else int(str(p_input).replace(',', '').strip())
                        except: st.session_state["price"] = 0
                    with c_unit_p: st.markdown(f"<div style='margin-top: 15px; font-size: 19px; font-weight: 700; color: #555;'>ì–µì›</div>", unsafe_allow_html=True)
                price_val = st.session_state["price"]
                try: real_invest_won = (price_val * 10000) - deposit_val; yield_rate = ((rent_val * 12) / real_invest_won) * 100 if real_invest_won > 0 else 0
                except: yield_rate = 0
                with row2_3:
                    st.markdown(f"""<div style='font-size: 17px; font-weight: 800; color: #1e88e5; margin-bottom: 4px;'>ìˆ˜ìµë¥ </div><div style='background-color: #fff; border: 2px solid #90caf9; border-radius: 8px; padding: 12px; text-align: center;'><span style='font-size: 30px; font-weight: 900; color: #111;'>{yield_rate:.2f}</span><span style='font-size: 20px; font-weight: 700; color: #555;'>%</span></div>""", unsafe_allow_html=True)
                st.markdown("<hr style='margin: 15px 0; border-top: 1px dashed #ddd;'>", unsafe_allow_html=True)
                  
                land_py = info['platArea'] * 0.3025; tot_py = info['totArea'] * 0.3025; price_won = price_val * 100000000
                land_price_per_py = (price_won / land_py) / 10000 if land_py > 0 else 0
                tot_price_per_py = (price_won / tot_py) / 10000 if tot_py > 0 else 0
                cp1, cp2 = st.columns(2)
                with cp1: st.markdown(f"""<div class="unit-price-box"><div style="font-size:15px; font-weight:700; color:#555;">ëŒ€ì§€ í‰ë‹¹ê°€</div><div class="unit-price-value">{land_price_per_py:,.0f} ë§Œì›</div></div>""", unsafe_allow_html=True)
                with cp2: st.markdown(f"""<div class="unit-price-box"><div style="font-size:15px; font-weight:700; color:#555;">ì—°ë©´ì  í‰ë‹¹ê°€</div><div class="unit-price-value">{tot_price_per_py:,.0f} ë§Œì›</div></div>""", unsafe_allow_html=True)
                st.markdown("</div>", unsafe_allow_html=True)
                st.markdown("---")

                st.subheader("ğŸ” AI ë¬¼ê±´ë¶„ì„ (Key Insights)")
                st.write("###### ğŸ‘‡ í•´ë‹¹ë˜ëŠ” í‚¤ì›Œë“œë¥¼ ì„ íƒí•˜ì„¸ìš” (ë‹¤ì¤‘ì„ íƒ)")
                
                # [ìˆ˜ì •] 5í–‰ 7ì—´ (ì´ 35ê°œ) í‚¤ì›Œë“œ ë°°ì¹˜
                env_options = [
                    "ì—­ì„¸ê¶Œ", "ê´‘ëŒ€ë¡œë³€", "ë¨¹ììƒê¶Œ", "ëœë“œë§ˆí¬", "ê¸‰ë§¤ë¬¼", "ì£¼ì°¨í¸ë¦¬", "ê°ì •ê°€ì´í•˜",
                    "ì´ˆì—­ì„¸ê¶Œ", "ëŒ€ë¡œë³€", "ì˜¤í”¼ìŠ¤ìƒê¶Œ", "ë²•ì¡°íƒ€ìš´", "ì‚¬ì˜¥ì¶”ì²œ", "ìˆ˜ë ¤í•œì™¸ê´€", "ìš©ì ë¥ ì´ë“",
                    "ë”ë¸”ì—­ì„¸ê¶Œ", "ëŒ€ë¡œì½”ë„ˆ", "í•­ì•„ë¦¬ìƒê¶Œ", "í•«í”Œë ˆì´ìŠ¤", "ìˆ˜ìµí˜•", "ì‹ ì¶•ë¹Œë”©", "ì‹ ì¶•ë¶€ì§€ìš©",
                    "íŠ¸ë¦¬í”Œì—­ì„¸ê¶Œ", "ì´ë©´ì½”ë„ˆ", "í•™êµ°ì§€", "ë©”ë””ì»¬ì…ì§€", "ì‹œì„¸ì°¨ìµ", "ê´€ë¦¬ìƒíƒœìµœìƒ", "ëª…ë„ì™„ë£Œ",
                    "ê´‘ì—­í™˜ìŠ¹", "ì´ë©´ì´ˆì…", "ìˆ²ì„¸ê¶Œ", "ê°€ì‹œì„±ìš°ìˆ˜", "ë°¸ë¥˜ì—…ìœ ë§", "ë¦¬ëª¨ë¸ë§", "ëª…ë„í˜‘ì˜ê°€ëŠ¥"
                ]
                
                # [ìˆ˜ì •] 7ì—´ ë°°ì¹˜ë¡œ ë³€ê²½
                cols_check = st.columns(7)
                selected_envs = []
                for i, opt in enumerate(env_options):
                    if cols_check[i % 7].checkbox(opt): selected_envs.append(opt)
                
                if selected_envs:
                    st.write(""); st.write("âœ… **ì„ íƒëœ í‚¤ì›Œë“œ:**")
                    tags_html = "".join([f"<span class='selected-tags'>{tag}</span>" for tag in selected_envs])
                    st.markdown(tags_html, unsafe_allow_html=True)
                st.write("")
                  
                with st.expander("ğŸ“‚ ë¹„êµ ë¶„ì„ìš© ì—‘ì…€ ë°ì´í„° ì—…ë¡œë“œ (ì„ íƒì‚¬í•­)", expanded=True):
                    st.info("ğŸ’¡ ì—‘ì…€ í•„ìˆ˜ ì»¬ëŸ¼: êµ¬ë¶„, ì†Œì¬ì§€, ëŒ€ì§€ë©´ì , ë§¤ë§¤ê¸ˆì•¡")
                    comp_file = st.file_uploader("ì£¼ë³€ ë§¤ë§¤ì‚¬ë¡€/ë§¤ë¬¼ ì—‘ì…€ ì—…ë¡œë“œ", type=['xlsx', 'xls'], key=f"excel_{addr_input}")
                    filtered_comp_df = None; target_dong = ""
                    if comp_file:
                        try:
                            addr_parts = location['full_addr'].split(' '); 
                            for part in addr_parts: 
                                if part.endswith('ë™'): target_dong = part; break
                            raw_df = pd.read_excel(comp_file); raw_df.columns = [c.strip() for c in raw_df.columns]
                            required_cols = ['êµ¬ë¶„', 'ì†Œì¬ì§€', 'ëŒ€ì§€ë©´ì ', 'ë§¤ë§¤ê¸ˆì•¡']
                            if all(col in raw_df.columns for col in required_cols):
                                filtered_df = raw_df[raw_df['ì†Œì¬ì§€'].astype(str).str.contains(target_dong, na=False)].copy() if target_dong else raw_df.copy()
                                if not filtered_df.empty:
                                    filtered_df['ëŒ€ì§€ë©´ì _ìˆ«ì'] = pd.to_numeric(filtered_df['ëŒ€ì§€ë©´ì '], errors='coerce').fillna(0)
                                    filtered_df['ë§¤ë§¤ê¸ˆì•¡_ìˆ«ì'] = pd.to_numeric(filtered_df['ë§¤ë§¤ê¸ˆì•¡'], errors='coerce').fillna(0)
                                    filtered_df['í™˜ì‚°ë©´ì (í‰)'] = filtered_df['ëŒ€ì§€ë©´ì _ìˆ«ì'].apply(lambda x: x * 0.3025 if x > 1000 else x)
                                    filtered_df['í‰ë‹¹ê°€'] = filtered_df.apply(lambda r: r['ë§¤ë§¤ê¸ˆì•¡_ìˆ«ì'] / r['í™˜ì‚°ë©´ì (í‰)'] if r['í™˜ì‚°ë©´ì (í‰)'] > 0 else 0, axis=1)
                                    filtered_comp_df = filtered_df[filtered_df['í‰ë‹¹ê°€'] > 0].copy()
                                    if not filtered_comp_df.empty:
                                        st.success(f"âœ… '{target_dong}' ê´€ë ¨ ë°ì´í„° {len(filtered_comp_df)}ê±´ì„ ì°¾ì•„ ë¶„ì„í•©ë‹ˆë‹¤.")
                                        col_res1, col_res2 = st.columns(2)
                                        sold_cases = filtered_comp_df[filtered_comp_df['êµ¬ë¶„'].astype(str).str.contains('ë§¤ê°|ì™„ë£Œ|ë§¤ë§¤', na=False)]
                                        with col_res1:
                                            if not sold_cases.empty: st.markdown(f"<div style='padding:10px; background-color:#e8f5e9; border-radius:5px;'><div style='font-weight:bold; color:#2e7d32;'>ğŸ“‰ {target_dong} ë§¤ê° í‰ê· </div><div style='font-size:14px;'>í‰ë‹¹ <b>{sold_cases['í‰ë‹¹ê°€'].mean():,.0f} ë§Œì›</b></div></div>", unsafe_allow_html=True)
                                            else: st.info(f"{target_dong} ë§¤ê° ì‚¬ë¡€ ì—†ìŒ")
                                        with col_res2:
                                            ongoing_cases = filtered_comp_df[~filtered_comp_df.index.isin(sold_cases.index)]
                                            if not ongoing_cases.empty: st.markdown(f"<div style='padding:10px; background-color:#e3f2fd; border-radius:5px;'><div style='font-weight:bold; color:#1565c0;'>ğŸ“¢ {target_dong} ì§„í–‰ ë§¤ë¬¼</div><div style='font-size:14px;'>í‰ë‹¹ <b>{ongoing_cases['í‰ë‹¹ê°€'].mean():,.0f} ë§Œì›</b></div></div>", unsafe_allow_html=True)
                                            else: st.warning(f"âš ï¸ ì—‘ì…€ íŒŒì¼ì— '{target_dong}' ê´€ë ¨ ë°ì´í„°ê°€ ì—†ìŠµë‹ˆë‹¤.")
                                    else: st.warning(f"âš ï¸ ì—‘ì…€ íŒŒì¼ì— '{target_dong}'ì´ í¬í•¨ëœ ì£¼ì†Œê°€ ì—†ìŠµë‹ˆë‹¤.")
                            else: st.error(f"ì—‘ì…€ ì»¬ëŸ¼ í™•ì¸ í•„ìš”! (í•„ìˆ˜: {required_cols})")
                        except Exception as e: st.error(f"ì—‘ì…€ ì²˜ë¦¬ ì˜¤ë¥˜: {e}")

                user_comment = st.text_area("ğŸ“ ì¶”ê°€ íŠ¹ì§• ì…ë ¥ (ì˜ˆ: 1ì¸µ ìŠ¤íƒ€ë²…ìŠ¤ ì…ì , ì£¼ì¸ì„¸ëŒ€ ëª…ë„ ê°€ëŠ¥ ë“±)", height=80)
                  
            # [ì¸ì‚¬ì´íŠ¸ ìƒì„± ë²„íŠ¼]
                if st.button("ğŸ¤– ì¸ì‚¬ì´íŠ¸ìš”ì•½ (Click)"):
                    # [ìˆ˜ì •] ìƒì„±ëœ í›„ë³´êµ°ë§Œ ì´ˆê¸°í™”í•˜ê³ , ì´ë¯¸ ì„ íƒí•œ 'ìµœì¢… ëª©ë¡'ì€ ìœ ì§€í•©ë‹ˆë‹¤.
                    if 'generated_candidates' in st.session_state:
                        del st.session_state['generated_candidates']
                    
                    with st.spinner("ë¹…ë°ì´í„° ë¶„ì„ ë° AI ë¦¬í¬íŠ¸ ìƒì„± ì¤‘..."):
                        finance_data_for_ai = {"yield": yield_rate, "price": price_val, "land_pyeong_price_val": land_price_per_py}
                        
                        # í•¨ìˆ˜ ì‹¤í–‰
                        generated_candidates = generate_insight_candidates(
                            info, 
                            finance_data_for_ai, 
                            st.session_state['zoning'], 
                            selected_envs, 
                            user_comment, 
                            filtered_comp_df, 
                            target_dong
                        )
                        
                        # ê²°ê³¼ ì €ì¥
                        st.session_state['generated_candidates'] = generated_candidates
                        st.rerun() # í™”ë©´ ìƒˆë¡œê³ ì¹¨
                          
                        current_selected = st.session_state.get('final_selected_insights', [])
                        filtered_candidates = [c for c in generated_candidates if c not in current_selected]
                        st.session_state['generated_candidates'] = filtered_candidates

                if st.session_state['generated_candidates']:
                    st.write("###### ğŸ’¡ ìƒì„±ëœ íˆ¬ìí¬ì¸íŠ¸ (ì²´í¬í•˜ë©´ ì•„ë˜ ìµœì¢… ëª©ë¡ìœ¼ë¡œ ì´ë™í•©ë‹ˆë‹¤)")
                    for cand in st.session_state['generated_candidates']:
                        if st.checkbox(cand, key=f"cand_{cand}"):
                            if cand not in st.session_state['final_selected_insights']: st.session_state['final_selected_insights'].append(cand)
                            st.session_state['generated_candidates'].remove(cand) 
                            st.rerun()

                if st.session_state['final_selected_insights']:
                    st.markdown("""<div class="ai-summary-box"><div class="ai-title">ğŸŒŸ íˆ¬ìí¬ì¸íŠ¸ ë‚´ìš© (ìµœì¢… ì„ íƒë¨)</div>""", unsafe_allow_html=True)
                    st.write("â€» ì²´í¬ë¥¼ í•´ì œí•˜ë©´ ëª©ë¡ì—ì„œ ì‚­ì œë©ë‹ˆë‹¤.")
                    for i, selected in enumerate(st.session_state['final_selected_insights']):
                        is_checked = st.checkbox(selected, value=True, key=f"sel_{i}")
                        if not is_checked: st.session_state['final_selected_insights'].pop(i); st.rerun()
                    st.markdown("</div>", unsafe_allow_html=True)

                st.markdown("---")
                  
                finance_data = {
                    "price": price_val, "deposit": deposit_val, "rent": rent_val, 
                    "maintenance": maint_val, "loan": loan_val, "yield": yield_rate, 
                    "real_invest_eok": (price_val * 10000 - deposit_val) / 10000,
                    "land_pyeong_price_val": land_price_per_py, 
                    "tot_pyeong_price": f"{tot_price_per_py:,.0f} ë§Œì›"
                }
                z_val = st.session_state.get('zoning', '') if isinstance(st.session_state.get('zoning', ''), str) else ""
                final_summary = st.session_state.get('final_selected_insights', [])
                file_for_excel = u2 if 'u2' in locals() else None
                current_rent_df = None
                if st.session_state['rent_roll_data']: current_rent_df = pd.DataFrame(st.session_state['rent_roll_data'])

                c_ppt, c_xls = st.columns([1, 1])
                with c_ppt:
                    st.write("##### ğŸ“¥ PPT ì €ì¥")
                    
                    # [ìˆ˜ì •] 9ì¥ í…œí”Œë¦¿ê³¼ 1ì¥ í…œí”Œë¦¿ì„ ê°ê° ì—…ë¡œë“œ ë°›ì„ ìˆ˜ ìˆê²Œ ë³€ê²½
                    ppt_template_9page = st.file_uploader("9ì¥ìš© PPT í…œí”Œë¦¿ (ì„ íƒ)", type=['pptx'], key=f"tpl_9_{addr_input}")
                    ppt_template_1page = st.file_uploader("1ì¥ìš© PPT ìƒ˜í”Œ (ì„ íƒ)", type=['pptx'], key=f"tpl_1_{addr_input}")
                    
                    if ppt_template_9page: st.success("âœ… 9ì¥ í…œí”Œë¦¿ ì ìš©")
                    elif ppt_template_1page: st.success("âœ… 1ì¥ ìƒ˜í”Œ ì ìš©")
                      
                    # create_pptx í•¨ìˆ˜ í˜¸ì¶œ ì‹œ 1ì¥ í…œí”Œë¦¿ ì¸ì ì¶”ê°€ ì „ë‹¬
                    ppt_file = create_pptx(
                        info, 
                        location['full_addr'], 
                        finance_data, 
                        z_val, 
                        location['lat'], 
                        location['lng'], 
                        land_price, 
                        final_summary, 
                        images_map, 
                        rent_roll_df=current_rent_df, 
                        template_binary=ppt_template_9page,        # 9ì¥ ìš°ì„ 
                        template_1page_binary=ppt_template_1page   # 9ì¥ì´ ì—†ìœ¼ë©´ 1ì¥
                    )
                    
                    addr_parts = location['full_addr'].split()
                    short_addr = " ".join(addr_parts[1:]) if len(addr_parts) > 1 else location['full_addr']
                    pptx_name = f"{price_val}ì–µ-{short_addr} {info.get('bldNm').replace('-','').strip()}.pptx"
                      
                    if ppt_file: 
                        st.download_button(label="PPT ë‹¤ìš´ë¡œë“œ", data=ppt_file, file_name=pptx_name, mime="application/vnd.openxmlformats-officedocument.presentationml.presentation", use_container_width=True)
                    else: 
                        st.error("PPT ìƒì„± ì¤‘ ì˜¤ë¥˜ê°€ ë°œìƒí–ˆìŠµë‹ˆë‹¤. ì ì‹œ í›„ ë‹¤ì‹œ ì‹œë„í•´ì£¼ì„¸ìš”.")
                with c_xls:
                    st.write("##### ğŸ“¥ ì—‘ì…€ ì €ì¥")
                    xlsx_file = create_excel(info, location['full_addr'], finance_data, z_val, location['lat'], location['lng'], land_price, final_summary, file_for_excel)
                    xlsx_name = f"{price_val}ì–µ-{short_addr} {info.get('bldNm').replace('-','').strip()}.xlsx"
                    st.download_button(label="ì—‘ì…€ ë‹¤ìš´ë¡œë“œ", data=xlsx_file, file_name=xlsx_name, mime="application/vnd.openxmlformats-officedocument.spreadsheetml.sheet", use_container_width=True)
